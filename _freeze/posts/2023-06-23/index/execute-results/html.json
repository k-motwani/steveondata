{
  "hash": "2912f247b10f27cda5eda9a0ae15337c",
  "result": {
    "markdown": "---\ntitle: \"Bootstrap Function in R: Resampling with the lapply and sample Functions\"\nauthor: \"Steven P. Sanderson II, MPH\"\ndate: \"2023-06-23\"\ncategories: [rtip, bootstrap, lapply, sample]\n---\n\n\n# Introduction\n\nBootstrap resampling is a powerful technique used in statistics and data analysis to estimate the uncertainty of a statistic by repeatedly sampling from the original data. In R, we can easily implement a bootstrap function using the lapply, rep, and sample functions. In this blog post, we will explore how to write a bootstrap function in R and provide an example using the \"mpg\" column from the popular \"mtcars\" dataset.\n\n# Bootstrap Function Implementation\n\nTo create a bootstrap function in R, we can follow these steps:\n\n## Step 1: Load the required dataset\n\nLet's begin by loading the \"mtcars\" dataset, which is included in the base R package:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(mtcars)\n```\n:::\n\n\n## Step 2: Define the bootstrap function\n\nWe'll define a function called `bootstrap()` that takes two arguments: `data` (the input data vector) and `n` (the number of bootstrap iterations).\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbootstrap <- function(data, n) {\n  resampled_data <- lapply(1:n, function(i) {\n    resample <- sample(data, replace = TRUE)\n    # Perform desired operations on the resampled data, e.g., compute a statistic\n    # and return the result\n  })\n  return(resampled_data)\n}\n\nbootstrapped_samples <- bootstrap(mtcars$mpg, 5)\nbootstrapped_samples\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[[1]]\n [1] 21.0 18.1 33.9 21.4 17.3 19.2 19.2 15.8 16.4 30.4 18.1 14.3 32.4 10.4 15.0\n[16] 16.4 30.4 17.8 21.4 19.2 17.3 22.8 14.3 22.8 30.4 18.7 13.3 13.3 15.2 10.4\n[31] 15.0 13.3\n\n[[2]]\n [1] 18.7 32.4 21.0 10.4 15.0 14.7 24.4 10.4 32.4 10.4 21.0 19.7 21.4 10.4 30.4\n[16] 17.3 10.4 22.8 15.2 15.2 21.4 15.8 21.4 33.9 24.4 15.2 18.1 19.2 21.0 24.4\n[31] 15.5 21.0\n\n[[3]]\n [1] 15.5 30.4 21.0 22.8 27.3 18.1 21.0 13.3 15.2 17.3 15.8 21.0 18.1 14.3 17.8\n[16] 15.8 21.0 18.1 19.2 24.4 19.2 22.8 18.7 14.3 26.0 21.4 22.8 32.4 14.7 15.2\n[31] 15.2 14.3\n\n[[4]]\n [1] 13.3 21.0 13.3 15.0 19.2 18.1 18.1 19.2 22.8 18.7 26.0 21.4 14.7 14.3 17.8\n[16] 22.8 19.7 21.4 30.4 30.4 18.7 17.3 16.4 21.5 18.1 21.0 17.8 21.4 14.3 19.7\n[31] 32.4 18.7\n\n[[5]]\n [1] 15.0 21.4 21.5 26.0 17.3 30.4 18.1 17.8 17.3 30.4 24.4 32.4 21.0 17.8 33.9\n[16] 32.4 19.2 22.8 19.7 16.4 17.8 22.8 14.3 33.9 21.5 10.4 21.4 26.0 33.9 14.7\n[31] 21.5 18.1\n```\n:::\n:::\n\n\nIn the above code, we use `lapply` to generate a list of `n` resampled datasets. Inside the `lapply` function, we use the `sample` function to randomly sample from the original data with replacement (`replace = TRUE`). This ensures that each resampled dataset has the same length as the original dataset.\n\n## Step 3: Perform desired operations on resampled data\n\nWithin the `lapply` function, you can perform any desired operations on the resampled data. This could involve calculating statistics, fitting models, or conducting hypothesis tests. Customize the code within the `lapply` function to suit your specific needs.\n\nExample: Bootstrapping the \"mpg\" column in mtcars:\nLet's illustrate the usage of our bootstrap function by resampling the \"mpg\" column from the \"mtcars\" dataset. We will calculate the mean of the resampled datasets.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Step 1: Load the dataset\ndata(mtcars)\n\n# Step 2: Define the bootstrap function\nbootstrap <- function(data, n) {\n  resampled_data <- lapply(1:n, function(i) {\n    resample <- sample(data, replace = TRUE)\n    mean(resample)  # Calculate the mean of each resampled dataset\n  })\n  return(resampled_data)\n}\n\n# Step 3: Perform the bootstrap resampling\nbootstrapped_means <- bootstrap(mtcars$mpg, n = 1000)\n\n# Display the first few resampled means\nhead(bootstrapped_means)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[[1]]\n[1] 20.21562\n\n[[2]]\n[1] 20.09375\n\n[[3]]\n[1] 19.59375\n\n[[4]]\n[1] 20.13437\n\n[[5]]\n[1] 21.17813\n\n[[6]]\n[1] 21.5375\n```\n:::\n:::\n\n\nIn the above example, we resample the \"mpg\" column of the \"mtcars\" dataset 1000 times. The `bootstrap()` function calculates the mean of each resampled dataset and returns a list of resampled means. The `head()` function is then used to display the first few resampled means.\n\nOf course we do not have to specify a statistic function in the bootstrap, we can choose to just return bootstrap samples and then perform some sort of statistic on it. Look at the following example using the above `bootstrapped_samples` data.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nquantile(unlist(bootstrapped_samples), \n         probs = c(0.025, 0.25, 0.5, 0.75, 0.975))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  2.5%    25%    50%    75%  97.5% \n10.400 15.725 19.200 22.800 33.900 \n```\n:::\n\n```{.r .cell-code}\nmean(unlist(bootstrapped_samples))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 20.06625\n```\n:::\n\n```{.r .cell-code}\nsd(unlist(bootstrapped_samples))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 5.827239\n```\n:::\n:::\n\n\n# Conclusion\n\nIn this blog post, we have learned how to write a bootstrap function in R using the `lapply` and `sample` functions. By employing these functions, we can easily generate resampled datasets to estimate the uncertainty of statistics or perform other desired operations. The example using the \"mpg\" column of the \"mtcars\" dataset demonstrated the usage of the bootstrap function to calculate resampled means. Feel free to customize the function to suit your specific needs and explore the power of bootstrap resampling in R.",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}