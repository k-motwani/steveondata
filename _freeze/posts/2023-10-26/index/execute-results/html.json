{
  "hash": "672d831bf6ceb8a337f405c8b5f8f3f7",
  "result": {
    "markdown": "---\ntitle: \"Plotting a Logistic Regression In Base R\"\nauthor: \"Steven P. Sanderson II, MPH\"\ndate: \"2023-10-26\"\ncategories: [rtip, viz]\n---\n\n\n# Introduction\n\nLogistic regression is a statistical method used for predicting the probability of a binary outcome. It's a fundamental tool in machine learning and statistics, often employed in various fields such as healthcare, finance, and marketing. We use logistic regression when we want to understand the relationship between one or more independent variables and a binary outcome, which can be \"yes/no,\" \"1/0,\" or any two-class distinction.\n\n# Getting Started\n\nBefore we dive into plotting the logistic regression curve, let's start with the basics. First, you'll need some data. For this blog post, I'll assume you have your dataset ready. If you don't, you can easily find sample datasets online to practice with.\n\n# Load the Data\n\nIn R, we use the `read.csv` function to load a CSV file into a data frame. For example, if you have a dataset called \"mydata.csv,\" you can load it like this:\n\n```R\n# Load the data into a data frame\ndata <- read.csv(\"mydata.csv\")\n```\n\nWe will instead use the following data set:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\n\nset.seed(123)\ndf <- tibble(\n    x = runif(100, 0, 10),\n    y = rbinom(100, 1, 1 / (1 + exp(-1 * (0.5 * x - 2.5))))\n)\n\nhead(df)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 2\n      x     y\n  <dbl> <int>\n1 2.88      0\n2 7.88      1\n3 4.09      0\n4 8.83      0\n5 9.40      1\n6 0.456     0\n```\n:::\n:::\n\n\n# Fit a Logistic Regression Model\n\nNext, we need to fit a logistic regression model to our data. We'll use the `glm` (Generalized Linear Model) function to do this. Suppose we want to predict the probability of a \"success\" (1) based on a single predictor variable \"x.\"\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Fit a logistic regression model\nmodel <- glm(y ~ x, data = df, family = binomial)\n\nbroom::glance(model)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 8\n  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs\n          <dbl>   <int>  <dbl> <dbl> <dbl>    <dbl>       <int> <int>\n1          138.      99  -51.5  107.  112.     103.          98   100\n```\n:::\n\n```{.r .cell-code}\nbroom::tidy(model)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2 × 5\n  term        estimate std.error statistic     p.value\n  <chr>          <dbl>     <dbl>     <dbl>       <dbl>\n1 (Intercept)   -2.63      0.571     -4.60 0.00000422 \n2 x              0.505     0.102      4.96 0.000000699\n```\n:::\n\n```{.r .cell-code}\nhead(broom::augment(model), 1) |> \n  dplyr::glimpse()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 1\nColumns: 8\n$ y          <int> 0\n$ x          <dbl> 2.875775\n$ .fitted    <dbl> -1.175925\n$ .resid     <dbl> -0.7333581\n$ .hat       <dbl> 0.01969748\n$ .sigma     <dbl> 1.028093\n$ .cooksd    <dbl> 0.003162007\n$ .std.resid <dbl> -0.7406892\n```\n:::\n:::\n\n\n# Predict Probabilities\n\nNow that we have our model, we can use it to predict probabilities. We'll create a sequence of values for our predictor variable, and for each value, we'll predict the probability of success, in this case `y`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create a sequence of predictor values\nx_seq <- seq(0, 10, 0.01)\n\n# Predict probabilities\nprobabilities <- predict(\n  model, \n  newdata = data.frame(x = x_seq), \n  type = \"response\"\n  )\n\nhead(x_seq)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.00 0.01 0.02 0.03 0.04 0.05\n```\n:::\n\n```{.r .cell-code}\nhead(probabilities)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n         1          2          3          4          5          6 \n0.06732923 0.06764710 0.06796636 0.06828702 0.06860908 0.06893255 \n```\n:::\n:::\n\n\nThe `predict` function here calculates the probabilities using our logistic regression model.\n\n# Plot the Logistic Regression Curve\n\nFinally, let's plot the logistic regression curve. We'll use the `plot` function to create a scatter plot of the data points, and then we'll overlay the logistic curve using the `lines` function.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Plot the data points\nplot(\n  df$x, df$y, \n  pch = 16, \n  col = \"blue\", \n  xlab = \"Predictor Variable\", \n  ylab = \"Probability of Success\"\n  )\n\n# Add the logistic regression curve\nlines(x_seq, probabilities, col = \"red\", lwd = 2)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\nAnd there you have it! You've successfully plotted a logistic regression curve in base R. The blue dots represent your data points, and the red curve is the logistic regression curve, showing how the probability of success changes with the predictor variable.\n\n# Conclusion\n\nI encourage you to try this out with your own dataset. Logistic regression is a powerful tool for modeling binary outcomes, and visualizing the curve helps you understand the relationship between your predictor variable and the probability of success. Experiment with different datasets and predictor variables to gain a deeper understanding of this essential statistical technique.\n\nRemember, practice makes perfect, and the more you work with logistic regression in R, the more proficient you'll become. Happy coding!",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}