{
  "hash": "9d9b79726090443101c1168ef41f8d23",
  "result": {
    "markdown": "---\ntitle: \"ADF and Phillips-Perron Tests for Stationarity using lists\"\nauthor: \"Steven P. Sanderson II, MPH\"\ndate: \"2023-01-23\"\ncategories: [code, rtip, lists, timeseries, lapply]\n---\n\n\n# Introduction\n\nA time series is a set of data points collected at regular intervals of time. Sometimes, the data points in a time series change over time in a predictable way. This is called a stationary time series. Other times, the data points change in an unpredictable way. This is called a non-stationary time series.\n\nImagine you are playing a game of catch with a friend. If you throw the ball back and forth at the same speed and distance, that's like a stationary time series. But if you keep throwing the ball harder and farther, that's like a non-stationary time series.\n\nThere are two tests that we can use to see if a time series is stationary or non-stationary. The first test is called the ADF test, which stands for Augmented Dickey-Fuller test. The second test is called the Phillips-Perron test.\n\nThe ADF test looks at the data points and checks to see if the average value of the data points is the same over time. If the average value is the same, then the time series is stationary. If the average value is not the same, then the time series is non-stationary.\n\nThe Phillips-Perron test is similar to the ADF test, but it is a bit more advanced. It checks to see if the data points are changing in a predictable way. If the data points are changing in a predictable way, then the time series is stationary. If the data points are changing in an unpredictable way, then the time series is non-stationary.\n\nSo, in short, The ADF test checks if the mean of the time series is constant over time and Phillips-Perron test checks if the variance of the time series is constant over time.\n\nNow, you can use these two tests to see if the time series you are studying is stationary or non-stationary, just like how you can use the game of catch to see if your throws are the same or different.\n\n# Function\n\nTo perform these test we can use two libraries, one is the `{tseries}` library for the `adf.test()` and the other is the `{aTSA}` for the `pp.test()`\n\nLet's see some examples.\n\n# Examples\n\nLet's first make our time series obejcts and place them in a list.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tseries)\nlibrary(aTSA)\n\n# create time series objects\nts1 <- ts(rnorm(100), start = c(1990,1), frequency = 12)\nts2 <- ts(rnorm(100), start = c(1995,1), frequency = 12)\nts3 <- ts(rnorm(100), start = c(2000,1), frequency = 12)\n\n# create list of time series\nts_list <- list(ts1, ts2, ts3)\n```\n:::\n\n\nNow let's make our functions.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# function to test for stationarity\nadf_is_stationary <- function(x) {\n  adf.test(x)$p.value > 0.05\n}\n\npp_is_stationary <- function(x) {\n  pp_df <- pp.test(x) |> as.data.frame() \n  pp_df$p.value > 0.05\n}\n```\n:::\n\n\nTime to use `lapply()`!\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# apply function to each time series in list\nlapply(ts_list, adf_is_stationary)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAugmented Dickey-Fuller Test \nalternative: stationary \n \nType 1: no drift no trend \n     lag    ADF p.value\n[1,]   0 -10.97    0.01\n[2,]   1  -7.70    0.01\n[3,]   2  -5.23    0.01\n[4,]   3  -4.05    0.01\n[5,]   4  -4.03    0.01\nType 2: with drift no trend \n     lag    ADF p.value\n[1,]   0 -11.48    0.01\n[2,]   1  -8.32    0.01\n[3,]   2  -5.81    0.01\n[4,]   3  -4.59    0.01\n[5,]   4  -4.63    0.01\nType 3: with drift and trend \n     lag    ADF p.value\n[1,]   0 -11.42    0.01\n[2,]   1  -8.28    0.01\n[3,]   2  -5.77    0.01\n[4,]   3  -4.56    0.01\n[5,]   4  -4.59    0.01\n---- \nNote: in fact, p.value = 0.01 means p.value <= 0.01 \nAugmented Dickey-Fuller Test \nalternative: stationary \n \nType 1: no drift no trend \n     lag    ADF p.value\n[1,]   0 -10.60    0.01\n[2,]   1  -7.88    0.01\n[3,]   2  -5.96    0.01\n[4,]   3  -5.26    0.01\n[5,]   4  -4.90    0.01\nType 2: with drift no trend \n     lag    ADF p.value\n[1,]   0 -10.64    0.01\n[2,]   1  -7.98    0.01\n[3,]   2  -6.08    0.01\n[4,]   3  -5.41    0.01\n[5,]   4  -5.08    0.01\nType 3: with drift and trend \n     lag    ADF p.value\n[1,]   0 -10.58    0.01\n[2,]   1  -7.94    0.01\n[3,]   2  -6.06    0.01\n[4,]   3  -5.39    0.01\n[5,]   4  -5.07    0.01\n---- \nNote: in fact, p.value = 0.01 means p.value <= 0.01 \nAugmented Dickey-Fuller Test \nalternative: stationary \n \nType 1: no drift no trend \n     lag   ADF p.value\n[1,]   0 -9.19    0.01\n[2,]   1 -6.65    0.01\n[3,]   2 -5.41    0.01\n[4,]   3 -5.33    0.01\n[5,]   4 -4.77    0.01\nType 2: with drift no trend \n     lag   ADF p.value\n[1,]   0 -9.14    0.01\n[2,]   1 -6.62    0.01\n[3,]   2 -5.39    0.01\n[4,]   3 -5.30    0.01\n[5,]   4 -4.75    0.01\nType 3: with drift and trend \n     lag   ADF p.value\n[1,]   0 -9.11    0.01\n[2,]   1 -6.59    0.01\n[3,]   2 -5.36    0.01\n[4,]   3 -5.29    0.01\n[5,]   4 -4.73    0.01\n---- \nNote: in fact, p.value = 0.01 means p.value <= 0.01 \n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n[[1]]\nlogical(0)\n\n[[2]]\nlogical(0)\n\n[[3]]\nlogical(0)\n```\n:::\n\n```{.r .cell-code}\nlapply(ts_list, pp_is_stationary)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nPhillips-Perron Unit Root Test \nalternative: stationary \n \nType 1: no drift no trend \n lag Z_rho p.value\n   3  -111    0.01\n----- \n Type 2: with drift no trend \n lag Z_rho p.value\n   3  -110    0.01\n----- \n Type 3: with drift and trend \n lag Z_rho p.value\n   3  -110    0.01\n--------------- \nNote: p-value = 0.01 means p.value <= 0.01 \nPhillips-Perron Unit Root Test \nalternative: stationary \n \nType 1: no drift no trend \n lag Z_rho p.value\n   3  -101    0.01\n----- \n Type 2: with drift no trend \n lag Z_rho p.value\n   3  -101    0.01\n----- \n Type 3: with drift and trend \n lag Z_rho p.value\n   3  -101    0.01\n--------------- \nNote: p-value = 0.01 means p.value <= 0.01 \nPhillips-Perron Unit Root Test \nalternative: stationary \n \nType 1: no drift no trend \n lag Z_rho p.value\n   3 -92.9    0.01\n----- \n Type 2: with drift no trend \n lag Z_rho p.value\n   3 -92.9    0.01\n----- \n Type 3: with drift and trend \n lag Z_rho p.value\n   3   -93    0.01\n--------------- \nNote: p-value = 0.01 means p.value <= 0.01 \n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n[[1]]\n[1] FALSE FALSE FALSE\n\n[[2]]\n[1] FALSE FALSE FALSE\n\n[[3]]\n[1] FALSE FALSE FALSE\n```\n:::\n:::\n\n\nVoila!",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}