{
  "hash": "354570479e856ce8eb3856228de57744",
  "result": {
    "markdown": "---\ntitle: \"Brownian Motion\"\nauthor: \"Steven P. Sanderson II, MPH\"\ndate: \"2023-01-06\"\ncategories: [code, rtip, weeklytip]\n---\n\n\n# Introduction\n\n[Brownian motion](https://en.wikipedia.org/wiki/Brownian_motion), also known as the random motion of particles suspended in a fluid, is a phenomenon that was first described by Scottish botanist Robert Brown in 1827. It occurs when a particle is subjected to a series of random collisions with the molecules in the fluid.\n\nThe motion of the particle can be described mathematically using the following equation:\n\n$$ \\frac{dx_t}{dt} = \\mu + \\sigma \\cdot W_t $$\n\nWhere $x_t$ represents the position of the particle at time t, $\\mu$ is the drift coefficient, $\\sigma$ is the diffusion coefficient, and $W_t$ is a Wiener process (a type of random process).\n\nBrownian motion has a number of important applications, including in the field of finance. It is used to model the random movements of financial assets, such as stocks, over time. It can also be used to estimate the volatility of an asset, as well as to calculate the prices of financial derivatives such as options.\n\nIn physics, Brownian motion is used to study the behavior of small particles suspended in a fluid, as well as to understand the properties of fluids at the molecular level. It has also been used to study the motion of biological molecules, such as proteins, within cells.\n\nOverall, Brownian motion is a fundamental concept that has wide-ranging applications in a variety of fields, including finance, physics, and biology.\n\n# Function\n\nLet's take a look at a function to produce such results. This type of functionality will be coming to my R packages [`{TidyDensity}`](https://www.spsanderson.com/TidyDensity/) and to [`{healthyR.ts}`](https://www.spsanderson.com/healthyR.ts/)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'dplyr'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n```\n:::\n\n```{.r .cell-code}\nlibrary(ggplot2)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'ggplot2' was built under R version 4.2.2\n```\n:::\n\n```{.r .cell-code}\nlibrary(forcats)\n\nbrownian_motion <- function(T, N, delta_t) {\n  # T: total time of the simulation (in seconds)\n  # N: number of simulations to generate\n  # delta_t: time step size (in seconds)\n  \n  # Initialize empty data.frame to store the simulations\n  sim_data <- data.frame()\n  \n  # Generate N simulations\n  for (i in 1:N) {\n    # Initialize the current simulation with a starting value of 0\n    sim <- c(0)\n    \n    # Generate the brownian motion values for each time step\n    for (t in 1:(T / delta_t)) {\n      sim <- c(sim, sim[t] + rnorm(1, mean = 0, sd = sqrt(delta_t)))\n    }\n    \n    # Bind the time steps, simulation values, and simulation number together\n    # in a data.frame and add it to the result\n    sim_data <- rbind(\n      sim_data, \n      data.frame(\n        t = seq(0, T, delta_t), \n        y = sim, \n        sim_number = i\n        )\n      ) %>%\n      as_tibble()\n  }\n  \n  sim_data <- sim_data %>%\n    mutate(sim_number = as_factor(sim_number)\n                  )\n  return(sim_data)\n}\n```\n:::\n\n\nWe see that the internal variable `sim` is set to 0, this in the future will be set to an initial value that a user can provide.\n\n# Examples\n\nLet's take a look at a couple of examples.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbrownian_motion(40, 25, .2) %>%\n  ggplot(aes(x = t, y = y, group = sim_number, color = sim_number)) +\n  geom_line() +\n  geom_smooth(se = FALSE, \n              aes(group = FALSE), \n              color = \"black\", \n              linetype = \"dashed\") +\n  theme_minimal() +\n  labs(\n    x = \"Time t\",\n    y = \"Brownian Motion Value y\"\n  ) +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\nNow lets take a look at the change in a few different ones at the same time.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbm_tbl <- rbind(\n  brownian_motion(40, 25, .2) %>%\n    mutate(label = \"20% Volatility\"),\n  brownian_motion(40, 25, .1) %>%\n    mutate(label = \"10% Volatility\"),\n  brownian_motion(40, 25, .05) %>%\n    mutate(label = \"5% Volatility\"),\n  brownian_motion(40, 25, .025) %>%\n    mutate(label = \"2.5% Volatility\")\n)\n\nggplot(bm_tbl, aes(x = t, y = y, group = sim_number, color = sim_number)) +\n  geom_line() +\n  facet_wrap(~ label, scales = \"free\") +\n    geom_smooth(se = FALSE, \n              aes(group = FALSE), \n              color = \"black\", \n              linetype = \"dashed\") +\n  theme_minimal() +\n    labs(\n    x = \"Time t\",\n    y = \"Brownian Motion Value y\"\n  ) +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\nVoila!",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}