<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>Steve&#39;s Data Tips and Tricks</title>
<link>https://www.spsanderson.com/steveondata/index.html</link>
<atom:link href="https://www.spsanderson.com/steveondata/index.xml" rel="self" type="application/rss+xml"/>
<description></description>
<generator>quarto-1.2.335</generator>
<lastBuildDate>Fri, 17 Mar 2023 04:00:00 GMT</lastBuildDate>
<item>
  <title>Use of the apply family of functions</title>
  <dc:creator>Steven P. Sanderson II, MPH</dc:creator>
  <link>https://www.spsanderson.com/steveondata/posts/rtip-2023-03-17/index.html</link>
  <description><![CDATA[ 




<p>I am thrilled to announce that the R universe of packages <a href="https://www.spsanderson.com/healthyverse/"><code>{healthyverse}</code></a> has surpassed 60,000 downloads! Thank you to everyone who has downloaded and used these packages, your support is greatly appreciated.</p>
<p>For those who are not familiar, the {healthyverse} package is a collection of R packages focused on data science and analysis with an emphasis on healthcare. These packages are ever evolving and for the most part still in an experimental stage, but are maturing. These packages are:</p>
<ul>
<li><a href="https://www.spsanderson.com/healthyR/"><code>{healthyR}</code></a></li>
<li><a href="https://www.spsanderson.com/healthyR.ts/"><code>{healthyR.ts}</code></a></li>
<li><a href="https://www.spsanderson.com/healthyR.ai/"><code>{healthyR.ai}</code></a></li>
<li><a href="https://www.spsanderson.com/healthyR.data/"><code>{healthyR.data}</code></a></li>
<li><a href="https://www.spsanderson.com/TidyDensity/"><code>{TidyDensity}</code></a></li>
<li><a href="https://www.spsanderson.com/tidyAML/"><code>{tidyAML}</code></a></li>
</ul>
<p>I am continuously working on updates and improvements to the {healthyverse} package, and I hope to release them soon. Some of the updates include bug fixes, new functionality, and enhancements to existing functions.</p>
<p>Additionally, I want to encourage users who are interested in contributing to the {healthyverse} package to submit pull requests. Contributions can be in the form of bug fixes, new functions, or enhancements to existing ones. I am always open to feedback and suggestions on how to improve these packages.</p>
<p>Once again, thank you to everyone who has downloaded and used the {healthyverse} package. Your support motivates me to continue working on this project and making it the best it can be.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.spsanderson.com/steveondata/posts/rtip-2023-03-17/60k.jpg" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">60k</figcaption><p></p>
</figure>
</div>



 ]]></description>
  <category>thanks</category>
  <guid>https://www.spsanderson.com/steveondata/posts/rtip-2023-03-17/index.html</guid>
  <pubDate>Fri, 17 Mar 2023 04:00:00 GMT</pubDate>
  <media:content url="https://www.spsanderson.com/steveondata/posts/rtip-2023-03-17/60k.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Use of the apply family of functions</title>
  <dc:creator>Steven P. Sanderson II, MPH</dc:creator>
  <link>https://www.spsanderson.com/steveondata/posts/rtip-2023-03-21/index.html</link>
  <description><![CDATA[ 




<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>The <a href="https://cci30.com/">CCI30</a> Crypto Index is a cryptocurrency index that tracks the performance of the top 30 cryptocurrencies by market capitalization. It was created in 2017 by a team of researchers and analysts from the CryptoCompare and MVIS indices.</p>
<p>The CCI30 Crypto Index is designed to provide a broad-based and representative measure of the cryptocurrency market’s overall performance. It includes a diverse range of cryptocurrencies, such as Bitcoin, Ethereum, Litecoin, Ripple, and many others. The index is weighted by market capitalization, with each cryptocurrency’s weight determined by its market capitalization relative to the total market capitalization of all 30 cryptocurrencies.</p>
<p>The CCI30 Crypto Index has become a popular benchmark for the cryptocurrency market, as it offers a comprehensive view of the market’s performance, rather than just focusing on one particular cryptocurrency. It is often used by investors, traders, and researchers to analyze trends and make investment decisions.</p>
<p>One notable feature of the CCI30 Crypto Index is that it is rebalanced every quarter. This means that the composition of the index is adjusted to reflect changes in the market capitalization of the constituent cryptocurrencies. This helps to ensure that the index remains representative of the overall cryptocurrency market.</p>
<p>Overall, the CCI30 Crypto Index provides a useful tool for tracking the performance of the cryptocurrency market. It is a valuable resource for investors, traders, and researchers who are interested in this exciting and rapidly evolving field.</p>
</section>
<section id="code-explanation" class="level1">
<h1>Code Explanation</h1>
<p>Let’s break it down step by step:</p>
<ul>
<li>The first line of the code loads the “dplyr” package, which provides a set of functions for data manipulation.</li>
<li>The second line of the code reads the HTML code from the website “https://cci30.com/” using the “read_html” function from the “xml2” package.</li>
<li>The next two blocks of code extract two tables from the HTML document using the “html_node” function from the “rvest” package. The tables are located at two different XPaths in the HTML document.</li>
<li>The extracted tables are then converted into tibbles using the “as_tibble” function from the “tibble” package. The tibbles are further transformed by selecting only the columns from the second to the fifth column using the “select” function from the “dplyr” package.</li>
<li>The column names of the tibbles are then set using the “set_names” function from the “purrr” package.</li>
<li>Finally, the two tibbles are combined using the “union” function from the “dplyr” package, and the resulting tibble is printed to the console.</li>
</ul>
<p>In summary, the code is extracting two tables from a website, transforming them into tibbles, selecting a subset of columns, renaming the columns, and combining them into a single tibble.</p>
</section>
<section id="example" class="level1">
<h1>Example</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1">cci30 <span class="ot" style="color: #003B4F;">&lt;-</span> xml2<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">read_html</span>(<span class="st" style="color: #20794D;">"https://cci30.com/"</span>)</span>
<span id="cb1-2"></span>
<span id="cb1-3">tbl1 <span class="ot" style="color: #003B4F;">&lt;-</span> cci30 <span class="sc" style="color: #5E5E5E;">|&gt;</span></span>
<span id="cb1-4">    rvest<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">html_node</span>(<span class="at" style="color: #657422;">xpath =</span> <span class="st" style="color: #20794D;">"/html/body/div[2]/div/div/div/div[2]/div[1]/table"</span>) <span class="sc" style="color: #5E5E5E;">|&gt;</span></span>
<span id="cb1-5">    rvest<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">html_table</span>(<span class="at" style="color: #657422;">header =</span> <span class="dv" style="color: #AD0000;">1</span>) <span class="sc" style="color: #5E5E5E;">|&gt;</span></span>
<span id="cb1-6">    tibble<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">as_tibble</span>() <span class="sc" style="color: #5E5E5E;">|&gt;</span></span>
<span id="cb1-7">    dplyr<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">select</span>(<span class="dv" style="color: #AD0000;">2</span><span class="sc" style="color: #5E5E5E;">:</span><span class="dv" style="color: #AD0000;">5</span>) <span class="sc" style="color: #5E5E5E;">|&gt;</span></span>
<span id="cb1-8">    purrr<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">set_names</span>(</span>
<span id="cb1-9">        <span class="st" style="color: #20794D;">"Coin"</span>,<span class="st" style="color: #20794D;">"Price"</span>,<span class="st" style="color: #20794D;">"Mkt Cap"</span>,<span class="st" style="color: #20794D;">"Daily Change"</span></span>
<span id="cb1-10">    )</span>
<span id="cb1-11"></span>
<span id="cb1-12">tbl2 <span class="ot" style="color: #003B4F;">&lt;-</span> cci30 <span class="sc" style="color: #5E5E5E;">|&gt;</span></span>
<span id="cb1-13">    rvest<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">html_node</span>(<span class="at" style="color: #657422;">xpath =</span> <span class="st" style="color: #20794D;">"/html/body/div[2]/div/div/div/div[2]/div[2]/table"</span>) <span class="sc" style="color: #5E5E5E;">|&gt;</span></span>
<span id="cb1-14">    rvest<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">html_table</span>(<span class="at" style="color: #657422;">header =</span> <span class="dv" style="color: #AD0000;">1</span>) <span class="sc" style="color: #5E5E5E;">|&gt;</span></span>
<span id="cb1-15">    tibble<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">as_tibble</span>() <span class="sc" style="color: #5E5E5E;">|&gt;</span></span>
<span id="cb1-16">    dplyr<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">select</span>(<span class="dv" style="color: #AD0000;">2</span><span class="sc" style="color: #5E5E5E;">:</span><span class="dv" style="color: #AD0000;">5</span>) <span class="sc" style="color: #5E5E5E;">|&gt;</span></span>
<span id="cb1-17">    purrr<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">set_names</span>(</span>
<span id="cb1-18">        <span class="st" style="color: #20794D;">"Coin"</span>,<span class="st" style="color: #20794D;">"Price"</span>,<span class="st" style="color: #20794D;">"Mkt Cap"</span>,<span class="st" style="color: #20794D;">"Daily Change"</span></span>
<span id="cb1-19">    )</span>
<span id="cb1-20"></span>
<span id="cb1-21">tbl <span class="ot" style="color: #003B4F;">&lt;-</span> tbl1 <span class="sc" style="color: #5E5E5E;">|&gt;</span></span>
<span id="cb1-22">  dplyr<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">union</span>(tbl2) <span class="sc" style="color: #5E5E5E;">|&gt;</span></span>
<span id="cb1-23">  knitr<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">kable</span>()</span>
<span id="cb1-24"></span>
<span id="cb1-25">tbl</span></code></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: left;">Coin</th>
<th style="text-align: left;">Price</th>
<th style="text-align: left;">Mkt Cap</th>
<th style="text-align: left;">Daily Change</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Bitcoin</td>
<td style="text-align: left;">$27,767.24</td>
<td style="text-align: left;">$536,553,055,078</td>
<td style="text-align: left;">0.17%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ethereum</td>
<td style="text-align: left;">$1,735.32</td>
<td style="text-align: left;">$212,357,972,798</td>
<td style="text-align: left;">0.04%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">BNB</td>
<td style="text-align: left;">$332.92</td>
<td style="text-align: left;">$52,565,516,823</td>
<td style="text-align: left;">0.13%</td>
</tr>
<tr class="even">
<td style="text-align: left;">XRP</td>
<td style="text-align: left;">$0.37</td>
<td style="text-align: left;">$19,087,613,742</td>
<td style="text-align: left;">0.13%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cardano</td>
<td style="text-align: left;">$0.33</td>
<td style="text-align: left;">$11,547,419,916</td>
<td style="text-align: left;">0.05%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Polygon</td>
<td style="text-align: left;">$1.10</td>
<td style="text-align: left;">$9,643,536,324</td>
<td style="text-align: left;">0.17%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Dogecoin</td>
<td style="text-align: left;">$0.07</td>
<td style="text-align: left;">$9,484,198,878</td>
<td style="text-align: left;">0.34%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Solana</td>
<td style="text-align: left;">$22.18</td>
<td style="text-align: left;">$8,507,167,040</td>
<td style="text-align: left;">0.12%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Polkadot</td>
<td style="text-align: left;">$6.10</td>
<td style="text-align: left;">$7,119,808,610</td>
<td style="text-align: left;">0.08%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Shiba Inu</td>
<td style="text-align: left;">$0.00</td>
<td style="text-align: left;">$6,169,390,592</td>
<td style="text-align: left;">0.24%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TRON</td>
<td style="text-align: left;">$0.07</td>
<td style="text-align: left;">$5,936,468,687</td>
<td style="text-align: left;">0.14%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Litecoin</td>
<td style="text-align: left;">$78.42</td>
<td style="text-align: left;">$5,685,409,727</td>
<td style="text-align: left;">0.40%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Avalanche</td>
<td style="text-align: left;">$16.64</td>
<td style="text-align: left;">$5,418,625,875</td>
<td style="text-align: left;">0.06%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Uniswap</td>
<td style="text-align: left;">$6.19</td>
<td style="text-align: left;">$4,716,487,304</td>
<td style="text-align: left;">0.19%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Chainlink</td>
<td style="text-align: left;">$7.06</td>
<td style="text-align: left;">$3,649,558,739</td>
<td style="text-align: left;">0.06%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cosmos</td>
<td style="text-align: left;">$11.56</td>
<td style="text-align: left;">$3,309,216,299</td>
<td style="text-align: left;">0.03%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">UNUS SED LEO</td>
<td style="text-align: left;">$3.35</td>
<td style="text-align: left;">$3,195,413,769</td>
<td style="text-align: left;">-0.55%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Toncoin</td>
<td style="text-align: left;">$2.38</td>
<td style="text-align: left;">$2,907,590,168</td>
<td style="text-align: left;">-0.62%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Monero</td>
<td style="text-align: left;">$151.58</td>
<td style="text-align: left;">$2,767,118,876</td>
<td style="text-align: left;">-0.01%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ethereum Classic</td>
<td style="text-align: left;">$19.58</td>
<td style="text-align: left;">$2,741,016,944</td>
<td style="text-align: left;">-6.84%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OKB</td>
<td style="text-align: left;">$44.34</td>
<td style="text-align: left;">$2,660,455,327</td>
<td style="text-align: left;">0.56%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Bitcoin Cash</td>
<td style="text-align: left;">$130.60</td>
<td style="text-align: left;">$2,526,173,508</td>
<td style="text-align: left;">-0.48%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Stellar</td>
<td style="text-align: left;">$0.09</td>
<td style="text-align: left;">$2,293,156,708</td>
<td style="text-align: left;">-0.04%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cronos</td>
<td style="text-align: left;">$0.07</td>
<td style="text-align: left;">$1,787,408,658</td>
<td style="text-align: left;">1.05%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">NEAR Protocol</td>
<td style="text-align: left;">$2.00</td>
<td style="text-align: left;">$1,728,135,015</td>
<td style="text-align: left;">0.26%</td>
</tr>
<tr class="even">
<td style="text-align: left;">VeChain</td>
<td style="text-align: left;">$0.02</td>
<td style="text-align: left;">$1,665,251,562</td>
<td style="text-align: left;">0.33%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Quant</td>
<td style="text-align: left;">$126.33</td>
<td style="text-align: left;">$1,525,183,149</td>
<td style="text-align: left;">0.31%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Internet Computer</td>
<td style="text-align: left;">$5.11</td>
<td style="text-align: left;">$1,516,076,264</td>
<td style="text-align: left;">0.19%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Algorand</td>
<td style="text-align: left;">$0.21</td>
<td style="text-align: left;">$1,498,361,340</td>
<td style="text-align: left;">0.41%</td>
</tr>
<tr class="even">
<td style="text-align: left;">ApeCoin</td>
<td style="text-align: left;">$4.06</td>
<td style="text-align: left;">$1,496,070,125</td>
<td style="text-align: left;">0.12%</td>
</tr>
</tbody>
</table>
</div>
</div>


</section>

 ]]></description>
  <category>crypto</category>
  <category>cci30</category>
  <guid>https://www.spsanderson.com/steveondata/posts/rtip-2023-03-21/index.html</guid>
  <pubDate>Fri, 17 Mar 2023 04:00:00 GMT</pubDate>
</item>
<item>
  <title>Use of the apply family of functions</title>
  <dc:creator>Steven P. Sanderson II, MPH</dc:creator>
  <link>https://www.spsanderson.com/steveondata/posts/rtip-2023-03-10/index.html</link>
  <description><![CDATA[ 




<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>In this post I will talk about the use of the R functions <code>apply()</code>, <code>lapply()</code>, <code>sapply()</code>, <code>tapply()</code>, and <code>vapply()</code> with examples.</p>
<p>These functions are all designed to help users apply a function to a set of data in R, but they differ in their input and output types, as well as in the way they handle missing values and other complexities. By using the right function for your particular problem, you can make your code more efficient and easier to read.</p>
<p>Let’s start with the basics.</p>
<section id="the-basics" class="level2">
<h2 class="anchored" data-anchor-id="the-basics">The Basics</h2>
<p>Before we dive into the details of each function, let’s define some terms:</p>
<ul>
<li>A vector is a one-dimensional array of data, like a list of numbers or strings.</li>
<li>A matrix is a two-dimensional array of data, like a table of numbers.</li>
<li>A data frame is a two-dimensional object that can hold different types of data, like a spreadsheet.</li>
<li>A list is a collection of objects, which can be of different types, like a shopping bag full of different items.</li>
</ul>
<p>Each of the five functions we’ll discuss here takes a list as input (although some can also take vectors or matrices). Let’s create a list object to use in our examples:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1">my_list <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">list</span>(</span>
<span id="cb1-2">  <span class="at" style="color: #657422;">a =</span> <span class="fu" style="color: #4758AB;">c</span>(<span class="dv" style="color: #AD0000;">1</span>, <span class="dv" style="color: #AD0000;">2</span>, <span class="dv" style="color: #AD0000;">3</span>),</span>
<span id="cb1-3">  <span class="at" style="color: #657422;">b =</span> <span class="fu" style="color: #4758AB;">matrix</span>(<span class="dv" style="color: #AD0000;">1</span><span class="sc" style="color: #5E5E5E;">:</span><span class="dv" style="color: #AD0000;">6</span>, <span class="at" style="color: #657422;">nrow =</span> <span class="dv" style="color: #AD0000;">2</span>),</span>
<span id="cb1-4">  <span class="at" style="color: #657422;">c =</span> <span class="fu" style="color: #4758AB;">data.frame</span>(<span class="at" style="color: #657422;">x =</span> <span class="dv" style="color: #AD0000;">1</span><span class="sc" style="color: #5E5E5E;">:</span><span class="dv" style="color: #AD0000;">3</span>, <span class="at" style="color: #657422;">y =</span> <span class="fu" style="color: #4758AB;">c</span>(<span class="st" style="color: #20794D;">"a"</span>, <span class="st" style="color: #20794D;">"b"</span>, <span class="st" style="color: #20794D;">"c"</span>)),</span>
<span id="cb1-5">  <span class="at" style="color: #657422;">d =</span> <span class="fu" style="color: #4758AB;">c</span>(<span class="dv" style="color: #AD0000;">4</span>, <span class="cn" style="color: #8f5902;">NA</span>, <span class="dv" style="color: #AD0000;">6</span>),</span>
<span id="cb1-6">  <span class="at" style="color: #657422;">e =</span> <span class="fu" style="color: #4758AB;">list</span>(<span class="st" style="color: #20794D;">"foo"</span>, <span class="st" style="color: #20794D;">"bar"</span>, <span class="st" style="color: #20794D;">"baz"</span>)</span>
<span id="cb1-7">)</span></code></pre></div>
</div>
<p>This list contains five elements:</p>
<ul>
<li>A vector of numbers (a)</li>
<li>A matrix of numbers (b)</li>
<li>A data frame with two columns (c)</li>
<li>A vector of numbers with a missing value (d)</li>
<li>A list of character strings (e)</li>
</ul>
<p>Now that we have our data, let’s look at each of the functions in turn.</p>
</section>
<section id="the-functions" class="level2">
<h2 class="anchored" data-anchor-id="the-functions">The Functions</h2>
<p><strong>apply()</strong></p>
<p>The <code>apply()</code> function applies a function to the rows or columns of a matrix or array. It is most commonly used with matrices, but can also be used with higher-dimensional arrays. The function takes three arguments:</p>
<ul>
<li>The matrix or array to apply the function to</li>
<li>The margin (1 for rows, 2 for columns, or a vector of dimensions)</li>
<li>The function to apply</li>
</ul>
<p>Let’s apply the <code>mean()</code> function to the columns of our matrix in <code>my_list$b</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;">apply</span>(my_list<span class="sc" style="color: #5E5E5E;">$</span>b, <span class="dv" style="color: #AD0000;">2</span>, mean)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.5 3.5 5.5</code></pre>
</div>
</div>
<p>This will return a vector of means for each column of the matrix</p>
<p><strong>lapply()</strong></p>
<p>The <code>lapply()</code> function applies a function to each element of a list and returns a list of the results. It takes two arguments:</p>
<ul>
<li>The list to apply the function to</li>
<li>The function to apply</li>
</ul>
<p>Let’s apply the <code>class()</code> function to each element of our list:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="fu" style="color: #4758AB;">lapply</span>(my_list, class)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$a
[1] "numeric"

$b
[1] "matrix" "array" 

$c
[1] "data.frame"

$d
[1] "numeric"

$e
[1] "list"</code></pre>
</div>
</div>
<p>This will return a list of the classes of each element.</p>
<p><strong>sapply()</strong></p>
<p>The <code>sapply()</code> function is similar to <code>lapply()</code>, but it simplifies the output to a vector or matrix if possible. It takes the same two arguments as <code>lapply()</code>:</p>
<ul>
<li>The list to apply the function</li>
<li>The function to apply</li>
</ul>
<p>Let’s apply the <code>length()</code> function to each element of our list using sapply():</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="fu" style="color: #4758AB;">sapply</span>(my_list, length)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>a b c d e 
3 6 2 3 3 </code></pre>
</div>
</div>
<p>This will return a vector of lengths for each element.</p>
<p><strong>tapply()</strong></p>
<p>The <code>tapply()</code> function applies a function to subsets of a vector or data frame, grouped by one or more factors. It takes three arguments:</p>
<ul>
<li>The vector or data frame to apply the function to</li>
<li>The factor(s) to group the data by</li>
<li>The function to apply</li>
</ul>
<p>Let’s apply the <code>mean()</code> function to the elements of our vector <code>my_list$d</code>, grouped by whether they are missing or not:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="fu" style="color: #4758AB;">tapply</span>(my_list<span class="sc" style="color: #5E5E5E;">$</span>d, <span class="sc" style="color: #5E5E5E;">!</span><span class="fu" style="color: #4758AB;">is.na</span>(my_list<span class="sc" style="color: #5E5E5E;">$</span>d), mean)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>FALSE  TRUE 
   NA     5 </code></pre>
</div>
</div>
<p>This will return a vector of means for each group where they are NOT NA.</p>
<p><strong>vapply()</strong></p>
<p>The <code>vapply()</code> function is similar to sapply(), but allows the user to specify the output type and length, making it more efficient and less prone to errors. It takes four arguments:</p>
<ul>
<li>The list to apply the function to</li>
<li>The function to apply</li>
<li>The output type of the function</li>
<li>The length of the output vector or matrix</li>
</ul>
<p>Let’s apply the <code>length()</code> function to each element of our list, specifying that the output type is an integer and the length is 1:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><span class="fu" style="color: #4758AB;">vapply</span>(my_list, length, <span class="fu" style="color: #4758AB;">integer</span>(<span class="dv" style="color: #AD0000;">1</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>a b c d e 
3 6 2 3 3 </code></pre>
</div>
</div>
<p>This will return a matrix of lengths for each element, with 1 row:</p>
</section>
</section>
<section id="conclusion" class="level1">
<h1>Conclusion</h1>
<p>In this blog post, we have covered the basics of the <code>apply()</code>, <code>lapply()</code>, <code>sapply()</code>, <code>tapply()</code>, and <code>vapply()</code> functions in R. These functions are all useful for applying a function to a set of data in R, but they differ in their input and output types, as well as in the way they handle missing values and other complexities. By using the right function for your particular problem, you can make your code more efficient and easier to read.</p>
<p>Voila!</p>


</section>

 ]]></description>
  <category>code</category>
  <category>rtip</category>
  <category>apply</category>
  <guid>https://www.spsanderson.com/steveondata/posts/rtip-2023-03-10/index.html</guid>
  <pubDate>Fri, 10 Mar 2023 05:00:00 GMT</pubDate>
</item>
<item>
  <title>Multiple Solutions to speedup tidy_bernoulli() with {data.table}</title>
  <dc:creator>Steven P. Sanderson II, MPH</dc:creator>
  <link>https://www.spsanderson.com/steveondata/posts/rtip-2023-03-09/index.html</link>
  <description><![CDATA[ 




<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>I had just recently posted on making an attempt to speedup computations with my package <a href="https://www.spsanderson.com/TidyDensity/"><code>{TidyDensity}</code></a> using a purely data.table solution, yes of course I can use <code>{dtplyr}</code> or <code>{tidytable}</code> but that not the challenge put to me.</p>
<p>My original attempt was worse than the original solution of <code>tidy_bernoulli()</code>. After I posted on Mastadon, LinkedIn and Reddit, I recieved potential solutions from each site by users. Let’s check them out below.</p>
</section>
<section id="function" class="level1">
<h1>Function</h1>
<p>First let’s load in the necessary libraries.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;">library</span>(data.table)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;">library</span>(tidyverse)</span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;">library</span>(rbenchmark)</span>
<span id="cb1-4"><span class="fu" style="color: #4758AB;">library</span>(TidyDensity)</span></code></pre></div>
</div>
<p>Now let’s look at the different solutions.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;"># My original new function</span></span>
<span id="cb2-2">new_func <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="cf" style="color: #003B4F;">function</span>(num_sims, n, pr) {</span>
<span id="cb2-3"></span>
<span id="cb2-4">  <span class="co" style="color: #5E5E5E;"># Create a data.table with one row per simulation</span></span>
<span id="cb2-5">  sim_data <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">data.table</span>(<span class="at" style="color: #657422;">sim_number =</span> <span class="fu" style="color: #4758AB;">factor</span>(<span class="fu" style="color: #4758AB;">seq</span>(<span class="dv" style="color: #AD0000;">1</span>, num_sims, <span class="dv" style="color: #AD0000;">1</span>)))</span>
<span id="cb2-6"></span>
<span id="cb2-7">  <span class="co" style="color: #5E5E5E;"># Group the data by sim_number and add columns for x and y</span></span>
<span id="cb2-8">  sim_data[, <span class="st" style="color: #20794D;">`</span><span class="at" style="color: #657422;">:=</span><span class="st" style="color: #20794D;">`</span> (</span>
<span id="cb2-9">    <span class="at" style="color: #657422;">x =</span> <span class="fu" style="color: #4758AB;">list</span>(<span class="dv" style="color: #AD0000;">1</span><span class="sc" style="color: #5E5E5E;">:</span>n),</span>
<span id="cb2-10">    <span class="at" style="color: #657422;">y =</span> <span class="fu" style="color: #4758AB;">list</span>(stats<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">rbinom</span>(<span class="at" style="color: #657422;">n =</span> n, <span class="at" style="color: #657422;">size =</span> <span class="dv" style="color: #AD0000;">1</span>, <span class="at" style="color: #657422;">prob =</span> pr))</span>
<span id="cb2-11">  ), by <span class="ot" style="color: #003B4F;">=</span> sim_number]</span>
<span id="cb2-12"></span>
<span id="cb2-13">  <span class="co" style="color: #5E5E5E;"># Compute the density of the y values and add columns for dx and dy</span></span>
<span id="cb2-14">  sim_data[, <span class="st" style="color: #20794D;">`</span><span class="at" style="color: #657422;">:=</span><span class="st" style="color: #20794D;">`</span> (</span>
<span id="cb2-15">    <span class="at" style="color: #657422;">d =</span> <span class="fu" style="color: #4758AB;">list</span>(<span class="fu" style="color: #4758AB;">density</span>(<span class="fu" style="color: #4758AB;">unlist</span>(y), <span class="at" style="color: #657422;">n =</span> n)[<span class="fu" style="color: #4758AB;">c</span>(<span class="st" style="color: #20794D;">"x"</span>, <span class="st" style="color: #20794D;">"y"</span>)] <span class="sc" style="color: #5E5E5E;">|&gt;</span></span>
<span id="cb2-16">               <span class="fu" style="color: #4758AB;">set_names</span>(<span class="st" style="color: #20794D;">"dx"</span>, <span class="st" style="color: #20794D;">"dy"</span>) <span class="sc" style="color: #5E5E5E;">|&gt;</span></span>
<span id="cb2-17">               <span class="fu" style="color: #4758AB;">as_tibble</span>())</span>
<span id="cb2-18">  ), by <span class="ot" style="color: #003B4F;">=</span> sim_number]</span>
<span id="cb2-19"></span>
<span id="cb2-20">  <span class="co" style="color: #5E5E5E;"># Compute the p-values for the y values and add a column for p</span></span>
<span id="cb2-21">  sim_data[, <span class="st" style="color: #20794D;">`</span><span class="at" style="color: #657422;">:=</span><span class="st" style="color: #20794D;">`</span> (</span>
<span id="cb2-22">    <span class="at" style="color: #657422;">p =</span> <span class="fu" style="color: #4758AB;">list</span>(stats<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">pbinom</span>(<span class="fu" style="color: #4758AB;">unlist</span>(y), <span class="at" style="color: #657422;">size =</span> <span class="dv" style="color: #AD0000;">1</span>, <span class="at" style="color: #657422;">prob =</span> pr))</span>
<span id="cb2-23">  ), by <span class="ot" style="color: #003B4F;">=</span> sim_number]</span>
<span id="cb2-24"></span>
<span id="cb2-25">  <span class="co" style="color: #5E5E5E;"># Compute the q-values for the p-values and add a column for q</span></span>
<span id="cb2-26">  sim_data[, <span class="st" style="color: #20794D;">`</span><span class="at" style="color: #657422;">:=</span><span class="st" style="color: #20794D;">`</span> (</span>
<span id="cb2-27">    <span class="at" style="color: #657422;">q =</span> <span class="fu" style="color: #4758AB;">list</span>(stats<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">qbinom</span>(<span class="fu" style="color: #4758AB;">unlist</span>(p), <span class="at" style="color: #657422;">size =</span> <span class="dv" style="color: #AD0000;">1</span>, <span class="at" style="color: #657422;">prob =</span> pr))</span>
<span id="cb2-28">  ), by <span class="ot" style="color: #003B4F;">=</span> sim_number]</span>
<span id="cb2-29"></span>
<span id="cb2-30">  <span class="co" style="color: #5E5E5E;"># Unnest the columns for x, y, d, p, and q</span></span>
<span id="cb2-31">  sim_data <span class="ot" style="color: #003B4F;">&lt;-</span> sim_data[,</span>
<span id="cb2-32">                       <span class="fu" style="color: #4758AB;">unnest</span>(</span>
<span id="cb2-33">                         .SD,</span>
<span id="cb2-34">                         <span class="at" style="color: #657422;">cols =</span> <span class="fu" style="color: #4758AB;">c</span>(<span class="st" style="color: #20794D;">"x"</span>, <span class="st" style="color: #20794D;">"y"</span>, <span class="st" style="color: #20794D;">"d"</span>, <span class="st" style="color: #20794D;">"p"</span>, <span class="st" style="color: #20794D;">"q"</span>)</span>
<span id="cb2-35">                       ),</span>
<span id="cb2-36">                       by <span class="ot" style="color: #003B4F;">=</span> sim_number]</span>
<span id="cb2-37"></span>
<span id="cb2-38">  <span class="co" style="color: #5E5E5E;"># Remove the grouping</span></span>
<span id="cb2-39">  sim_data[, sim_number <span class="sc" style="color: #5E5E5E;">:</span><span class="er" style="color: #AD0000;">=</span> <span class="fu" style="color: #4758AB;">as.factor</span>(sim_number)]</span>
<span id="cb2-40"></span>
<span id="cb2-41">  <span class="fu" style="color: #4758AB;">return</span>(sim_data)</span>
<span id="cb2-42">}</span>
<span id="cb2-43"></span>
<span id="cb2-44">reddit_func <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="cf" style="color: #003B4F;">function</span>(num_sims, n, pr) {</span>
<span id="cb2-45">  sim_dat <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">data.table</span>(<span class="at" style="color: #657422;">sim_number =</span> <span class="fu" style="color: #4758AB;">rep</span>(<span class="dv" style="color: #AD0000;">1</span><span class="sc" style="color: #5E5E5E;">:</span>num_sims,<span class="at" style="color: #657422;">each=</span>n),</span>
<span id="cb2-46">                        <span class="at" style="color: #657422;">x          =</span> <span class="fu" style="color: #4758AB;">rep</span>(<span class="dv" style="color: #AD0000;">1</span><span class="sc" style="color: #5E5E5E;">:</span>n,num_sims))</span>
<span id="cb2-47"></span>
<span id="cb2-48">  sim_dat[, y <span class="sc" style="color: #5E5E5E;">:</span><span class="er" style="color: #AD0000;">=</span> stats<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">rbinom</span>(<span class="at" style="color: #657422;">n =</span> n, <span class="at" style="color: #657422;">size =</span> <span class="dv" style="color: #AD0000;">1</span>, <span class="at" style="color: #657422;">prob =</span> pr), by<span class="ot" style="color: #003B4F;">=</span>sim_number]</span>
<span id="cb2-49">  sim_dat[, <span class="fu" style="color: #4758AB;">c</span>(<span class="st" style="color: #20794D;">"dx"</span>,<span class="st" style="color: #20794D;">"dy"</span>) <span class="sc" style="color: #5E5E5E;">:</span><span class="er" style="color: #AD0000;">=</span> <span class="fu" style="color: #4758AB;">density</span>(y,<span class="at" style="color: #657422;">n=</span>n)[<span class="fu" style="color: #4758AB;">c</span>(<span class="st" style="color: #20794D;">"x"</span>,<span class="st" style="color: #20794D;">"y"</span>)]    , by<span class="ot" style="color: #003B4F;">=</span>sim_number]</span>
<span id="cb2-50">  sim_dat[, p <span class="sc" style="color: #5E5E5E;">:</span><span class="er" style="color: #AD0000;">=</span> stats<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">pbinom</span>(y, <span class="at" style="color: #657422;">size =</span> <span class="dv" style="color: #AD0000;">1</span>, <span class="at" style="color: #657422;">prob =</span> pr)    , by<span class="ot" style="color: #003B4F;">=</span>sim_number]</span>
<span id="cb2-51">  sim_dat[, q <span class="sc" style="color: #5E5E5E;">:</span><span class="er" style="color: #AD0000;">=</span> stats<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">qbinom</span>(p, <span class="at" style="color: #657422;">size =</span> <span class="dv" style="color: #AD0000;">1</span>, <span class="at" style="color: #657422;">prob =</span> pr)    , by<span class="ot" style="color: #003B4F;">=</span>sim_number]</span>
<span id="cb2-52">  </span>
<span id="cb2-53">  <span class="fu" style="color: #4758AB;">return</span>(sim_dat)</span>
<span id="cb2-54">}</span>
<span id="cb2-55"></span>
<span id="cb2-56">mastadon_func <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="cf" style="color: #003B4F;">function</span>(num_sims, n, pr){</span>
<span id="cb2-57">  sim_data <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">data.table</span>(<span class="at" style="color: #657422;">sim_number =</span> <span class="dv" style="color: #AD0000;">1</span><span class="sc" style="color: #5E5E5E;">:</span>num_sims</span>
<span id="cb2-58">  )[, <span class="st" style="color: #20794D;">`</span><span class="at" style="color: #657422;">:=</span><span class="st" style="color: #20794D;">`</span>( <span class="at" style="color: #657422;">x =</span> .(<span class="dv" style="color: #AD0000;">1</span><span class="sc" style="color: #5E5E5E;">:</span>n), <span class="at" style="color: #657422;">y=</span> .(<span class="fu" style="color: #4758AB;">rbinom</span>(<span class="at" style="color: #657422;">n =</span> n, <span class="at" style="color: #657422;">size =</span> <span class="dv" style="color: #AD0000;">1</span>, <span class="at" style="color: #657422;">prob =</span> pr))), sim_number</span>
<span id="cb2-59">  ][, <span class="st" style="color: #20794D;">`</span><span class="at" style="color: #657422;">:=</span><span class="st" style="color: #20794D;">`</span>( <span class="at" style="color: #657422;">d =</span> .(<span class="fu" style="color: #4758AB;">density</span>(<span class="fu" style="color: #4758AB;">unlist</span>(y), <span class="at" style="color: #657422;">n =</span> n)[<span class="fu" style="color: #4758AB;">c</span>(<span class="st" style="color: #20794D;">'x'</span>,<span class="st" style="color: #20794D;">'y'</span>)] <span class="sc" style="color: #5E5E5E;">|&gt;</span> </span>
<span id="cb2-60">                    <span class="fu" style="color: #4758AB;">as.data.table</span>() <span class="sc" style="color: #5E5E5E;">|&gt;</span> </span>
<span id="cb2-61">                    <span class="fu" style="color: #4758AB;">setnames</span>(<span class="fu" style="color: #4758AB;">c</span>(<span class="st" style="color: #20794D;">'dx'</span>,<span class="st" style="color: #20794D;">'dy'</span>))</span>
<span id="cb2-62">                  )</span>
<span id="cb2-63">            ), sim_number</span>
<span id="cb2-64">  ][, <span class="st" style="color: #20794D;">`</span><span class="at" style="color: #657422;">:=</span><span class="st" style="color: #20794D;">`</span>( <span class="at" style="color: #657422;">p =</span> .(<span class="fu" style="color: #4758AB;">pbinom</span>(<span class="fu" style="color: #4758AB;">unlist</span>(y), <span class="at" style="color: #657422;">size =</span> <span class="dv" style="color: #AD0000;">1</span>, <span class="at" style="color: #657422;">prob =</span> pr))), sim_number</span>
<span id="cb2-65">  ][, <span class="st" style="color: #20794D;">`</span><span class="at" style="color: #657422;">:=</span><span class="st" style="color: #20794D;">`</span>( <span class="at" style="color: #657422;">q =</span> .(<span class="fu" style="color: #4758AB;">qbinom</span>(<span class="fu" style="color: #4758AB;">unlist</span>(p), <span class="at" style="color: #657422;">size =</span> <span class="dv" style="color: #AD0000;">1</span>, <span class="at" style="color: #657422;">prob =</span> pr))), sim_number]</span>
<span id="cb2-66"></span>
<span id="cb2-67">    <span class="fu" style="color: #4758AB;">cbind</span>(</span>
<span id="cb2-68">      sim_data[, <span class="fu" style="color: #4758AB;">lapply</span>(.SD, unlist), <span class="at" style="color: #657422;">by =</span> sim_number, <span class="at" style="color: #657422;">.SDcol =</span> <span class="fu" style="color: #4758AB;">c</span>(<span class="st" style="color: #20794D;">'x'</span>,<span class="st" style="color: #20794D;">'y'</span>,<span class="st" style="color: #20794D;">'p'</span>,<span class="st" style="color: #20794D;">'q'</span>)],</span>
<span id="cb2-69">      <span class="fu" style="color: #4758AB;">rbindlist</span>(sim_data<span class="sc" style="color: #5E5E5E;">$</span>d)</span>
<span id="cb2-70">    ) <span class="sc" style="color: #5E5E5E;">|&gt;</span></span>
<span id="cb2-71">    <span class="fu" style="color: #4758AB;">setcolorder</span>(<span class="fu" style="color: #4758AB;">c</span>(<span class="st" style="color: #20794D;">'sim_number'</span>,<span class="st" style="color: #20794D;">'x'</span>,<span class="st" style="color: #20794D;">'y'</span>,<span class="st" style="color: #20794D;">'dx'</span>,<span class="st" style="color: #20794D;">'dy'</span>))</span>
<span id="cb2-72">    </span>
<span id="cb2-73">    <span class="fu" style="color: #4758AB;">return</span>(sim_data)</span>
<span id="cb2-74">}</span>
<span id="cb2-75"></span>
<span id="cb2-76">linkedin_func <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="cf" style="color: #003B4F;">function</span>(num_sims, n, pr) {</span>
<span id="cb2-77"></span>
<span id="cb2-78">  <span class="co" style="color: #5E5E5E;"># Create a data.table with one row per simulation</span></span>
<span id="cb2-79">  sim_data <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">CJ</span>(<span class="at" style="color: #657422;">sim_number =</span> <span class="fu" style="color: #4758AB;">factor</span>(<span class="dv" style="color: #AD0000;">1</span><span class="sc" style="color: #5E5E5E;">:</span>num_sims), <span class="at" style="color: #657422;">x =</span> <span class="dv" style="color: #AD0000;">1</span><span class="sc" style="color: #5E5E5E;">:</span>n)</span>
<span id="cb2-80"></span>
<span id="cb2-81">  <span class="co" style="color: #5E5E5E;"># Group the data by sim_number and add columns for x and y</span></span>
<span id="cb2-82">  sim_data[, y <span class="sc" style="color: #5E5E5E;">:</span><span class="er" style="color: #AD0000;">=</span> stats<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">rbinom</span>(<span class="at" style="color: #657422;">n =</span> .N, <span class="at" style="color: #657422;">size =</span> <span class="dv" style="color: #AD0000;">1</span>, <span class="at" style="color: #657422;">prob =</span> pr)]</span>
<span id="cb2-83"></span>
<span id="cb2-84"></span>
<span id="cb2-85">  <span class="co" style="color: #5E5E5E;"># Compute the density of the y values and add columns for dx and dy</span></span>
<span id="cb2-86">  sim_data[, <span class="fu" style="color: #4758AB;">c</span>(<span class="st" style="color: #20794D;">"dx"</span>, <span class="st" style="color: #20794D;">"dy"</span>) <span class="sc" style="color: #5E5E5E;">:</span><span class="er" style="color: #AD0000;">=</span> <span class="fu" style="color: #4758AB;">density</span>(y, <span class="at" style="color: #657422;">n =</span> n)[<span class="fu" style="color: #4758AB;">c</span>(<span class="st" style="color: #20794D;">"x"</span>, <span class="st" style="color: #20794D;">"y"</span>)], by <span class="ot" style="color: #003B4F;">=</span> sim_number]</span>
<span id="cb2-87"></span>
<span id="cb2-88">  <span class="co" style="color: #5E5E5E;"># Compute the p-values for the y values and add a column for p</span></span>
<span id="cb2-89">  sim_data[, p <span class="sc" style="color: #5E5E5E;">:</span><span class="er" style="color: #AD0000;">=</span> stats<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">pbinom</span>(y, <span class="at" style="color: #657422;">size =</span> <span class="dv" style="color: #AD0000;">1</span>, <span class="at" style="color: #657422;">prob =</span> pr)]</span>
<span id="cb2-90"></span>
<span id="cb2-91">  <span class="co" style="color: #5E5E5E;"># Compute the q-values for the p-values and add a column for q</span></span>
<span id="cb2-92">  sim_data[, q <span class="sc" style="color: #5E5E5E;">:</span><span class="er" style="color: #AD0000;">=</span> stats<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">qbinom</span>(p, <span class="at" style="color: #657422;">size =</span> <span class="dv" style="color: #AD0000;">1</span>, <span class="at" style="color: #657422;">prob =</span> pr)]</span>
<span id="cb2-93">  <span class="fu" style="color: #4758AB;">setkey</span>(sim_data, <span class="cn" style="color: #8f5902;">NULL</span>) <span class="co" style="color: #5E5E5E;"># needed only to compare with new_func</span></span>
<span id="cb2-94">  <span class="fu" style="color: #4758AB;">return</span>(sim_data)</span>
<span id="cb2-95">}</span></code></pre></div>
</div>
<p>All of the functions work in the same set of three arguments as input: * <code>num_sims</code>: an integer value that specifies the number of simulations to run * <code>n</code>: an integer value that specifies the sample size * <code>pr</code>: a numeric value that specifies the probability of success</p>
<p>The functions use the <code>data.table</code> package to create a data table named sim_dat/sim_data. The data table has two columns: sim_number and x. The sim_number column represents the simulation number, and x column represents the observation number.</p>
<p>The functions then generate random binary data using the <code>rbinom</code> function from the <code>stats</code> package. The function generates n binary data points for each simulation number (sim_number) using the input parameter pr as the probability of success. The resulting binary data points are stored in the y column of sim_dat/data.</p>
<p>Next, the function calculates the density of y using the density function from the stats package. The function calculates the density separately for each simulation number (sim_number) and stores the resulting values in the dx and dy columns of sim_dat/data.</p>
<p>The functions then calculate the cumulative probability (p) of each binary data point using the pbinom function from the stats package. The function calculates the cumulative probability separately for each simulation number (sim_number) and stores the resulting values in the p column of sim_dat.</p>
<p>Finally, the functions calculate the inverse of the cumulative probability (q) using the qbinom function from the stats package. The function calculates the inverse of the cumulative probability separately for each simulation number (sim_number) and stores the resulting values in the q column of sim_dat.</p>
<p>The functions then return the data table containing the results of the simulations.</p>
</section>
<section id="example" class="level1">
<h1>Example</h1>
<p>How do they stack up to each other? Lets see!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">n <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="dv" style="color: #AD0000;">50</span></span>
<span id="cb3-2">pr <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fl" style="color: #AD0000;">0.1</span></span>
<span id="cb3-3">num_sims <span class="ot" style="color: #003B4F;">&lt;-</span> sims <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="dv" style="color: #AD0000;">5</span></span>
<span id="cb3-4"></span>
<span id="cb3-5"><span class="fu" style="color: #4758AB;">benchmark</span>(</span>
<span id="cb3-6">  <span class="st" style="color: #20794D;">"tidy_bernoulli()"</span> <span class="ot" style="color: #003B4F;">=</span> {</span>
<span id="cb3-7">    <span class="fu" style="color: #4758AB;">tidy_bernoulli</span>(<span class="at" style="color: #657422;">.n =</span> n, <span class="at" style="color: #657422;">.prob =</span> pr, <span class="at" style="color: #657422;">.num_sims =</span> sims)</span>
<span id="cb3-8">  },</span>
<span id="cb3-9">  <span class="st" style="color: #20794D;">"my.first.attempt"</span> <span class="ot" style="color: #003B4F;">=</span> {</span>
<span id="cb3-10">    <span class="fu" style="color: #4758AB;">new_func</span>(<span class="at" style="color: #657422;">n =</span> n, <span class="at" style="color: #657422;">pr =</span> pr, <span class="at" style="color: #657422;">num_sims =</span> sims)</span>
<span id="cb3-11">  },</span>
<span id="cb3-12">  <span class="st" style="color: #20794D;">"linkedin.attempt"</span> <span class="ot" style="color: #003B4F;">=</span> {</span>
<span id="cb3-13">    <span class="fu" style="color: #4758AB;">linkedin_func</span>(<span class="at" style="color: #657422;">n =</span> n, <span class="at" style="color: #657422;">pr =</span> pr, <span class="at" style="color: #657422;">num_sims =</span> sims)</span>
<span id="cb3-14">  },</span>
<span id="cb3-15">  <span class="st" style="color: #20794D;">"mastadon.attempt"</span> <span class="ot" style="color: #003B4F;">=</span> {</span>
<span id="cb3-16">    <span class="fu" style="color: #4758AB;">mastadon_func</span>(<span class="at" style="color: #657422;">n =</span> n, <span class="at" style="color: #657422;">pr =</span> pr, <span class="at" style="color: #657422;">num_sims =</span> sims)</span>
<span id="cb3-17">  },</span>
<span id="cb3-18">  <span class="st" style="color: #20794D;">"reddit.attempt"</span> <span class="ot" style="color: #003B4F;">=</span> {</span>
<span id="cb3-19">    <span class="fu" style="color: #4758AB;">reddit_func</span>(<span class="at" style="color: #657422;">n =</span> n, <span class="at" style="color: #657422;">pr =</span> pr, <span class="at" style="color: #657422;">num_sims =</span> sims)</span>
<span id="cb3-20">  },</span>
<span id="cb3-21">  <span class="at" style="color: #657422;">replications =</span> <span class="dv" style="color: #AD0000;">200</span>,</span>
<span id="cb3-22">  <span class="at" style="color: #657422;">columns =</span> <span class="fu" style="color: #4758AB;">c</span>(<span class="st" style="color: #20794D;">"test"</span>,<span class="st" style="color: #20794D;">"replications"</span>,<span class="st" style="color: #20794D;">"elapsed"</span>,<span class="st" style="color: #20794D;">"relative"</span>,<span class="st" style="color: #20794D;">"user.self"</span>,<span class="st" style="color: #20794D;">"sys.self"</span>  )</span>
<span id="cb3-23">) <span class="sc" style="color: #5E5E5E;">|&gt;</span></span>
<span id="cb3-24">  <span class="fu" style="color: #4758AB;">arrange</span>(relative)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              test replications elapsed relative user.self sys.self
1 linkedin.attempt          200    0.84    1.000      0.64     0.00
2   reddit.attempt          200    0.86    1.024      0.69     0.03
3 mastadon.attempt          200    1.57    1.869      1.17     0.08
4 tidy_bernoulli()          200    6.47    7.702      4.68     0.11
5 my.first.attempt          200    8.82   10.500      6.67     0.01</code></pre>
</div>
</div>
<p>Voila!</p>


</section>

 ]]></description>
  <category>code</category>
  <category>rtip</category>
  <category>tidydensity</category>
  <category>data.table</category>
  <guid>https://www.spsanderson.com/steveondata/posts/rtip-2023-03-09/index.html</guid>
  <pubDate>Thu, 09 Mar 2023 05:00:00 GMT</pubDate>
</item>
<item>
  <title>Getting NYS Home Heating Oil Prices with {rvest}</title>
  <dc:creator>Steven P. Sanderson II, MPH</dc:creator>
  <link>https://www.spsanderson.com/steveondata/posts/rtip-2023-03-08/index.html</link>
  <description><![CDATA[ 




<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>If you live in New York and rely on heating oil to keep your home warm during the colder months, you know how important it is to keep track of heating oil prices. Fortunately, with a bit of R code, you can easily access the latest heating oil prices in New York.</p>
<p>The code uses the <code>{dplyr}</code> package to clean and manipulate the data, as well as the <code>{timetk}</code> package to plot the time series. Here’s a breakdown of what the code does:</p>
<ul>
<li>First, it loads the necessary packages and sets the URL for the data source.</li>
<li>Next, it reads the HTML from the URL using the <code>read_html</code> function from the <code>xml2</code> package.</li>
<li>It then uses the <code>html_node</code> function from the <code>rvest</code> package to extract the HTML node that contains the data table.</li>
</ul>
<p>The resulting data table is then cleaned and transformed using <code>dplyr</code> functions such as <code>html_table</code>, <code>as_tibble</code>, <code>set_names</code>, <code>select</code>, <code>mutate</code>, and <code>arrange</code>.</p>
<p>Finally, the resulting time series data is plotted using <code>plot_time_series</code> from the <code>timetk</code> package.</p>
<p>To run this code, you will need to have these packages installed on your machine. You can install them using the install.packages function in R. Here’s how you can install the packages:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;">install.packages</span>(<span class="st" style="color: #20794D;">"dplyr"</span>)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;">install.packages</span>(<span class="st" style="color: #20794D;">"xml2"</span>)</span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;">install.packages</span>(<span class="st" style="color: #20794D;">"rvest"</span>)</span>
<span id="cb1-4"><span class="fu" style="color: #4758AB;">install.packages</span>(<span class="st" style="color: #20794D;">"tibble"</span>)</span>
<span id="cb1-5"><span class="fu" style="color: #4758AB;">install.packages</span>(<span class="st" style="color: #20794D;">"purrr"</span>)</span>
<span id="cb1-6"><span class="fu" style="color: #4758AB;">install.packages</span>(<span class="st" style="color: #20794D;">"lubridate"</span>)</span>
<span id="cb1-7"><span class="fu" style="color: #4758AB;">install.packages</span>(<span class="st" style="color: #20794D;">"timetk"</span>)</span></code></pre></div>
</div>
<p>Once you have installed the packages, you can copy and paste the code into your R console or RStudio and run it to get the latest heating oil prices in New York.</p>
<p>In conclusion, the code above provides a simple and efficient way to access and visualize heating oil prices in New York using R. By keeping track of these prices, you can make informed decisions about when to buy heating oil and how much to purchase, ultimately saving you money on your heating bills.</p>
</section>
<section id="example" class="level1">
<h1>Example</h1>
<p>Now let’s run it!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">url  <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="st" style="color: #20794D;">"https://www.eia.gov/opendata/qb.php?sdid=PET.W_EPD2F_PRS_SNY_DPG.W"</span></span>
<span id="cb2-2">page <span class="ot" style="color: #003B4F;">&lt;-</span> xml2<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">read_html</span>(url)</span>
<span id="cb2-3">node <span class="ot" style="color: #003B4F;">&lt;-</span> rvest<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">html_node</span>(</span>
<span id="cb2-4">    <span class="at" style="color: #657422;">x =</span> page</span>
<span id="cb2-5">    , <span class="at" style="color: #657422;">xpath =</span> <span class="st" style="color: #20794D;">"/html/body/div[1]/section/div/div/div[2]/div[1]/table"</span></span>
<span id="cb2-6">)</span>
<span id="cb2-7">ny_tbl <span class="ot" style="color: #003B4F;">&lt;-</span> node <span class="sc" style="color: #5E5E5E;">|&gt;</span></span>
<span id="cb2-8">    rvest<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">html_table</span>() <span class="sc" style="color: #5E5E5E;">|&gt;</span></span>
<span id="cb2-9">    tibble<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">as_tibble</span>() <span class="sc" style="color: #5E5E5E;">|&gt;</span></span>
<span id="cb2-10">    purrr<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">set_names</span>(<span class="st" style="color: #20794D;">'series_name'</span>,<span class="st" style="color: #20794D;">'period'</span>,<span class="st" style="color: #20794D;">'frequency'</span>,<span class="st" style="color: #20794D;">'value'</span>,<span class="st" style="color: #20794D;">'units'</span>) <span class="sc" style="color: #5E5E5E;">|&gt;</span></span>
<span id="cb2-11">    dplyr<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">select</span>(period, frequency, value, units, series_name) <span class="sc" style="color: #5E5E5E;">|&gt;</span></span>
<span id="cb2-12">    dplyr<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">mutate</span>(<span class="at" style="color: #657422;">period =</span> lubridate<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">ymd</span>(period)) <span class="sc" style="color: #5E5E5E;">|&gt;</span></span>
<span id="cb2-13">    dplyr<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">arrange</span>(period)</span>
<span id="cb2-14"></span>
<span id="cb2-15">ny_tbl <span class="sc" style="color: #5E5E5E;">|&gt;</span></span>
<span id="cb2-16">    timetk<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">plot_time_series</span>(<span class="at" style="color: #657422;">.date_var =</span> period, <span class="at" style="color: #657422;">.value =</span> value)</span></code></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-c7ccb9aefae8486dd3d4" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-c7ccb9aefae8486dd3d4">{"x":{"data":[{"x":["1990-10-01","1990-10-15","1990-11-05","1990-11-19","1990-12-03","1990-12-17","1991-01-07","1991-01-21","1991-02-04","1991-02-18","1991-03-04","1991-03-18","1991-10-07","1991-10-21","1991-11-04","1991-11-18","1991-12-02","1991-12-16","1992-01-06","1992-01-20","1992-02-03","1992-02-17","1992-03-02","1992-03-16","1992-10-05","1992-10-19","1992-11-02","1992-11-16","1992-12-07","1992-12-21","1993-01-04","1993-01-18","1993-02-01","1993-02-15","1993-03-01","1993-03-15","1993-10-04","1993-10-18","1993-11-01","1993-11-15","1993-12-06","1993-12-20","1994-01-03","1994-01-17","1994-01-31","1994-02-07","1994-02-14","1994-02-21","1994-02-28","1994-03-07","1994-03-21","1994-10-03","1994-10-17","1994-11-07","1994-11-21","1994-12-05","1994-12-19","1995-01-02","1995-01-16","1995-02-06","1995-02-20","1995-03-06","1995-03-20","1995-10-02","1995-10-16","1995-11-06","1995-11-20","1995-12-04","1995-12-18","1996-01-01","1996-01-15","1996-02-05","1996-02-19","1996-03-04","1996-03-18","1996-10-07","1996-10-21","1996-10-28","1996-11-04","1996-11-11","1996-11-18","1996-11-25","1996-12-02","1996-12-09","1996-12-16","1996-12-23","1996-12-30","1997-01-06","1997-01-13","1997-01-20","1997-01-27","1997-02-03","1997-02-17","1997-03-03","1997-03-17","1997-10-06","1997-10-20","1997-11-03","1997-11-17","1997-12-01","1997-12-15","1998-01-05","1998-01-19","1998-02-02","1998-02-16","1998-03-02","1998-03-16","1998-10-05","1998-10-19","1998-11-02","1998-11-16","1998-12-07","1998-12-21","1999-01-04","1999-01-18","1999-02-01","1999-02-15","1999-03-01","1999-03-15","1999-10-04","1999-10-18","1999-11-01","1999-11-15","1999-12-06","1999-12-20","2000-01-03","2000-01-17","2000-01-24","2000-01-31","2000-02-07","2000-02-14","2000-02-21","2000-02-28","2000-03-06","2000-03-13","2000-03-20","2000-10-02","2000-10-09","2000-10-16","2000-10-23","2000-10-30","2000-11-06","2000-11-13","2000-11-20","2000-11-27","2000-12-04","2000-12-11","2000-12-18","2000-12-25","2001-01-01","2001-01-08","2001-01-15","2001-01-22","2001-01-29","2001-02-05","2001-02-12","2001-02-19","2001-02-26","2001-03-05","2001-03-12","2001-03-19","2001-10-01","2001-10-08","2001-10-15","2001-10-22","2001-10-29","2001-11-05","2001-11-12","2001-11-19","2001-11-26","2001-12-03","2001-12-10","2001-12-17","2001-12-24","2001-12-31","2002-01-07","2002-01-14","2002-01-21","2002-01-28","2002-02-04","2002-02-11","2002-02-18","2002-02-25","2002-03-04","2002-03-11","2002-03-18","2002-10-07","2002-10-14","2002-10-21","2002-10-28","2002-11-04","2002-11-11","2002-11-18","2002-11-25","2002-12-02","2002-12-09","2002-12-16","2002-12-23","2002-12-30","2003-01-06","2003-01-13","2003-01-20","2003-01-27","2003-02-03","2003-02-10","2003-02-17","2003-02-24","2003-03-03","2003-03-10","2003-03-17","2003-10-06","2003-10-13","2003-10-20","2003-10-27","2003-11-03","2003-11-10","2003-11-17","2003-11-24","2003-12-01","2003-12-08","2003-12-15","2003-12-22","2003-12-29","2004-01-05","2004-01-12","2004-01-19","2004-01-26","2004-02-02","2004-02-09","2004-02-16","2004-02-23","2004-03-01","2004-03-08","2004-03-15","2004-10-04","2004-10-11","2004-10-18","2004-10-25","2004-11-01","2004-11-08","2004-11-15","2004-11-22","2004-11-29","2004-12-06","2004-12-13","2004-12-20","2004-12-27","2005-01-03","2005-01-10","2005-01-17","2005-01-24","2005-01-31","2005-02-07","2005-02-14","2005-02-21","2005-02-28","2005-03-07","2005-03-14","2005-10-03","2005-10-10","2005-10-17","2005-10-24","2005-10-31","2005-11-07","2005-11-14","2005-11-21","2005-11-28","2005-12-05","2005-12-12","2005-12-19","2005-12-26","2006-01-02","2006-01-09","2006-01-16","2006-01-23","2006-01-30","2006-02-06","2006-02-13","2006-02-20","2006-02-27","2006-03-06","2006-03-13","2006-10-02","2006-10-09","2006-10-16","2006-10-23","2006-10-30","2006-11-06","2006-11-13","2006-11-20","2006-11-27","2006-12-04","2006-12-11","2006-12-18","2006-12-25","2007-01-01","2007-01-08","2007-01-15","2007-01-22","2007-01-29","2007-02-05","2007-02-12","2007-02-19","2007-02-26","2007-03-05","2007-03-12","2007-10-08","2007-10-15","2007-10-22","2007-10-29","2007-11-05","2007-11-12","2007-11-19","2007-11-26","2007-12-03","2007-12-10","2007-12-17","2007-12-24","2007-12-31","2008-01-07","2008-01-14","2008-01-21","2008-01-28","2008-02-04","2008-02-11","2008-02-18","2008-02-25","2008-03-03","2008-03-10","2008-03-17","2008-10-06","2008-10-13","2008-10-20","2008-10-27","2008-11-03","2008-11-10","2008-11-17","2008-11-24","2008-12-01","2008-12-08","2008-12-15","2008-12-22","2008-12-29","2009-01-05","2009-01-12","2009-01-19","2009-01-26","2009-02-02","2009-02-09","2009-02-16","2009-02-23","2009-03-02","2009-03-09","2009-03-16","2009-10-05","2009-10-12","2009-10-19","2009-10-26","2009-11-02","2009-11-09","2009-11-16","2009-11-23","2009-11-30","2009-12-07","2009-12-14","2009-12-21","2009-12-28","2010-01-04","2010-01-11","2010-01-18","2010-01-25","2010-02-01","2010-02-08","2010-02-15","2010-02-22","2010-03-01","2010-03-08","2010-03-15","2010-10-04","2010-10-11","2010-10-18","2010-10-25","2010-11-01","2010-11-08","2010-11-15","2010-11-22","2010-11-29","2010-12-06","2010-12-13","2010-12-20","2010-12-27","2011-01-03","2011-01-10","2011-01-17","2011-01-24","2011-01-31","2011-02-07","2011-02-14","2011-02-21","2011-02-28","2011-03-07","2011-03-14","2011-10-03","2011-10-10","2011-10-17","2011-10-24","2011-10-31","2011-11-07","2011-11-14","2011-11-21","2011-11-28","2011-12-05","2011-12-12","2011-12-19","2011-12-26","2012-01-02","2012-01-09","2012-01-16","2012-01-23","2012-01-30","2012-02-06","2012-02-13","2012-02-20","2012-02-27","2012-03-05","2012-03-12","2012-03-19","2012-10-01","2012-10-08","2012-10-15","2012-10-22","2012-10-29","2012-11-05","2012-11-12","2012-11-19","2012-11-26","2012-12-03","2012-12-10","2012-12-17","2012-12-24","2012-12-31","2013-01-07","2013-01-14","2013-01-21","2013-01-28","2013-02-04","2013-02-11","2013-02-18","2013-02-25","2013-03-04","2013-03-11","2013-03-18","2013-10-07","2013-10-14","2013-10-21","2013-10-28","2013-11-04","2013-11-11","2013-11-18","2013-11-25","2013-12-02","2013-12-09","2013-12-16","2013-12-23","2013-12-30","2014-01-06","2014-01-13","2014-01-20","2014-01-27","2014-02-03","2014-02-10","2014-02-17","2014-02-24","2014-03-03","2014-03-10","2014-03-17","2014-10-13","2014-10-20","2014-10-27","2014-11-03","2014-11-10","2014-11-17","2014-11-24","2014-12-01","2014-12-08","2014-12-15","2014-12-22","2014-12-29","2015-01-05","2015-01-12","2015-01-19","2015-01-26","2015-02-02","2015-02-09","2015-02-16","2015-02-23","2015-03-02","2015-03-09","2015-03-16","2015-03-23","2015-03-30","2015-10-05","2015-10-12","2015-10-19","2015-10-26","2015-11-02","2015-11-09","2015-11-16","2015-11-23","2015-11-30","2015-12-07","2015-12-14","2015-12-21","2015-12-28","2016-01-04","2016-01-11","2016-01-18","2016-01-25","2016-02-01","2016-02-08","2016-02-15","2016-02-22","2016-02-29","2016-03-07","2016-03-14","2016-03-21","2016-03-28","2016-10-03","2016-10-10","2016-10-17","2016-10-24","2016-10-31","2016-11-07","2016-11-14","2016-11-21","2016-11-28","2016-12-05","2016-12-12","2016-12-19","2016-12-26","2017-01-02","2017-01-09","2017-01-16","2017-01-23","2017-01-30","2017-02-06","2017-02-13","2017-02-20","2017-02-27","2017-03-06","2017-03-13","2017-03-20","2017-03-27","2017-10-02","2017-10-09","2017-10-16","2017-10-23","2017-10-30","2017-11-06","2017-11-13","2017-11-20","2017-11-27","2017-12-04","2017-12-11","2017-12-18","2017-12-25","2018-01-01","2018-01-08","2018-01-15","2018-01-22","2018-01-29","2018-02-05","2018-02-12","2018-02-19","2018-02-26","2018-03-05","2018-03-12","2018-03-19","2018-03-26","2018-10-01","2018-10-08","2018-10-15","2018-10-22","2018-10-29","2018-11-05","2018-11-12","2018-11-19","2018-11-26","2018-12-03","2018-12-10","2018-12-17","2018-12-24","2018-12-31","2019-01-07","2019-01-14","2019-01-21","2019-01-28","2019-02-04","2019-02-11","2019-02-18","2019-02-25","2019-03-04","2019-03-11","2019-03-18","2019-03-25","2019-10-07","2019-10-14","2019-10-21","2019-10-28","2019-11-04","2019-11-11","2019-11-18","2019-11-25","2019-12-02","2019-12-09","2019-12-16","2019-12-23","2019-12-30","2020-01-06","2020-01-13","2020-01-20","2020-01-27","2020-02-03","2020-02-10","2020-02-17","2020-02-24","2020-03-02","2020-03-09","2020-03-16","2020-03-23","2020-03-30","2020-10-05","2020-10-12","2020-10-19","2020-10-26","2020-11-02","2020-11-09","2020-11-16","2020-11-23","2020-11-30","2020-12-07","2020-12-14","2020-12-21","2020-12-28","2021-01-04","2021-01-11","2021-01-18","2021-01-25","2021-02-01","2021-02-08","2021-02-15","2021-02-22","2021-03-01","2021-03-08","2021-03-15","2021-03-22","2021-03-29","2021-10-04","2021-10-11","2021-10-18","2021-10-25","2021-11-01","2021-11-08","2021-11-15","2021-11-22","2021-11-29","2021-12-06","2021-12-13","2021-12-20","2021-12-27","2022-01-03","2022-01-10","2022-01-17","2022-01-24","2022-01-31","2022-02-07","2022-02-14","2022-02-21","2022-02-28","2022-03-07","2022-03-14","2022-03-21","2022-03-28","2022-10-03","2022-10-10","2022-10-17","2022-10-24","2022-10-31","2022-11-07","2022-11-14","2022-11-21","2022-11-28","2022-12-05","2022-12-12","2022-12-19","2022-12-26","2023-01-02","2023-01-09","2023-01-16","2023-01-23","2023-01-30","2023-02-06","2023-02-13","2023-02-20","2023-02-27"],"y":[1.342,1.4,1.392,1.385,1.366,1.366,1.32,1.339,1.294,1.265,1.237,1.186,1.044,1.081,1.099,1.122,1.118,1.11,1.091,1.088,1.088,1.086,1.081,1.076,1.033,1.058,1.069,1.071,1.07,1.071,1.073,1.073,1.074,1.074,1.077,1.077,1.034,1.038,1.044,1.047,1.047,1.039,1.038,1.053,1.065,1.088,1.093,1.094,1.09,1.09,1.081,1.049,1.051,1.054,1.055,1.068,1.071,1.079,1.083,1.086,1.089,1.086,1.082,1.051,1.057,1.068,1.072,1.086,1.113,1.155,1.18,1.165,1.191,1.203,1.2,1.255,1.291,1.289,1.276,1.272,1.275,1.282,1.282,1.302,1.295,1.306,1.299,1.296,1.303,1.297,1.298,1.291,1.274,1.268,1.238,1.133,1.141,1.145,1.152,1.155,1.154,1.155,1.153,1.15,1.143,1.129,1.118,1.021,1.029,1.029,1.028,1.023,1.022,1.021,1.029,1.031,1.025,1.02,1.017,1.137,1.143,1.157,1.197,1.249,1.26,1.282,1.331,1.775,1.852,2.123,1.777,1.636,1.579,1.558,1.555,1.53,1.608,1.614,1.674,1.652,1.65,1.648,1.65,1.69,1.715,1.727,1.733,1.715,1.711,1.71,1.702,1.686,1.682,1.674,1.644,1.64,1.625,1.611,1.601,1.586,1.565,1.366,1.352,1.348,1.34,1.343,1.313,1.303,1.283,1.28,1.276,1.274,1.272,1.277,1.289,1.296,1.282,1.264,1.264,1.27,1.262,1.263,1.264,1.267,1.318,1.335,1.388,1.403,1.405,1.407,1.413,1.407,1.403,1.413,1.418,1.43,1.464,1.498,1.539,1.557,1.571,1.589,1.623,1.65,1.811,1.833,1.871,1.966,1.991,1.933,1.493,1.519,1.504,1.509,1.495,1.504,1.524,1.535,1.535,1.552,1.58,1.619,1.626,1.628,1.703,1.723,1.746,1.746,1.737,1.73,1.72,1.719,1.715,1.706,1.944,2.049,2.129,2.199,2.205,2.181,2.207,2.206,2.214,2.144,2.157,2.177,2.16,2.145,2.149,2.147,2.167,2.211,2.173,2.147,2.137,2.195,2.222,2.25,2.809,2.75,2.767,2.728,2.712,2.649,2.615,2.604,2.58,2.585,2.591,2.603,2.601,2.6,2.598,2.581,2.597,2.6,2.586,2.582,2.55,2.56,2.581,2.554,2.541,2.534,2.516,2.509,2.497,2.478,2.489,2.482,2.49,2.566,2.572,2.558,2.56,2.534,2.517,2.484,2.46,2.5,2.53,2.576,2.568,2.579,2.594,2.586,2.869,2.889,2.968,3.051,3.224,3.322,3.328,3.407,3.402,3.398,3.416,3.418,3.465,3.524,3.495,3.476,3.476,3.461,3.461,3.54,3.563,3.655,3.753,3.942,3.797,3.503,3.347,3.242,3.168,3.101,3.025,2.908,2.899,2.716,2.712,2.597,2.484,2.532,2.624,2.587,2.58,2.576,2.554,2.525,2.449,2.447,2.425,2.393,2.709,2.742,2.839,2.885,2.913,2.926,2.91,2.917,2.916,2.947,2.931,2.938,2.973,3.046,3.154,3.109,3.068,3.051,3.018,3.037,3.099,3.066,3.08,3.086,3.099,3.13,3.149,3.159,3.164,3.281,3.318,3.302,3.309,3.392,3.429,3.441,3.489,3.51,3.562,3.638,3.667,3.702,3.748,3.764,3.791,3.951,4.021,4.025,3.876,3.895,4.015,4.014,4.063,4.079,4.133,4.14,4.096,4.102,4.076,4.059,4.067,4.083,4.144,4.152,4.153,4.169,4.18,4.232,4.238,4.273,4.255,4.266,4.276,4.237,4.264,4.308,4.281,4.266,4.276,4.299,4.308,4.338,4.326,4.28,4.231,4.237,4.232,4.259,4.25,4.274,4.302,4.342,4.392,4.402,4.38,4.312,4.314,4.289,4.103,4.121,4.119,4.089,4.077,4.05,4.06,4.113,4.141,4.171,4.165,4.181,4.228,4.197,4.192,4.27,4.438,4.482,4.525,4.46,4.491,4.469,4.417,4.338,3.736,3.714,3.701,3.69,3.674,3.647,3.62,3.573,3.453,3.373,3.323,3.298,3.203,3.134,3.054,3.036,3.014,3.123,3.296,3.423,3.507,3.43,3.273,3.152,3.131,2.707,2.718,2.704,2.713,2.709,2.718,2.668,2.663,2.625,2.6,2.543,2.492,2.405,2.454,2.455,2.424,2.352,2.394,2.416,2.399,2.378,2.365,2.369,2.405,2.411,2.407,2.604,2.688,2.684,2.707,2.706,2.678,2.667,2.678,2.689,2.792,2.82,2.842,2.835,2.896,2.903,2.887,2.88,2.892,2.929,2.924,2.924,2.922,2.891,2.883,2.863,2.863,2.976,2.951,2.973,2.982,3.013,3.022,3.076,3.083,3.105,3.113,3.142,3.163,3.21,3.39,3.432,3.477,3.464,3.492,3.48,3.405,3.384,3.385,3.379,3.378,3.37,3.409,3.67,3.715,3.725,3.715,3.72,3.695,3.676,3.637,3.564,3.444,3.458,3.444,3.359,3.357,3.358,3.43,3.467,3.456,3.469,3.456,3.535,3.528,3.536,3.539,3.521,3.536,3.137,3.148,3.15,3.141,3.144,3.156,3.17,3.172,3.173,3.194,3.213,3.237,3.246,3.289,3.274,3.236,3.175,3.126,3.095,3.104,3.087,3.007,2.943,2.806,2.606,2.583,2.315,2.307,2.34,2.334,2.335,2.347,2.369,2.398,2.452,2.482,2.503,2.581,2.591,2.611,2.649,2.705,2.714,2.742,2.817,2.888,2.96,3,3.032,3.038,3.011,3.004,3.408,3.517,3.612,3.641,3.622,3.614,3.619,3.582,3.549,3.491,3.55,3.546,3.587,3.62,3.676,3.814,3.876,3.982,4.076,4.154,4.141,4.256,5.017,5.001,5.004,5.315,4.915,5.529,5.865,5.799,5.989,6.06,5.91,5.584,5.289,5.073,4.765,4.815,4.895,4.884,4.733,4.825,4.941,4.825,4.636,4.6,4.501,4.478],"text":["period: 1990-10-01<br />.value: 1.342","period: 1990-10-15<br />.value: 1.400","period: 1990-11-05<br />.value: 1.392","period: 1990-11-19<br />.value: 1.385","period: 1990-12-03<br />.value: 1.366","period: 1990-12-17<br />.value: 1.366","period: 1991-01-07<br />.value: 1.320","period: 1991-01-21<br />.value: 1.339","period: 1991-02-04<br />.value: 1.294","period: 1991-02-18<br />.value: 1.265","period: 1991-03-04<br />.value: 1.237","period: 1991-03-18<br />.value: 1.186","period: 1991-10-07<br />.value: 1.044","period: 1991-10-21<br />.value: 1.081","period: 1991-11-04<br />.value: 1.099","period: 1991-11-18<br />.value: 1.122","period: 1991-12-02<br />.value: 1.118","period: 1991-12-16<br />.value: 1.110","period: 1992-01-06<br />.value: 1.091","period: 1992-01-20<br />.value: 1.088","period: 1992-02-03<br />.value: 1.088","period: 1992-02-17<br />.value: 1.086","period: 1992-03-02<br />.value: 1.081","period: 1992-03-16<br />.value: 1.076","period: 1992-10-05<br />.value: 1.033","period: 1992-10-19<br />.value: 1.058","period: 1992-11-02<br />.value: 1.069","period: 1992-11-16<br />.value: 1.071","period: 1992-12-07<br />.value: 1.070","period: 1992-12-21<br />.value: 1.071","period: 1993-01-04<br />.value: 1.073","period: 1993-01-18<br />.value: 1.073","period: 1993-02-01<br />.value: 1.074","period: 1993-02-15<br />.value: 1.074","period: 1993-03-01<br />.value: 1.077","period: 1993-03-15<br />.value: 1.077","period: 1993-10-04<br />.value: 1.034","period: 1993-10-18<br />.value: 1.038","period: 1993-11-01<br />.value: 1.044","period: 1993-11-15<br />.value: 1.047","period: 1993-12-06<br />.value: 1.047","period: 1993-12-20<br />.value: 1.039","period: 1994-01-03<br />.value: 1.038","period: 1994-01-17<br />.value: 1.053","period: 1994-01-31<br />.value: 1.065","period: 1994-02-07<br />.value: 1.088","period: 1994-02-14<br />.value: 1.093","period: 1994-02-21<br />.value: 1.094","period: 1994-02-28<br />.value: 1.090","period: 1994-03-07<br />.value: 1.090","period: 1994-03-21<br />.value: 1.081","period: 1994-10-03<br />.value: 1.049","period: 1994-10-17<br />.value: 1.051","period: 1994-11-07<br />.value: 1.054","period: 1994-11-21<br />.value: 1.055","period: 1994-12-05<br />.value: 1.068","period: 1994-12-19<br />.value: 1.071","period: 1995-01-02<br />.value: 1.079","period: 1995-01-16<br />.value: 1.083","period: 1995-02-06<br />.value: 1.086","period: 1995-02-20<br />.value: 1.089","period: 1995-03-06<br />.value: 1.086","period: 1995-03-20<br />.value: 1.082","period: 1995-10-02<br />.value: 1.051","period: 1995-10-16<br />.value: 1.057","period: 1995-11-06<br />.value: 1.068","period: 1995-11-20<br />.value: 1.072","period: 1995-12-04<br />.value: 1.086","period: 1995-12-18<br />.value: 1.113","period: 1996-01-01<br />.value: 1.155","period: 1996-01-15<br />.value: 1.180","period: 1996-02-05<br />.value: 1.165","period: 1996-02-19<br />.value: 1.191","period: 1996-03-04<br />.value: 1.203","period: 1996-03-18<br />.value: 1.200","period: 1996-10-07<br />.value: 1.255","period: 1996-10-21<br />.value: 1.291","period: 1996-10-28<br />.value: 1.289","period: 1996-11-04<br />.value: 1.276","period: 1996-11-11<br />.value: 1.272","period: 1996-11-18<br />.value: 1.275","period: 1996-11-25<br />.value: 1.282","period: 1996-12-02<br />.value: 1.282","period: 1996-12-09<br />.value: 1.302","period: 1996-12-16<br />.value: 1.295","period: 1996-12-23<br />.value: 1.306","period: 1996-12-30<br />.value: 1.299","period: 1997-01-06<br />.value: 1.296","period: 1997-01-13<br />.value: 1.303","period: 1997-01-20<br />.value: 1.297","period: 1997-01-27<br />.value: 1.298","period: 1997-02-03<br />.value: 1.291","period: 1997-02-17<br />.value: 1.274","period: 1997-03-03<br />.value: 1.268","period: 1997-03-17<br />.value: 1.238","period: 1997-10-06<br />.value: 1.133","period: 1997-10-20<br />.value: 1.141","period: 1997-11-03<br />.value: 1.145","period: 1997-11-17<br />.value: 1.152","period: 1997-12-01<br />.value: 1.155","period: 1997-12-15<br />.value: 1.154","period: 1998-01-05<br />.value: 1.155","period: 1998-01-19<br />.value: 1.153","period: 1998-02-02<br />.value: 1.150","period: 1998-02-16<br />.value: 1.143","period: 1998-03-02<br />.value: 1.129","period: 1998-03-16<br />.value: 1.118","period: 1998-10-05<br />.value: 1.021","period: 1998-10-19<br />.value: 1.029","period: 1998-11-02<br />.value: 1.029","period: 1998-11-16<br />.value: 1.028","period: 1998-12-07<br />.value: 1.023","period: 1998-12-21<br />.value: 1.022","period: 1999-01-04<br />.value: 1.021","period: 1999-01-18<br />.value: 1.029","period: 1999-02-01<br />.value: 1.031","period: 1999-02-15<br />.value: 1.025","period: 1999-03-01<br />.value: 1.020","period: 1999-03-15<br />.value: 1.017","period: 1999-10-04<br />.value: 1.137","period: 1999-10-18<br />.value: 1.143","period: 1999-11-01<br />.value: 1.157","period: 1999-11-15<br />.value: 1.197","period: 1999-12-06<br />.value: 1.249","period: 1999-12-20<br />.value: 1.260","period: 2000-01-03<br />.value: 1.282","period: 2000-01-17<br />.value: 1.331","period: 2000-01-24<br />.value: 1.775","period: 2000-01-31<br />.value: 1.852","period: 2000-02-07<br />.value: 2.123","period: 2000-02-14<br />.value: 1.777","period: 2000-02-21<br />.value: 1.636","period: 2000-02-28<br />.value: 1.579","period: 2000-03-06<br />.value: 1.558","period: 2000-03-13<br />.value: 1.555","period: 2000-03-20<br />.value: 1.530","period: 2000-10-02<br />.value: 1.608","period: 2000-10-09<br />.value: 1.614","period: 2000-10-16<br />.value: 1.674","period: 2000-10-23<br />.value: 1.652","period: 2000-10-30<br />.value: 1.650","period: 2000-11-06<br />.value: 1.648","period: 2000-11-13<br />.value: 1.650","period: 2000-11-20<br />.value: 1.690","period: 2000-11-27<br />.value: 1.715","period: 2000-12-04<br />.value: 1.727","period: 2000-12-11<br />.value: 1.733","period: 2000-12-18<br />.value: 1.715","period: 2000-12-25<br />.value: 1.711","period: 2001-01-01<br />.value: 1.710","period: 2001-01-08<br />.value: 1.702","period: 2001-01-15<br />.value: 1.686","period: 2001-01-22<br />.value: 1.682","period: 2001-01-29<br />.value: 1.674","period: 2001-02-05<br />.value: 1.644","period: 2001-02-12<br />.value: 1.640","period: 2001-02-19<br />.value: 1.625","period: 2001-02-26<br />.value: 1.611","period: 2001-03-05<br />.value: 1.601","period: 2001-03-12<br />.value: 1.586","period: 2001-03-19<br />.value: 1.565","period: 2001-10-01<br />.value: 1.366","period: 2001-10-08<br />.value: 1.352","period: 2001-10-15<br />.value: 1.348","period: 2001-10-22<br />.value: 1.340","period: 2001-10-29<br />.value: 1.343","period: 2001-11-05<br />.value: 1.313","period: 2001-11-12<br />.value: 1.303","period: 2001-11-19<br />.value: 1.283","period: 2001-11-26<br />.value: 1.280","period: 2001-12-03<br />.value: 1.276","period: 2001-12-10<br />.value: 1.274","period: 2001-12-17<br />.value: 1.272","period: 2001-12-24<br />.value: 1.277","period: 2001-12-31<br />.value: 1.289","period: 2002-01-07<br />.value: 1.296","period: 2002-01-14<br />.value: 1.282","period: 2002-01-21<br />.value: 1.264","period: 2002-01-28<br />.value: 1.264","period: 2002-02-04<br />.value: 1.270","period: 2002-02-11<br />.value: 1.262","period: 2002-02-18<br />.value: 1.263","period: 2002-02-25<br />.value: 1.264","period: 2002-03-04<br />.value: 1.267","period: 2002-03-11<br />.value: 1.318","period: 2002-03-18<br />.value: 1.335","period: 2002-10-07<br />.value: 1.388","period: 2002-10-14<br />.value: 1.403","period: 2002-10-21<br />.value: 1.405","period: 2002-10-28<br />.value: 1.407","period: 2002-11-04<br />.value: 1.413","period: 2002-11-11<br />.value: 1.407","period: 2002-11-18<br />.value: 1.403","period: 2002-11-25<br />.value: 1.413","period: 2002-12-02<br />.value: 1.418","period: 2002-12-09<br />.value: 1.430","period: 2002-12-16<br />.value: 1.464","period: 2002-12-23<br />.value: 1.498","period: 2002-12-30<br />.value: 1.539","period: 2003-01-06<br />.value: 1.557","period: 2003-01-13<br />.value: 1.571","period: 2003-01-20<br />.value: 1.589","period: 2003-01-27<br />.value: 1.623","period: 2003-02-03<br />.value: 1.650","period: 2003-02-10<br />.value: 1.811","period: 2003-02-17<br />.value: 1.833","period: 2003-02-24<br />.value: 1.871","period: 2003-03-03<br />.value: 1.966","period: 2003-03-10<br />.value: 1.991","period: 2003-03-17<br />.value: 1.933","period: 2003-10-06<br />.value: 1.493","period: 2003-10-13<br />.value: 1.519","period: 2003-10-20<br />.value: 1.504","period: 2003-10-27<br />.value: 1.509","period: 2003-11-03<br />.value: 1.495","period: 2003-11-10<br />.value: 1.504","period: 2003-11-17<br />.value: 1.524","period: 2003-11-24<br />.value: 1.535","period: 2003-12-01<br />.value: 1.535","period: 2003-12-08<br />.value: 1.552","period: 2003-12-15<br />.value: 1.580","period: 2003-12-22<br />.value: 1.619","period: 2003-12-29<br />.value: 1.626","period: 2004-01-05<br />.value: 1.628","period: 2004-01-12<br />.value: 1.703","period: 2004-01-19<br />.value: 1.723","period: 2004-01-26<br />.value: 1.746","period: 2004-02-02<br />.value: 1.746","period: 2004-02-09<br />.value: 1.737","period: 2004-02-16<br />.value: 1.730","period: 2004-02-23<br />.value: 1.720","period: 2004-03-01<br />.value: 1.719","period: 2004-03-08<br />.value: 1.715","period: 2004-03-15<br />.value: 1.706","period: 2004-10-04<br />.value: 1.944","period: 2004-10-11<br />.value: 2.049","period: 2004-10-18<br />.value: 2.129","period: 2004-10-25<br />.value: 2.199","period: 2004-11-01<br />.value: 2.205","period: 2004-11-08<br />.value: 2.181","period: 2004-11-15<br />.value: 2.207","period: 2004-11-22<br />.value: 2.206","period: 2004-11-29<br />.value: 2.214","period: 2004-12-06<br />.value: 2.144","period: 2004-12-13<br />.value: 2.157","period: 2004-12-20<br />.value: 2.177","period: 2004-12-27<br />.value: 2.160","period: 2005-01-03<br />.value: 2.145","period: 2005-01-10<br />.value: 2.149","period: 2005-01-17<br />.value: 2.147","period: 2005-01-24<br />.value: 2.167","period: 2005-01-31<br />.value: 2.211","period: 2005-02-07<br />.value: 2.173","period: 2005-02-14<br />.value: 2.147","period: 2005-02-21<br />.value: 2.137","period: 2005-02-28<br />.value: 2.195","period: 2005-03-07<br />.value: 2.222","period: 2005-03-14<br />.value: 2.250","period: 2005-10-03<br />.value: 2.809","period: 2005-10-10<br />.value: 2.750","period: 2005-10-17<br />.value: 2.767","period: 2005-10-24<br />.value: 2.728","period: 2005-10-31<br />.value: 2.712","period: 2005-11-07<br />.value: 2.649","period: 2005-11-14<br />.value: 2.615","period: 2005-11-21<br />.value: 2.604","period: 2005-11-28<br />.value: 2.580","period: 2005-12-05<br />.value: 2.585","period: 2005-12-12<br />.value: 2.591","period: 2005-12-19<br />.value: 2.603","period: 2005-12-26<br />.value: 2.601","period: 2006-01-02<br />.value: 2.600","period: 2006-01-09<br />.value: 2.598","period: 2006-01-16<br />.value: 2.581","period: 2006-01-23<br />.value: 2.597","period: 2006-01-30<br />.value: 2.600","period: 2006-02-06<br />.value: 2.586","period: 2006-02-13<br />.value: 2.582","period: 2006-02-20<br />.value: 2.550","period: 2006-02-27<br />.value: 2.560","period: 2006-03-06<br />.value: 2.581","period: 2006-03-13<br />.value: 2.554","period: 2006-10-02<br />.value: 2.541","period: 2006-10-09<br />.value: 2.534","period: 2006-10-16<br />.value: 2.516","period: 2006-10-23<br />.value: 2.509","period: 2006-10-30<br />.value: 2.497","period: 2006-11-06<br />.value: 2.478","period: 2006-11-13<br />.value: 2.489","period: 2006-11-20<br />.value: 2.482","period: 2006-11-27<br />.value: 2.490","period: 2006-12-04<br />.value: 2.566","period: 2006-12-11<br />.value: 2.572","period: 2006-12-18<br />.value: 2.558","period: 2006-12-25<br />.value: 2.560","period: 2007-01-01<br />.value: 2.534","period: 2007-01-08<br />.value: 2.517","period: 2007-01-15<br />.value: 2.484","period: 2007-01-22<br />.value: 2.460","period: 2007-01-29<br />.value: 2.500","period: 2007-02-05<br />.value: 2.530","period: 2007-02-12<br />.value: 2.576","period: 2007-02-19<br />.value: 2.568","period: 2007-02-26<br />.value: 2.579","period: 2007-03-05<br />.value: 2.594","period: 2007-03-12<br />.value: 2.586","period: 2007-10-08<br />.value: 2.869","period: 2007-10-15<br />.value: 2.889","period: 2007-10-22<br />.value: 2.968","period: 2007-10-29<br />.value: 3.051","period: 2007-11-05<br />.value: 3.224","period: 2007-11-12<br />.value: 3.322","period: 2007-11-19<br />.value: 3.328","period: 2007-11-26<br />.value: 3.407","period: 2007-12-03<br />.value: 3.402","period: 2007-12-10<br />.value: 3.398","period: 2007-12-17<br />.value: 3.416","period: 2007-12-24<br />.value: 3.418","period: 2007-12-31<br />.value: 3.465","period: 2008-01-07<br />.value: 3.524","period: 2008-01-14<br />.value: 3.495","period: 2008-01-21<br />.value: 3.476","period: 2008-01-28<br />.value: 3.476","period: 2008-02-04<br />.value: 3.461","period: 2008-02-11<br />.value: 3.461","period: 2008-02-18<br />.value: 3.540","period: 2008-02-25<br />.value: 3.563","period: 2008-03-03<br />.value: 3.655","period: 2008-03-10<br />.value: 3.753","period: 2008-03-17<br />.value: 3.942","period: 2008-10-06<br />.value: 3.797","period: 2008-10-13<br />.value: 3.503","period: 2008-10-20<br />.value: 3.347","period: 2008-10-27<br />.value: 3.242","period: 2008-11-03<br />.value: 3.168","period: 2008-11-10<br />.value: 3.101","period: 2008-11-17<br />.value: 3.025","period: 2008-11-24<br />.value: 2.908","period: 2008-12-01<br />.value: 2.899","period: 2008-12-08<br />.value: 2.716","period: 2008-12-15<br />.value: 2.712","period: 2008-12-22<br />.value: 2.597","period: 2008-12-29<br />.value: 2.484","period: 2009-01-05<br />.value: 2.532","period: 2009-01-12<br />.value: 2.624","period: 2009-01-19<br />.value: 2.587","period: 2009-01-26<br />.value: 2.580","period: 2009-02-02<br />.value: 2.576","period: 2009-02-09<br />.value: 2.554","period: 2009-02-16<br />.value: 2.525","period: 2009-02-23<br />.value: 2.449","period: 2009-03-02<br />.value: 2.447","period: 2009-03-09<br />.value: 2.425","period: 2009-03-16<br />.value: 2.393","period: 2009-10-05<br />.value: 2.709","period: 2009-10-12<br />.value: 2.742","period: 2009-10-19<br />.value: 2.839","period: 2009-10-26<br />.value: 2.885","period: 2009-11-02<br />.value: 2.913","period: 2009-11-09<br />.value: 2.926","period: 2009-11-16<br />.value: 2.910","period: 2009-11-23<br />.value: 2.917","period: 2009-11-30<br />.value: 2.916","period: 2009-12-07<br />.value: 2.947","period: 2009-12-14<br />.value: 2.931","period: 2009-12-21<br />.value: 2.938","period: 2009-12-28<br />.value: 2.973","period: 2010-01-04<br />.value: 3.046","period: 2010-01-11<br />.value: 3.154","period: 2010-01-18<br />.value: 3.109","period: 2010-01-25<br />.value: 3.068","period: 2010-02-01<br />.value: 3.051","period: 2010-02-08<br />.value: 3.018","period: 2010-02-15<br />.value: 3.037","period: 2010-02-22<br />.value: 3.099","period: 2010-03-01<br />.value: 3.066","period: 2010-03-08<br />.value: 3.080","period: 2010-03-15<br />.value: 3.086","period: 2010-10-04<br />.value: 3.099","period: 2010-10-11<br />.value: 3.130","period: 2010-10-18<br />.value: 3.149","period: 2010-10-25<br />.value: 3.159","period: 2010-11-01<br />.value: 3.164","period: 2010-11-08<br />.value: 3.281","period: 2010-11-15<br />.value: 3.318","period: 2010-11-22<br />.value: 3.302","period: 2010-11-29<br />.value: 3.309","period: 2010-12-06<br />.value: 3.392","period: 2010-12-13<br />.value: 3.429","period: 2010-12-20<br />.value: 3.441","period: 2010-12-27<br />.value: 3.489","period: 2011-01-03<br />.value: 3.510","period: 2011-01-10<br />.value: 3.562","period: 2011-01-17<br />.value: 3.638","period: 2011-01-24<br />.value: 3.667","period: 2011-01-31<br />.value: 3.702","period: 2011-02-07<br />.value: 3.748","period: 2011-02-14<br />.value: 3.764","period: 2011-02-21<br />.value: 3.791","period: 2011-02-28<br />.value: 3.951","period: 2011-03-07<br />.value: 4.021","period: 2011-03-14<br />.value: 4.025","period: 2011-10-03<br />.value: 3.876","period: 2011-10-10<br />.value: 3.895","period: 2011-10-17<br />.value: 4.015","period: 2011-10-24<br />.value: 4.014","period: 2011-10-31<br />.value: 4.063","period: 2011-11-07<br />.value: 4.079","period: 2011-11-14<br />.value: 4.133","period: 2011-11-21<br />.value: 4.140","period: 2011-11-28<br />.value: 4.096","period: 2011-12-05<br />.value: 4.102","period: 2011-12-12<br />.value: 4.076","period: 2011-12-19<br />.value: 4.059","period: 2011-12-26<br />.value: 4.067","period: 2012-01-02<br />.value: 4.083","period: 2012-01-09<br />.value: 4.144","period: 2012-01-16<br />.value: 4.152","period: 2012-01-23<br />.value: 4.153","period: 2012-01-30<br />.value: 4.169","period: 2012-02-06<br />.value: 4.180","period: 2012-02-13<br />.value: 4.232","period: 2012-02-20<br />.value: 4.238","period: 2012-02-27<br />.value: 4.273","period: 2012-03-05<br />.value: 4.255","period: 2012-03-12<br />.value: 4.266","period: 2012-03-19<br />.value: 4.276","period: 2012-10-01<br />.value: 4.237","period: 2012-10-08<br />.value: 4.264","period: 2012-10-15<br />.value: 4.308","period: 2012-10-22<br />.value: 4.281","period: 2012-10-29<br />.value: 4.266","period: 2012-11-05<br />.value: 4.276","period: 2012-11-12<br />.value: 4.299","period: 2012-11-19<br />.value: 4.308","period: 2012-11-26<br />.value: 4.338","period: 2012-12-03<br />.value: 4.326","period: 2012-12-10<br />.value: 4.280","period: 2012-12-17<br />.value: 4.231","period: 2012-12-24<br />.value: 4.237","period: 2012-12-31<br />.value: 4.232","period: 2013-01-07<br />.value: 4.259","period: 2013-01-14<br />.value: 4.250","period: 2013-01-21<br />.value: 4.274","period: 2013-01-28<br />.value: 4.302","period: 2013-02-04<br />.value: 4.342","period: 2013-02-11<br />.value: 4.392","period: 2013-02-18<br />.value: 4.402","period: 2013-02-25<br />.value: 4.380","period: 2013-03-04<br />.value: 4.312","period: 2013-03-11<br />.value: 4.314","period: 2013-03-18<br />.value: 4.289","period: 2013-10-07<br />.value: 4.103","period: 2013-10-14<br />.value: 4.121","period: 2013-10-21<br />.value: 4.119","period: 2013-10-28<br />.value: 4.089","period: 2013-11-04<br />.value: 4.077","period: 2013-11-11<br />.value: 4.050","period: 2013-11-18<br />.value: 4.060","period: 2013-11-25<br />.value: 4.113","period: 2013-12-02<br />.value: 4.141","period: 2013-12-09<br />.value: 4.171","period: 2013-12-16<br />.value: 4.165","period: 2013-12-23<br />.value: 4.181","period: 2013-12-30<br />.value: 4.228","period: 2014-01-06<br />.value: 4.197","period: 2014-01-13<br />.value: 4.192","period: 2014-01-20<br />.value: 4.270","period: 2014-01-27<br />.value: 4.438","period: 2014-02-03<br />.value: 4.482","period: 2014-02-10<br />.value: 4.525","period: 2014-02-17<br />.value: 4.460","period: 2014-02-24<br />.value: 4.491","period: 2014-03-03<br />.value: 4.469","period: 2014-03-10<br />.value: 4.417","period: 2014-03-17<br />.value: 4.338","period: 2014-10-13<br />.value: 3.736","period: 2014-10-20<br />.value: 3.714","period: 2014-10-27<br />.value: 3.701","period: 2014-11-03<br />.value: 3.690","period: 2014-11-10<br />.value: 3.674","period: 2014-11-17<br />.value: 3.647","period: 2014-11-24<br />.value: 3.620","period: 2014-12-01<br />.value: 3.573","period: 2014-12-08<br />.value: 3.453","period: 2014-12-15<br />.value: 3.373","period: 2014-12-22<br />.value: 3.323","period: 2014-12-29<br />.value: 3.298","period: 2015-01-05<br />.value: 3.203","period: 2015-01-12<br />.value: 3.134","period: 2015-01-19<br />.value: 3.054","period: 2015-01-26<br />.value: 3.036","period: 2015-02-02<br />.value: 3.014","period: 2015-02-09<br />.value: 3.123","period: 2015-02-16<br />.value: 3.296","period: 2015-02-23<br />.value: 3.423","period: 2015-03-02<br />.value: 3.507","period: 2015-03-09<br />.value: 3.430","period: 2015-03-16<br />.value: 3.273","period: 2015-03-23<br />.value: 3.152","period: 2015-03-30<br />.value: 3.131","period: 2015-10-05<br />.value: 2.707","period: 2015-10-12<br />.value: 2.718","period: 2015-10-19<br />.value: 2.704","period: 2015-10-26<br />.value: 2.713","period: 2015-11-02<br />.value: 2.709","period: 2015-11-09<br />.value: 2.718","period: 2015-11-16<br />.value: 2.668","period: 2015-11-23<br />.value: 2.663","period: 2015-11-30<br />.value: 2.625","period: 2015-12-07<br />.value: 2.600","period: 2015-12-14<br />.value: 2.543","period: 2015-12-21<br />.value: 2.492","period: 2015-12-28<br />.value: 2.405","period: 2016-01-04<br />.value: 2.454","period: 2016-01-11<br />.value: 2.455","period: 2016-01-18<br />.value: 2.424","period: 2016-01-25<br />.value: 2.352","period: 2016-02-01<br />.value: 2.394","period: 2016-02-08<br />.value: 2.416","period: 2016-02-15<br />.value: 2.399","period: 2016-02-22<br />.value: 2.378","period: 2016-02-29<br />.value: 2.365","period: 2016-03-07<br />.value: 2.369","period: 2016-03-14<br />.value: 2.405","period: 2016-03-21<br />.value: 2.411","period: 2016-03-28<br />.value: 2.407","period: 2016-10-03<br />.value: 2.604","period: 2016-10-10<br />.value: 2.688","period: 2016-10-17<br />.value: 2.684","period: 2016-10-24<br />.value: 2.707","period: 2016-10-31<br />.value: 2.706","period: 2016-11-07<br />.value: 2.678","period: 2016-11-14<br />.value: 2.667","period: 2016-11-21<br />.value: 2.678","period: 2016-11-28<br />.value: 2.689","period: 2016-12-05<br />.value: 2.792","period: 2016-12-12<br />.value: 2.820","period: 2016-12-19<br />.value: 2.842","period: 2016-12-26<br />.value: 2.835","period: 2017-01-02<br />.value: 2.896","period: 2017-01-09<br />.value: 2.903","period: 2017-01-16<br />.value: 2.887","period: 2017-01-23<br />.value: 2.880","period: 2017-01-30<br />.value: 2.892","period: 2017-02-06<br />.value: 2.929","period: 2017-02-13<br />.value: 2.924","period: 2017-02-20<br />.value: 2.924","period: 2017-02-27<br />.value: 2.922","period: 2017-03-06<br />.value: 2.891","period: 2017-03-13<br />.value: 2.883","period: 2017-03-20<br />.value: 2.863","period: 2017-03-27<br />.value: 2.863","period: 2017-10-02<br />.value: 2.976","period: 2017-10-09<br />.value: 2.951","period: 2017-10-16<br />.value: 2.973","period: 2017-10-23<br />.value: 2.982","period: 2017-10-30<br />.value: 3.013","period: 2017-11-06<br />.value: 3.022","period: 2017-11-13<br />.value: 3.076","period: 2017-11-20<br />.value: 3.083","period: 2017-11-27<br />.value: 3.105","period: 2017-12-04<br />.value: 3.113","period: 2017-12-11<br />.value: 3.142","period: 2017-12-18<br />.value: 3.163","period: 2017-12-25<br />.value: 3.210","period: 2018-01-01<br />.value: 3.390","period: 2018-01-08<br />.value: 3.432","period: 2018-01-15<br />.value: 3.477","period: 2018-01-22<br />.value: 3.464","period: 2018-01-29<br />.value: 3.492","period: 2018-02-05<br />.value: 3.480","period: 2018-02-12<br />.value: 3.405","period: 2018-02-19<br />.value: 3.384","period: 2018-02-26<br />.value: 3.385","period: 2018-03-05<br />.value: 3.379","period: 2018-03-12<br />.value: 3.378","period: 2018-03-19<br />.value: 3.370","period: 2018-03-26<br />.value: 3.409","period: 2018-10-01<br />.value: 3.670","period: 2018-10-08<br />.value: 3.715","period: 2018-10-15<br />.value: 3.725","period: 2018-10-22<br />.value: 3.715","period: 2018-10-29<br />.value: 3.720","period: 2018-11-05<br />.value: 3.695","period: 2018-11-12<br />.value: 3.676","period: 2018-11-19<br />.value: 3.637","period: 2018-11-26<br />.value: 3.564","period: 2018-12-03<br />.value: 3.444","period: 2018-12-10<br />.value: 3.458","period: 2018-12-17<br />.value: 3.444","period: 2018-12-24<br />.value: 3.359","period: 2018-12-31<br />.value: 3.357","period: 2019-01-07<br />.value: 3.358","period: 2019-01-14<br />.value: 3.430","period: 2019-01-21<br />.value: 3.467","period: 2019-01-28<br />.value: 3.456","period: 2019-02-04<br />.value: 3.469","period: 2019-02-11<br />.value: 3.456","period: 2019-02-18<br />.value: 3.535","period: 2019-02-25<br />.value: 3.528","period: 2019-03-04<br />.value: 3.536","period: 2019-03-11<br />.value: 3.539","period: 2019-03-18<br />.value: 3.521","period: 2019-03-25<br />.value: 3.536","period: 2019-10-07<br />.value: 3.137","period: 2019-10-14<br />.value: 3.148","period: 2019-10-21<br />.value: 3.150","period: 2019-10-28<br />.value: 3.141","period: 2019-11-04<br />.value: 3.144","period: 2019-11-11<br />.value: 3.156","period: 2019-11-18<br />.value: 3.170","period: 2019-11-25<br />.value: 3.172","period: 2019-12-02<br />.value: 3.173","period: 2019-12-09<br />.value: 3.194","period: 2019-12-16<br />.value: 3.213","period: 2019-12-23<br />.value: 3.237","period: 2019-12-30<br />.value: 3.246","period: 2020-01-06<br />.value: 3.289","period: 2020-01-13<br />.value: 3.274","period: 2020-01-20<br />.value: 3.236","period: 2020-01-27<br />.value: 3.175","period: 2020-02-03<br />.value: 3.126","period: 2020-02-10<br />.value: 3.095","period: 2020-02-17<br />.value: 3.104","period: 2020-02-24<br />.value: 3.087","period: 2020-03-02<br />.value: 3.007","period: 2020-03-09<br />.value: 2.943","period: 2020-03-16<br />.value: 2.806","period: 2020-03-23<br />.value: 2.606","period: 2020-03-30<br />.value: 2.583","period: 2020-10-05<br />.value: 2.315","period: 2020-10-12<br />.value: 2.307","period: 2020-10-19<br />.value: 2.340","period: 2020-10-26<br />.value: 2.334","period: 2020-11-02<br />.value: 2.335","period: 2020-11-09<br />.value: 2.347","period: 2020-11-16<br />.value: 2.369","period: 2020-11-23<br />.value: 2.398","period: 2020-11-30<br />.value: 2.452","period: 2020-12-07<br />.value: 2.482","period: 2020-12-14<br />.value: 2.503","period: 2020-12-21<br />.value: 2.581","period: 2020-12-28<br />.value: 2.591","period: 2021-01-04<br />.value: 2.611","period: 2021-01-11<br />.value: 2.649","period: 2021-01-18<br />.value: 2.705","period: 2021-01-25<br />.value: 2.714","period: 2021-02-01<br />.value: 2.742","period: 2021-02-08<br />.value: 2.817","period: 2021-02-15<br />.value: 2.888","period: 2021-02-22<br />.value: 2.960","period: 2021-03-01<br />.value: 3.000","period: 2021-03-08<br />.value: 3.032","period: 2021-03-15<br />.value: 3.038","period: 2021-03-22<br />.value: 3.011","period: 2021-03-29<br />.value: 3.004","period: 2021-10-04<br />.value: 3.408","period: 2021-10-11<br />.value: 3.517","period: 2021-10-18<br />.value: 3.612","period: 2021-10-25<br />.value: 3.641","period: 2021-11-01<br />.value: 3.622","period: 2021-11-08<br />.value: 3.614","period: 2021-11-15<br />.value: 3.619","period: 2021-11-22<br />.value: 3.582","period: 2021-11-29<br />.value: 3.549","period: 2021-12-06<br />.value: 3.491","period: 2021-12-13<br />.value: 3.550","period: 2021-12-20<br />.value: 3.546","period: 2021-12-27<br />.value: 3.587","period: 2022-01-03<br />.value: 3.620","period: 2022-01-10<br />.value: 3.676","period: 2022-01-17<br />.value: 3.814","period: 2022-01-24<br />.value: 3.876","period: 2022-01-31<br />.value: 3.982","period: 2022-02-07<br />.value: 4.076","period: 2022-02-14<br />.value: 4.154","period: 2022-02-21<br />.value: 4.141","period: 2022-02-28<br />.value: 4.256","period: 2022-03-07<br />.value: 5.017","period: 2022-03-14<br />.value: 5.001","period: 2022-03-21<br />.value: 5.004","period: 2022-03-28<br />.value: 5.315","period: 2022-10-03<br />.value: 4.915","period: 2022-10-10<br />.value: 5.529","period: 2022-10-17<br />.value: 5.865","period: 2022-10-24<br />.value: 5.799","period: 2022-10-31<br />.value: 5.989","period: 2022-11-07<br />.value: 6.060","period: 2022-11-14<br />.value: 5.910","period: 2022-11-21<br />.value: 5.584","period: 2022-11-28<br />.value: 5.289","period: 2022-12-05<br />.value: 5.073","period: 2022-12-12<br />.value: 4.765","period: 2022-12-19<br />.value: 4.815","period: 2022-12-26<br />.value: 4.895","period: 2023-01-02<br />.value: 4.884","period: 2023-01-09<br />.value: 4.733","period: 2023-01-16<br />.value: 4.825","period: 2023-01-23<br />.value: 4.941","period: 2023-01-30<br />.value: 4.825","period: 2023-02-06<br />.value: 4.636","period: 2023-02-13<br />.value: 4.600","period: 2023-02-20<br />.value: 4.501","period: 2023-02-27<br />.value: 4.478"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(44,62,80,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":["1990-10-01","1990-10-15","1990-11-05","1990-11-19","1990-12-03","1990-12-17","1991-01-07","1991-01-21","1991-02-04","1991-02-18","1991-03-04","1991-03-18","1991-10-07","1991-10-21","1991-11-04","1991-11-18","1991-12-02","1991-12-16","1992-01-06","1992-01-20","1992-02-03","1992-02-17","1992-03-02","1992-03-16","1992-10-05","1992-10-19","1992-11-02","1992-11-16","1992-12-07","1992-12-21","1993-01-04","1993-01-18","1993-02-01","1993-02-15","1993-03-01","1993-03-15","1993-10-04","1993-10-18","1993-11-01","1993-11-15","1993-12-06","1993-12-20","1994-01-03","1994-01-17","1994-01-31","1994-02-07","1994-02-14","1994-02-21","1994-02-28","1994-03-07","1994-03-21","1994-10-03","1994-10-17","1994-11-07","1994-11-21","1994-12-05","1994-12-19","1995-01-02","1995-01-16","1995-02-06","1995-02-20","1995-03-06","1995-03-20","1995-10-02","1995-10-16","1995-11-06","1995-11-20","1995-12-04","1995-12-18","1996-01-01","1996-01-15","1996-02-05","1996-02-19","1996-03-04","1996-03-18","1996-10-07","1996-10-21","1996-10-28","1996-11-04","1996-11-11","1996-11-18","1996-11-25","1996-12-02","1996-12-09","1996-12-16","1996-12-23","1996-12-30","1997-01-06","1997-01-13","1997-01-20","1997-01-27","1997-02-03","1997-02-17","1997-03-03","1997-03-17","1997-10-06","1997-10-20","1997-11-03","1997-11-17","1997-12-01","1997-12-15","1998-01-05","1998-01-19","1998-02-02","1998-02-16","1998-03-02","1998-03-16","1998-10-05","1998-10-19","1998-11-02","1998-11-16","1998-12-07","1998-12-21","1999-01-04","1999-01-18","1999-02-01","1999-02-15","1999-03-01","1999-03-15","1999-10-04","1999-10-18","1999-11-01","1999-11-15","1999-12-06","1999-12-20","2000-01-03","2000-01-17","2000-01-24","2000-01-31","2000-02-07","2000-02-14","2000-02-21","2000-02-28","2000-03-06","2000-03-13","2000-03-20","2000-10-02","2000-10-09","2000-10-16","2000-10-23","2000-10-30","2000-11-06","2000-11-13","2000-11-20","2000-11-27","2000-12-04","2000-12-11","2000-12-18","2000-12-25","2001-01-01","2001-01-08","2001-01-15","2001-01-22","2001-01-29","2001-02-05","2001-02-12","2001-02-19","2001-02-26","2001-03-05","2001-03-12","2001-03-19","2001-10-01","2001-10-08","2001-10-15","2001-10-22","2001-10-29","2001-11-05","2001-11-12","2001-11-19","2001-11-26","2001-12-03","2001-12-10","2001-12-17","2001-12-24","2001-12-31","2002-01-07","2002-01-14","2002-01-21","2002-01-28","2002-02-04","2002-02-11","2002-02-18","2002-02-25","2002-03-04","2002-03-11","2002-03-18","2002-10-07","2002-10-14","2002-10-21","2002-10-28","2002-11-04","2002-11-11","2002-11-18","2002-11-25","2002-12-02","2002-12-09","2002-12-16","2002-12-23","2002-12-30","2003-01-06","2003-01-13","2003-01-20","2003-01-27","2003-02-03","2003-02-10","2003-02-17","2003-02-24","2003-03-03","2003-03-10","2003-03-17","2003-10-06","2003-10-13","2003-10-20","2003-10-27","2003-11-03","2003-11-10","2003-11-17","2003-11-24","2003-12-01","2003-12-08","2003-12-15","2003-12-22","2003-12-29","2004-01-05","2004-01-12","2004-01-19","2004-01-26","2004-02-02","2004-02-09","2004-02-16","2004-02-23","2004-03-01","2004-03-08","2004-03-15","2004-10-04","2004-10-11","2004-10-18","2004-10-25","2004-11-01","2004-11-08","2004-11-15","2004-11-22","2004-11-29","2004-12-06","2004-12-13","2004-12-20","2004-12-27","2005-01-03","2005-01-10","2005-01-17","2005-01-24","2005-01-31","2005-02-07","2005-02-14","2005-02-21","2005-02-28","2005-03-07","2005-03-14","2005-10-03","2005-10-10","2005-10-17","2005-10-24","2005-10-31","2005-11-07","2005-11-14","2005-11-21","2005-11-28","2005-12-05","2005-12-12","2005-12-19","2005-12-26","2006-01-02","2006-01-09","2006-01-16","2006-01-23","2006-01-30","2006-02-06","2006-02-13","2006-02-20","2006-02-27","2006-03-06","2006-03-13","2006-10-02","2006-10-09","2006-10-16","2006-10-23","2006-10-30","2006-11-06","2006-11-13","2006-11-20","2006-11-27","2006-12-04","2006-12-11","2006-12-18","2006-12-25","2007-01-01","2007-01-08","2007-01-15","2007-01-22","2007-01-29","2007-02-05","2007-02-12","2007-02-19","2007-02-26","2007-03-05","2007-03-12","2007-10-08","2007-10-15","2007-10-22","2007-10-29","2007-11-05","2007-11-12","2007-11-19","2007-11-26","2007-12-03","2007-12-10","2007-12-17","2007-12-24","2007-12-31","2008-01-07","2008-01-14","2008-01-21","2008-01-28","2008-02-04","2008-02-11","2008-02-18","2008-02-25","2008-03-03","2008-03-10","2008-03-17","2008-10-06","2008-10-13","2008-10-20","2008-10-27","2008-11-03","2008-11-10","2008-11-17","2008-11-24","2008-12-01","2008-12-08","2008-12-15","2008-12-22","2008-12-29","2009-01-05","2009-01-12","2009-01-19","2009-01-26","2009-02-02","2009-02-09","2009-02-16","2009-02-23","2009-03-02","2009-03-09","2009-03-16","2009-10-05","2009-10-12","2009-10-19","2009-10-26","2009-11-02","2009-11-09","2009-11-16","2009-11-23","2009-11-30","2009-12-07","2009-12-14","2009-12-21","2009-12-28","2010-01-04","2010-01-11","2010-01-18","2010-01-25","2010-02-01","2010-02-08","2010-02-15","2010-02-22","2010-03-01","2010-03-08","2010-03-15","2010-10-04","2010-10-11","2010-10-18","2010-10-25","2010-11-01","2010-11-08","2010-11-15","2010-11-22","2010-11-29","2010-12-06","2010-12-13","2010-12-20","2010-12-27","2011-01-03","2011-01-10","2011-01-17","2011-01-24","2011-01-31","2011-02-07","2011-02-14","2011-02-21","2011-02-28","2011-03-07","2011-03-14","2011-10-03","2011-10-10","2011-10-17","2011-10-24","2011-10-31","2011-11-07","2011-11-14","2011-11-21","2011-11-28","2011-12-05","2011-12-12","2011-12-19","2011-12-26","2012-01-02","2012-01-09","2012-01-16","2012-01-23","2012-01-30","2012-02-06","2012-02-13","2012-02-20","2012-02-27","2012-03-05","2012-03-12","2012-03-19","2012-10-01","2012-10-08","2012-10-15","2012-10-22","2012-10-29","2012-11-05","2012-11-12","2012-11-19","2012-11-26","2012-12-03","2012-12-10","2012-12-17","2012-12-24","2012-12-31","2013-01-07","2013-01-14","2013-01-21","2013-01-28","2013-02-04","2013-02-11","2013-02-18","2013-02-25","2013-03-04","2013-03-11","2013-03-18","2013-10-07","2013-10-14","2013-10-21","2013-10-28","2013-11-04","2013-11-11","2013-11-18","2013-11-25","2013-12-02","2013-12-09","2013-12-16","2013-12-23","2013-12-30","2014-01-06","2014-01-13","2014-01-20","2014-01-27","2014-02-03","2014-02-10","2014-02-17","2014-02-24","2014-03-03","2014-03-10","2014-03-17","2014-10-13","2014-10-20","2014-10-27","2014-11-03","2014-11-10","2014-11-17","2014-11-24","2014-12-01","2014-12-08","2014-12-15","2014-12-22","2014-12-29","2015-01-05","2015-01-12","2015-01-19","2015-01-26","2015-02-02","2015-02-09","2015-02-16","2015-02-23","2015-03-02","2015-03-09","2015-03-16","2015-03-23","2015-03-30","2015-10-05","2015-10-12","2015-10-19","2015-10-26","2015-11-02","2015-11-09","2015-11-16","2015-11-23","2015-11-30","2015-12-07","2015-12-14","2015-12-21","2015-12-28","2016-01-04","2016-01-11","2016-01-18","2016-01-25","2016-02-01","2016-02-08","2016-02-15","2016-02-22","2016-02-29","2016-03-07","2016-03-14","2016-03-21","2016-03-28","2016-10-03","2016-10-10","2016-10-17","2016-10-24","2016-10-31","2016-11-07","2016-11-14","2016-11-21","2016-11-28","2016-12-05","2016-12-12","2016-12-19","2016-12-26","2017-01-02","2017-01-09","2017-01-16","2017-01-23","2017-01-30","2017-02-06","2017-02-13","2017-02-20","2017-02-27","2017-03-06","2017-03-13","2017-03-20","2017-03-27","2017-10-02","2017-10-09","2017-10-16","2017-10-23","2017-10-30","2017-11-06","2017-11-13","2017-11-20","2017-11-27","2017-12-04","2017-12-11","2017-12-18","2017-12-25","2018-01-01","2018-01-08","2018-01-15","2018-01-22","2018-01-29","2018-02-05","2018-02-12","2018-02-19","2018-02-26","2018-03-05","2018-03-12","2018-03-19","2018-03-26","2018-10-01","2018-10-08","2018-10-15","2018-10-22","2018-10-29","2018-11-05","2018-11-12","2018-11-19","2018-11-26","2018-12-03","2018-12-10","2018-12-17","2018-12-24","2018-12-31","2019-01-07","2019-01-14","2019-01-21","2019-01-28","2019-02-04","2019-02-11","2019-02-18","2019-02-25","2019-03-04","2019-03-11","2019-03-18","2019-03-25","2019-10-07","2019-10-14","2019-10-21","2019-10-28","2019-11-04","2019-11-11","2019-11-18","2019-11-25","2019-12-02","2019-12-09","2019-12-16","2019-12-23","2019-12-30","2020-01-06","2020-01-13","2020-01-20","2020-01-27","2020-02-03","2020-02-10","2020-02-17","2020-02-24","2020-03-02","2020-03-09","2020-03-16","2020-03-23","2020-03-30","2020-10-05","2020-10-12","2020-10-19","2020-10-26","2020-11-02","2020-11-09","2020-11-16","2020-11-23","2020-11-30","2020-12-07","2020-12-14","2020-12-21","2020-12-28","2021-01-04","2021-01-11","2021-01-18","2021-01-25","2021-02-01","2021-02-08","2021-02-15","2021-02-22","2021-03-01","2021-03-08","2021-03-15","2021-03-22","2021-03-29","2021-10-04","2021-10-11","2021-10-18","2021-10-25","2021-11-01","2021-11-08","2021-11-15","2021-11-22","2021-11-29","2021-12-06","2021-12-13","2021-12-20","2021-12-27","2022-01-03","2022-01-10","2022-01-17","2022-01-24","2022-01-31","2022-02-07","2022-02-14","2022-02-21","2022-02-28","2022-03-07","2022-03-14","2022-03-21","2022-03-28","2022-10-03","2022-10-10","2022-10-17","2022-10-24","2022-10-31","2022-11-07","2022-11-14","2022-11-21","2022-11-28","2022-12-05","2022-12-12","2022-12-19","2022-12-26","2023-01-02","2023-01-09","2023-01-16","2023-01-23","2023-01-30","2023-02-06","2023-02-13","2023-02-20","2023-02-27"],"y":[1.09893136413559,1.09861743519431,1.09833691626074,1.09808989277379,1.09787645017238,1.09769667389542,1.09755064938183,1.09743846207052,1.09736019740042,1.09731594081044,1.09730577773949,1.0973297936265,1.09738807391038,1.09748070403005,1.09760776942442,1.09776935553241,1.09796554779293,1.09819643164492,1.09846209252727,1.09876261587891,1.09909808713876,1.09946859174573,1.09987421513873,1.10031504275669,1.10079116003852,1.10130265242315,1.10184960534947,1.10243210425642,1.10305023458291,1.10370408176785,1.10439373125016,1.10511926846877,1.10588077886258,1.10667834787051,1.10751206093148,1.10838200348441,1.10928826096821,1.1102309188218,1.1112100624841,1.11222577739402,1.11327814899048,1.1143672627124,1.11549320399869,1.11665605828828,1.11785591102007,1.11909284763298,1.12036695356593,1.12167831425785,1.12302701514763,1.12441314167421,1.1258367792765,1.12729801339341,1.12879692946386,1.13033361292677,1.13190814922105,1.13352062378563,1.13517112205942,1.13685972948133,1.13858653149028,1.14035161352519,1.14215506102498,1.14399695942856,1.14587739417485,1.14779645070276,1.14975421445122,1.15175077085914,1.15378620536543,1.15586060340902,1.15797405042882,1.16012663186374,1.16231843315271,1.16454953973464,1.16682003704844,1.16913001053304,1.17147954562735,1.17386872777029,1.17629764240077,1.17876637495771,1.18127501088003,1.18382363560664,1.18641233457647,1.18904119322842,1.19171029700142,1.19441973133438,1.19716958166621,1.19995993343585,1.20279087208219,1.20566248304417,1.20857485176068,1.21152976249609,1.21452879058386,1.21757170806662,1.22065828698699,1.22378829938759,1.22696151731105,1.23017771279999,1.23343665789702,1.23673812464478,1.24008188508589,1.24346771126296,1.24689537521862,1.2503646489955,1.25387530463621,1.25742711418339,1.26101984967964,1.26465328316759,1.26832718668987,1.2720413322891,1.2757954920079,1.2795894378889,1.2834229419747,1.28729577630795,1.29120771293126,1.29515852388725,1.29914798121855,1.30317585696778,1.30724192317756,1.31134595189051,1.31548771514925,1.31966698499642,1.32388353347463,1.3281371326265,1.33242755449465,1.33675457112172,1.34111795455032,1.34551747682307,1.34995290998259,1.35442402607152,1.35893059713247,1.36347239520806,1.36804919234092,1.37266076057366,1.37730687194892,1.38198729850931,1.38670181229746,1.39145018535599,1.39623218972751,1.40104759745467,1.40589618058007,1.41077771114633,1.41569196119609,1.42063870277197,1.42561770791658,1.43062874867255,1.4356715970825,1.44074602518906,1.44585180503484,1.45098870866247,1.45615650811458,1.46135497543378,1.46658388266269,1.47184300184395,1.47713210502016,1.48245096423396,1.48779935152797,1.49317703894481,1.4985837985271,1.50401940231746,1.50948362235852,1.51497623069291,1.52049699936323,1.52604570041212,1.53162210588219,1.53722598781608,1.54285711825639,1.54851526924576,1.55420021282681,1.55991172104216,1.56564956593443,1.57141351954625,1.57720335392023,1.58301884109901,1.58885975312519,1.59472586204141,1.60061693989029,1.60653275871445,1.61247309055651,1.61845894009363,1.62451091507721,1.63062819216124,1.63680994799971,1.64305535924663,1.64936360255596,1.65573385458172,1.66216529197789,1.66865709139845,1.67520842949741,1.68181848292876,1.68848642834648,1.69521144240457,1.70199270175702,1.70882938305782,1.71572066296096,1.72266571812044,1.72966372519024,1.73671386082436,1.74381530167679,1.75096722440152,1.75816880565255,1.76541922208385,1.77271765034943,1.78006326710328,1.78745524899939,1.79489277269174,1.80237501483434,1.80990115208117,1.81747036108623,1.8250818185035,1.83273470098698,1.84042818519066,1.84816144776853,1.85593366537458,1.86374401466281,1.8715916722872,1.87947581490175,1.88739561916045,1.89535026171729,1.90333891922626,1.91136076834136,1.91941498571657,1.92750074800589,1.9356172318633,1.94376361394281,1.9519390708984,1.96014277938406,1.96837391605378,1.97663165756157,1.9849151805614,1.99322366170726,2.00155627765317,2.00991220505309,2.01829062056102,2.02669070083097,2.03511162251691,2.04355256227284,2.05201269675275,2.06049120261063,2.06898725650047,2.07750003507627,2.08602871499202,2.09457247290171,2.10313048545932,2.11170192931886,2.12028598113431,2.12888181755967,2.13748861524892,2.14610555085606,2.15473180103508,2.16336654243997,2.17200895172472,2.18065820554333,2.18931348054978,2.19797395339807,2.20663880074219,2.21530719923613,2.22397832553388,2.23265135628943,2.24132546815678,2.24999983778992,2.25867364184283,2.26734605696952,2.27601625982397,2.28468342706017,2.29334673533211,2.30200536129379,2.31078934569035,2.3198249714489,2.32910577849641,2.33862530675983,2.34837709616611,2.35835468664222,2.36855161811511,2.37896143051174,2.38957766375906,2.40039385778404,2.41140355251364,2.4226002878748,2.43397760379449,2.44552904019966,2.45724813701727,2.46912843417428,2.48116347159765,2.49334678921433,2.50567192695129,2.51813242473547,2.53072182249383,2.54343366015334,2.55626147764095,2.56919881488362,2.58223921180831,2.59537620834196,2.60860334441155,2.62191415994402,2.63530219486634,2.64876098910546,2.66228408258834,2.67586501524194,2.68949732699321,2.70317455776912,2.71689024749661,2.73063793610265,2.74441116351419,2.7582034696582,2.77200839446162,2.78581947785142,2.79963025975456,2.81343428009798,2.82722507880866,2.84099619581354,2.85474117103958,2.86845354441374,2.88212685586299,2.89575464531426,2.90933045269453,2.92284781793075,2.93630028094988,2.94968138167888,2.96298466004469,2.97620365597429,2.98933190939462,3.00236296023265,3.01529034841532,3.02810761386961,3.04080829652247,3.05338593630085,3.06583407313171,3.07814624694201,3.09031599765871,3.10233686520876,3.11420238951912,3.12590611051675,3.13744156812861,3.14880230228165,3.15998185290283,3.17097375991911,3.18177156325744,3.19236880284479,3.2027590186081,3.21293575047435,3.22289253837048,3.23262292222345,3.24212044196023,3.25137863750776,3.260391048793,3.26915121574292,3.27765267828447,3.2858889763446,3.29385364985028,3.30154023872846,3.3089422829061,3.31605332231016,3.32286689686759,3.32937654650535,3.33569174209708,3.34192655785372,3.34808143870822,3.3541568295935,3.36015317544251,3.36607092118817,3.37191051176343,3.37767239210121,3.38335700713446,3.38896480179611,3.39449622101909,3.39995170973634,3.40533171288079,3.41063667538538,3.41586704218305,3.42102325820672,3.42610576838934,3.43111501766384,3.43605145096316,3.44091551322022,3.44570764936797,3.45042830433934,3.45507792306727,3.45965695048468,3.46416583152452,3.46860501111973,3.47297493420323,3.47727604570796,3.48150879056685,3.48567361371285,3.48977096007889,3.49380127459789,3.49776500220281,3.50166258782656,3.5054944764021,3.50926111286234,3.51296294214024,3.51660040916871,3.52017395888071,3.52368403620916,3.52713108608699,3.53051555344715,3.53383788322257,3.53709852034618,3.54029790975093,3.54343649636973,3.54651472513554,3.54953304098128,3.55249188883988,3.5553917136443,3.55823296032745,3.56101607382228,3.56374149906172,3.5664096809787,3.56902106450617,3.57157609457705,3.57407521612428,3.5765188740808,3.57890751337954,3.58124157895343,3.58352151573542,3.58574776865843,3.58792078265541,3.59004100265928,3.59210887360298,3.59412484041946,3.59608934804163,3.59800284140244,3.59986576543483,3.60167856507172,3.60344168524605,3.60515557089077,3.6068206669388,3.60843741832307,3.61000626997653,3.61152766683211,3.61300205382274,3.61442987588137,3.61581157794091,3.61714760493432,3.61843840179452,3.61968441345445,3.62088608484705,3.62204386090524,3.62315818656197,3.62422950675017,3.62525826640278,3.62624491045273,3.62710468389352,3.62775579357814,3.62820312722879,3.62845157256765,3.62850601731688,3.62837134919869,3.62805245593525,3.62755422524875,3.62688154486136,3.62603930249528,3.62503238587267,3.62386568271574,3.62254408074665,3.62107246768759,3.61945573126075,3.6176987591883,3.61580643919244,3.61378365899533,3.61163530631917,3.60936626888614,3.60698143441842,3.6044856906382,3.60188392526765,3.59918102602895,3.5963818806443,3.59349137683588,3.59051440232586,3.58745584483643,3.58432059208978,3.58111353180808,3.57783955171352,3.57450353952828,3.57111038297454,3.56766496977449,3.56417218765031,3.56063692432418,3.55706406751828,3.55345850495481,3.54982512435593,3.54616881344383,3.54249445994071,3.53880695156873,3.53511117605008,3.53141202110694,3.52771437446151,3.52402312383595,3.52034315695245,3.5166793615332,3.51303662530037,3.50941983597616,3.50583388128274,3.5022836489423,3.49877402667701,3.49530990220907,3.49189616326065,3.48853769755393,3.48523939281111,3.48200613675436,3.47884281710586,3.4757543215878,3.47274553792237,3.46982135383173,3.46698665703809,3.46424633526361,3.46160527623048,3.45906836766089,3.45664049727701,3.45432655280104,3.45213142195514,3.45005999246152,3.44811715204234,3.44630778841979,3.44463678931605,3.44310904245331,3.44172943555376,3.44050285633956,3.43943419253291,3.43852833185598,3.43779016203097,3.43722457078004,3.4368364458254,3.43663067488921,3.43661214569366,3.43678574596094,3.43715636341322,3.4377288857727,3.43850820076154,3.43949919610194,3.44058617406698,3.4416508406189,3.44269418901359,3.44371721250696,3.44472090435492,3.44570625781337,3.4466742661382,3.44762592258534,3.44856222041067,3.4494841528701,3.45039271321954,3.45128889471489,3.45217369061206,3.45304809416694,3.45391309863544,3.45476969727347,3.45561888333692,3.45646165008171,3.45729899076373,3.45813189863888,3.45896136696309,3.45978838899223,3.46061395798223,3.46143906718898,3.46226470986839,3.46309187927635,3.46392156866878,3.46475477130158,3.46559248043065,3.46643568931189,3.46728539120122,3.46814257935452,3.46900824702771,3.46988338747669,3.47076899395736,3.47166605972563,3.4725755780374,3.47349854214857,3.47443594531505,3.47538878079273,3.47635804183754,3.47734472170536,3.4783498136521,3.47937431093367,3.48041920680597,3.4814854945249,3.48257416734636,3.48368621852627,3.48482264132052,3.48598442898501,3.48717257477566,3.48838807194836,3.48963191375902,3.49090509346353,3.49220860431782,3.49354343957777,3.49491059249929,3.49631105633829,3.49774582435067,3.49921588979233,3.50072224591918,3.50226588598712,3.50384780325205,3.50546899096988,3.50713044239651,3.50883315078785,3.51057810939979,3.51236631148824,3.51419875030911,3.5160764191183,3.51800031117171,3.51997141972525,3.52199073803482,3.52405925935632,3.52617797694566,3.52834788405873,3.53056997395146,3.53284523987973,3.53517467509945,3.53755927286652,3.54000002643686,3.54249792906635,3.54505397401092,3.54766915452645,3.55034446386885,3.55308089529404,3.5558794420579,3.55874109741634,3.56166148427378,3.56463528631477,3.56766208796545,3.57074147365195,3.57387302780041,3.57705633483696,3.58029097918772,3.58357654527885,3.58691261753647,3.59029878038671,3.59373461825571,3.59721971556961,3.60075365675453,3.60433602623661,3.60796640844199,3.61164438779679,3.61536954872716,3.61914147565922,3.62295975301912,3.62682396523298,3.63073369672694,3.63468853192713,3.63868805525968,3.64273185115074,3.64681950402643,3.65095059831288,3.65512471843624,3.65934144882264,3.6636003738982,3.66790107808907,3.67224314582138,3.67662616152125,3.68104970961483,3.68551337452826,3.69001674068765,3.69455939251915,3.69914091444889,3.70376089090301,3.70841890630764,3.71311454508891,3.71784739167295,3.72261703048591,3.72742304595391,3.73226502250309,3.73714254455958,3.74205519654952,3.74700256289904,3.75198422803427,3.75699977638136,3.76204879236642,3.7671308604156,3.77224556495503,3.77739249041084,3.78257122120917,3.78778134177615,3.79302243653792,3.7982940899206,3.80359588635034,3.80892741025327,3.81428824605552,3.81967797818323,3.82509619106252,3.83054246911953,3.83601639678041,3.84151755847127,3.84704553861826,3.85259992164751,3.85818029198515,3.86378623405732,3.86941733229014,3.87507317110976,3.88075333494231,3.88645740821392,3.89218497535073,3.89793562077887,3.90370892892447,3.90950448421367,3.91532187107261,3.9211606739274,3.9270204772042,3.93290086532913,3.93880142272833,3.94472173382793,3.95066138305407,3.95661995483287,3.96259703359048,3.96859220375303,3.97460504974664],"text":["period: 1990-10-01<br />.value_smooth: 1.098931","period: 1990-10-15<br />.value_smooth: 1.098617","period: 1990-11-05<br />.value_smooth: 1.098337","period: 1990-11-19<br />.value_smooth: 1.098090","period: 1990-12-03<br />.value_smooth: 1.097876","period: 1990-12-17<br />.value_smooth: 1.097697","period: 1991-01-07<br />.value_smooth: 1.097551","period: 1991-01-21<br />.value_smooth: 1.097438","period: 1991-02-04<br />.value_smooth: 1.097360","period: 1991-02-18<br />.value_smooth: 1.097316","period: 1991-03-04<br />.value_smooth: 1.097306","period: 1991-03-18<br />.value_smooth: 1.097330","period: 1991-10-07<br />.value_smooth: 1.097388","period: 1991-10-21<br />.value_smooth: 1.097481","period: 1991-11-04<br />.value_smooth: 1.097608","period: 1991-11-18<br />.value_smooth: 1.097769","period: 1991-12-02<br />.value_smooth: 1.097966","period: 1991-12-16<br />.value_smooth: 1.098196","period: 1992-01-06<br />.value_smooth: 1.098462","period: 1992-01-20<br />.value_smooth: 1.098763","period: 1992-02-03<br />.value_smooth: 1.099098","period: 1992-02-17<br />.value_smooth: 1.099469","period: 1992-03-02<br />.value_smooth: 1.099874","period: 1992-03-16<br />.value_smooth: 1.100315","period: 1992-10-05<br />.value_smooth: 1.100791","period: 1992-10-19<br />.value_smooth: 1.101303","period: 1992-11-02<br />.value_smooth: 1.101850","period: 1992-11-16<br />.value_smooth: 1.102432","period: 1992-12-07<br />.value_smooth: 1.103050","period: 1992-12-21<br />.value_smooth: 1.103704","period: 1993-01-04<br />.value_smooth: 1.104394","period: 1993-01-18<br />.value_smooth: 1.105119","period: 1993-02-01<br />.value_smooth: 1.105881","period: 1993-02-15<br />.value_smooth: 1.106678","period: 1993-03-01<br />.value_smooth: 1.107512","period: 1993-03-15<br />.value_smooth: 1.108382","period: 1993-10-04<br />.value_smooth: 1.109288","period: 1993-10-18<br />.value_smooth: 1.110231","period: 1993-11-01<br />.value_smooth: 1.111210","period: 1993-11-15<br />.value_smooth: 1.112226","period: 1993-12-06<br />.value_smooth: 1.113278","period: 1993-12-20<br />.value_smooth: 1.114367","period: 1994-01-03<br />.value_smooth: 1.115493","period: 1994-01-17<br />.value_smooth: 1.116656","period: 1994-01-31<br />.value_smooth: 1.117856","period: 1994-02-07<br />.value_smooth: 1.119093","period: 1994-02-14<br />.value_smooth: 1.120367","period: 1994-02-21<br />.value_smooth: 1.121678","period: 1994-02-28<br />.value_smooth: 1.123027","period: 1994-03-07<br />.value_smooth: 1.124413","period: 1994-03-21<br />.value_smooth: 1.125837","period: 1994-10-03<br />.value_smooth: 1.127298","period: 1994-10-17<br />.value_smooth: 1.128797","period: 1994-11-07<br />.value_smooth: 1.130334","period: 1994-11-21<br />.value_smooth: 1.131908","period: 1994-12-05<br />.value_smooth: 1.133521","period: 1994-12-19<br />.value_smooth: 1.135171","period: 1995-01-02<br />.value_smooth: 1.136860","period: 1995-01-16<br />.value_smooth: 1.138587","period: 1995-02-06<br />.value_smooth: 1.140352","period: 1995-02-20<br />.value_smooth: 1.142155","period: 1995-03-06<br />.value_smooth: 1.143997","period: 1995-03-20<br />.value_smooth: 1.145877","period: 1995-10-02<br />.value_smooth: 1.147796","period: 1995-10-16<br />.value_smooth: 1.149754","period: 1995-11-06<br />.value_smooth: 1.151751","period: 1995-11-20<br />.value_smooth: 1.153786","period: 1995-12-04<br />.value_smooth: 1.155861","period: 1995-12-18<br />.value_smooth: 1.157974","period: 1996-01-01<br />.value_smooth: 1.160127","period: 1996-01-15<br />.value_smooth: 1.162318","period: 1996-02-05<br />.value_smooth: 1.164550","period: 1996-02-19<br />.value_smooth: 1.166820","period: 1996-03-04<br />.value_smooth: 1.169130","period: 1996-03-18<br />.value_smooth: 1.171480","period: 1996-10-07<br />.value_smooth: 1.173869","period: 1996-10-21<br />.value_smooth: 1.176298","period: 1996-10-28<br />.value_smooth: 1.178766","period: 1996-11-04<br />.value_smooth: 1.181275","period: 1996-11-11<br />.value_smooth: 1.183824","period: 1996-11-18<br />.value_smooth: 1.186412","period: 1996-11-25<br />.value_smooth: 1.189041","period: 1996-12-02<br />.value_smooth: 1.191710","period: 1996-12-09<br />.value_smooth: 1.194420","period: 1996-12-16<br />.value_smooth: 1.197170","period: 1996-12-23<br />.value_smooth: 1.199960","period: 1996-12-30<br />.value_smooth: 1.202791","period: 1997-01-06<br />.value_smooth: 1.205662","period: 1997-01-13<br />.value_smooth: 1.208575","period: 1997-01-20<br />.value_smooth: 1.211530","period: 1997-01-27<br />.value_smooth: 1.214529","period: 1997-02-03<br />.value_smooth: 1.217572","period: 1997-02-17<br />.value_smooth: 1.220658","period: 1997-03-03<br />.value_smooth: 1.223788","period: 1997-03-17<br />.value_smooth: 1.226962","period: 1997-10-06<br />.value_smooth: 1.230178","period: 1997-10-20<br />.value_smooth: 1.233437","period: 1997-11-03<br />.value_smooth: 1.236738","period: 1997-11-17<br />.value_smooth: 1.240082","period: 1997-12-01<br />.value_smooth: 1.243468","period: 1997-12-15<br />.value_smooth: 1.246895","period: 1998-01-05<br />.value_smooth: 1.250365","period: 1998-01-19<br />.value_smooth: 1.253875","period: 1998-02-02<br />.value_smooth: 1.257427","period: 1998-02-16<br />.value_smooth: 1.261020","period: 1998-03-02<br />.value_smooth: 1.264653","period: 1998-03-16<br />.value_smooth: 1.268327","period: 1998-10-05<br />.value_smooth: 1.272041","period: 1998-10-19<br />.value_smooth: 1.275795","period: 1998-11-02<br />.value_smooth: 1.279589","period: 1998-11-16<br />.value_smooth: 1.283423","period: 1998-12-07<br />.value_smooth: 1.287296","period: 1998-12-21<br />.value_smooth: 1.291208","period: 1999-01-04<br />.value_smooth: 1.295159","period: 1999-01-18<br />.value_smooth: 1.299148","period: 1999-02-01<br />.value_smooth: 1.303176","period: 1999-02-15<br />.value_smooth: 1.307242","period: 1999-03-01<br />.value_smooth: 1.311346","period: 1999-03-15<br />.value_smooth: 1.315488","period: 1999-10-04<br />.value_smooth: 1.319667","period: 1999-10-18<br />.value_smooth: 1.323884","period: 1999-11-01<br />.value_smooth: 1.328137","period: 1999-11-15<br />.value_smooth: 1.332428","period: 1999-12-06<br />.value_smooth: 1.336755","period: 1999-12-20<br />.value_smooth: 1.341118","period: 2000-01-03<br />.value_smooth: 1.345517","period: 2000-01-17<br />.value_smooth: 1.349953","period: 2000-01-24<br />.value_smooth: 1.354424","period: 2000-01-31<br />.value_smooth: 1.358931","period: 2000-02-07<br />.value_smooth: 1.363472","period: 2000-02-14<br />.value_smooth: 1.368049","period: 2000-02-21<br />.value_smooth: 1.372661","period: 2000-02-28<br />.value_smooth: 1.377307","period: 2000-03-06<br />.value_smooth: 1.381987","period: 2000-03-13<br />.value_smooth: 1.386702","period: 2000-03-20<br />.value_smooth: 1.391450","period: 2000-10-02<br />.value_smooth: 1.396232","period: 2000-10-09<br />.value_smooth: 1.401048","period: 2000-10-16<br />.value_smooth: 1.405896","period: 2000-10-23<br />.value_smooth: 1.410778","period: 2000-10-30<br />.value_smooth: 1.415692","period: 2000-11-06<br />.value_smooth: 1.420639","period: 2000-11-13<br />.value_smooth: 1.425618","period: 2000-11-20<br />.value_smooth: 1.430629","period: 2000-11-27<br />.value_smooth: 1.435672","period: 2000-12-04<br />.value_smooth: 1.440746","period: 2000-12-11<br />.value_smooth: 1.445852","period: 2000-12-18<br />.value_smooth: 1.450989","period: 2000-12-25<br />.value_smooth: 1.456157","period: 2001-01-01<br />.value_smooth: 1.461355","period: 2001-01-08<br />.value_smooth: 1.466584","period: 2001-01-15<br />.value_smooth: 1.471843","period: 2001-01-22<br />.value_smooth: 1.477132","period: 2001-01-29<br />.value_smooth: 1.482451","period: 2001-02-05<br />.value_smooth: 1.487799","period: 2001-02-12<br />.value_smooth: 1.493177","period: 2001-02-19<br />.value_smooth: 1.498584","period: 2001-02-26<br />.value_smooth: 1.504019","period: 2001-03-05<br />.value_smooth: 1.509484","period: 2001-03-12<br />.value_smooth: 1.514976","period: 2001-03-19<br />.value_smooth: 1.520497","period: 2001-10-01<br />.value_smooth: 1.526046","period: 2001-10-08<br />.value_smooth: 1.531622","period: 2001-10-15<br />.value_smooth: 1.537226","period: 2001-10-22<br />.value_smooth: 1.542857","period: 2001-10-29<br />.value_smooth: 1.548515","period: 2001-11-05<br />.value_smooth: 1.554200","period: 2001-11-12<br />.value_smooth: 1.559912","period: 2001-11-19<br />.value_smooth: 1.565650","period: 2001-11-26<br />.value_smooth: 1.571414","period: 2001-12-03<br />.value_smooth: 1.577203","period: 2001-12-10<br />.value_smooth: 1.583019","period: 2001-12-17<br />.value_smooth: 1.588860","period: 2001-12-24<br />.value_smooth: 1.594726","period: 2001-12-31<br />.value_smooth: 1.600617","period: 2002-01-07<br />.value_smooth: 1.606533","period: 2002-01-14<br />.value_smooth: 1.612473","period: 2002-01-21<br />.value_smooth: 1.618459","period: 2002-01-28<br />.value_smooth: 1.624511","period: 2002-02-04<br />.value_smooth: 1.630628","period: 2002-02-11<br />.value_smooth: 1.636810","period: 2002-02-18<br />.value_smooth: 1.643055","period: 2002-02-25<br />.value_smooth: 1.649364","period: 2002-03-04<br />.value_smooth: 1.655734","period: 2002-03-11<br />.value_smooth: 1.662165","period: 2002-03-18<br />.value_smooth: 1.668657","period: 2002-10-07<br />.value_smooth: 1.675208","period: 2002-10-14<br />.value_smooth: 1.681818","period: 2002-10-21<br />.value_smooth: 1.688486","period: 2002-10-28<br />.value_smooth: 1.695211","period: 2002-11-04<br />.value_smooth: 1.701993","period: 2002-11-11<br />.value_smooth: 1.708829","period: 2002-11-18<br />.value_smooth: 1.715721","period: 2002-11-25<br />.value_smooth: 1.722666","period: 2002-12-02<br />.value_smooth: 1.729664","period: 2002-12-09<br />.value_smooth: 1.736714","period: 2002-12-16<br />.value_smooth: 1.743815","period: 2002-12-23<br />.value_smooth: 1.750967","period: 2002-12-30<br />.value_smooth: 1.758169","period: 2003-01-06<br />.value_smooth: 1.765419","period: 2003-01-13<br />.value_smooth: 1.772718","period: 2003-01-20<br />.value_smooth: 1.780063","period: 2003-01-27<br />.value_smooth: 1.787455","period: 2003-02-03<br />.value_smooth: 1.794893","period: 2003-02-10<br />.value_smooth: 1.802375","period: 2003-02-17<br />.value_smooth: 1.809901","period: 2003-02-24<br />.value_smooth: 1.817470","period: 2003-03-03<br />.value_smooth: 1.825082","period: 2003-03-10<br />.value_smooth: 1.832735","period: 2003-03-17<br />.value_smooth: 1.840428","period: 2003-10-06<br />.value_smooth: 1.848161","period: 2003-10-13<br />.value_smooth: 1.855934","period: 2003-10-20<br />.value_smooth: 1.863744","period: 2003-10-27<br />.value_smooth: 1.871592","period: 2003-11-03<br />.value_smooth: 1.879476","period: 2003-11-10<br />.value_smooth: 1.887396","period: 2003-11-17<br />.value_smooth: 1.895350","period: 2003-11-24<br />.value_smooth: 1.903339","period: 2003-12-01<br />.value_smooth: 1.911361","period: 2003-12-08<br />.value_smooth: 1.919415","period: 2003-12-15<br />.value_smooth: 1.927501","period: 2003-12-22<br />.value_smooth: 1.935617","period: 2003-12-29<br />.value_smooth: 1.943764","period: 2004-01-05<br />.value_smooth: 1.951939","period: 2004-01-12<br />.value_smooth: 1.960143","period: 2004-01-19<br />.value_smooth: 1.968374","period: 2004-01-26<br />.value_smooth: 1.976632","period: 2004-02-02<br />.value_smooth: 1.984915","period: 2004-02-09<br />.value_smooth: 1.993224","period: 2004-02-16<br />.value_smooth: 2.001556","period: 2004-02-23<br />.value_smooth: 2.009912","period: 2004-03-01<br />.value_smooth: 2.018291","period: 2004-03-08<br />.value_smooth: 2.026691","period: 2004-03-15<br />.value_smooth: 2.035112","period: 2004-10-04<br />.value_smooth: 2.043553","period: 2004-10-11<br />.value_smooth: 2.052013","period: 2004-10-18<br />.value_smooth: 2.060491","period: 2004-10-25<br />.value_smooth: 2.068987","period: 2004-11-01<br />.value_smooth: 2.077500","period: 2004-11-08<br />.value_smooth: 2.086029","period: 2004-11-15<br />.value_smooth: 2.094572","period: 2004-11-22<br />.value_smooth: 2.103130","period: 2004-11-29<br />.value_smooth: 2.111702","period: 2004-12-06<br />.value_smooth: 2.120286","period: 2004-12-13<br />.value_smooth: 2.128882","period: 2004-12-20<br />.value_smooth: 2.137489","period: 2004-12-27<br />.value_smooth: 2.146106","period: 2005-01-03<br />.value_smooth: 2.154732","period: 2005-01-10<br />.value_smooth: 2.163367","period: 2005-01-17<br />.value_smooth: 2.172009","period: 2005-01-24<br />.value_smooth: 2.180658","period: 2005-01-31<br />.value_smooth: 2.189313","period: 2005-02-07<br />.value_smooth: 2.197974","period: 2005-02-14<br />.value_smooth: 2.206639","period: 2005-02-21<br />.value_smooth: 2.215307","period: 2005-02-28<br />.value_smooth: 2.223978","period: 2005-03-07<br />.value_smooth: 2.232651","period: 2005-03-14<br />.value_smooth: 2.241325","period: 2005-10-03<br />.value_smooth: 2.250000","period: 2005-10-10<br />.value_smooth: 2.258674","period: 2005-10-17<br />.value_smooth: 2.267346","period: 2005-10-24<br />.value_smooth: 2.276016","period: 2005-10-31<br />.value_smooth: 2.284683","period: 2005-11-07<br />.value_smooth: 2.293347","period: 2005-11-14<br />.value_smooth: 2.302005","period: 2005-11-21<br />.value_smooth: 2.310789","period: 2005-11-28<br />.value_smooth: 2.319825","period: 2005-12-05<br />.value_smooth: 2.329106","period: 2005-12-12<br />.value_smooth: 2.338625","period: 2005-12-19<br />.value_smooth: 2.348377","period: 2005-12-26<br />.value_smooth: 2.358355","period: 2006-01-02<br />.value_smooth: 2.368552","period: 2006-01-09<br />.value_smooth: 2.378961","period: 2006-01-16<br />.value_smooth: 2.389578","period: 2006-01-23<br />.value_smooth: 2.400394","period: 2006-01-30<br />.value_smooth: 2.411404","period: 2006-02-06<br />.value_smooth: 2.422600","period: 2006-02-13<br />.value_smooth: 2.433978","period: 2006-02-20<br />.value_smooth: 2.445529","period: 2006-02-27<br />.value_smooth: 2.457248","period: 2006-03-06<br />.value_smooth: 2.469128","period: 2006-03-13<br />.value_smooth: 2.481163","period: 2006-10-02<br />.value_smooth: 2.493347","period: 2006-10-09<br />.value_smooth: 2.505672","period: 2006-10-16<br />.value_smooth: 2.518132","period: 2006-10-23<br />.value_smooth: 2.530722","period: 2006-10-30<br />.value_smooth: 2.543434","period: 2006-11-06<br />.value_smooth: 2.556261","period: 2006-11-13<br />.value_smooth: 2.569199","period: 2006-11-20<br />.value_smooth: 2.582239","period: 2006-11-27<br />.value_smooth: 2.595376","period: 2006-12-04<br />.value_smooth: 2.608603","period: 2006-12-11<br />.value_smooth: 2.621914","period: 2006-12-18<br />.value_smooth: 2.635302","period: 2006-12-25<br />.value_smooth: 2.648761","period: 2007-01-01<br />.value_smooth: 2.662284","period: 2007-01-08<br />.value_smooth: 2.675865","period: 2007-01-15<br />.value_smooth: 2.689497","period: 2007-01-22<br />.value_smooth: 2.703175","period: 2007-01-29<br />.value_smooth: 2.716890","period: 2007-02-05<br />.value_smooth: 2.730638","period: 2007-02-12<br />.value_smooth: 2.744411","period: 2007-02-19<br />.value_smooth: 2.758203","period: 2007-02-26<br />.value_smooth: 2.772008","period: 2007-03-05<br />.value_smooth: 2.785819","period: 2007-03-12<br />.value_smooth: 2.799630","period: 2007-10-08<br />.value_smooth: 2.813434","period: 2007-10-15<br />.value_smooth: 2.827225","period: 2007-10-22<br />.value_smooth: 2.840996","period: 2007-10-29<br />.value_smooth: 2.854741","period: 2007-11-05<br />.value_smooth: 2.868454","period: 2007-11-12<br />.value_smooth: 2.882127","period: 2007-11-19<br />.value_smooth: 2.895755","period: 2007-11-26<br />.value_smooth: 2.909330","period: 2007-12-03<br />.value_smooth: 2.922848","period: 2007-12-10<br />.value_smooth: 2.936300","period: 2007-12-17<br />.value_smooth: 2.949681","period: 2007-12-24<br />.value_smooth: 2.962985","period: 2007-12-31<br />.value_smooth: 2.976204","period: 2008-01-07<br />.value_smooth: 2.989332","period: 2008-01-14<br />.value_smooth: 3.002363","period: 2008-01-21<br />.value_smooth: 3.015290","period: 2008-01-28<br />.value_smooth: 3.028108","period: 2008-02-04<br />.value_smooth: 3.040808","period: 2008-02-11<br />.value_smooth: 3.053386","period: 2008-02-18<br />.value_smooth: 3.065834","period: 2008-02-25<br />.value_smooth: 3.078146","period: 2008-03-03<br />.value_smooth: 3.090316","period: 2008-03-10<br />.value_smooth: 3.102337","period: 2008-03-17<br />.value_smooth: 3.114202","period: 2008-10-06<br />.value_smooth: 3.125906","period: 2008-10-13<br />.value_smooth: 3.137442","period: 2008-10-20<br />.value_smooth: 3.148802","period: 2008-10-27<br />.value_smooth: 3.159982","period: 2008-11-03<br />.value_smooth: 3.170974","period: 2008-11-10<br />.value_smooth: 3.181772","period: 2008-11-17<br />.value_smooth: 3.192369","period: 2008-11-24<br />.value_smooth: 3.202759","period: 2008-12-01<br />.value_smooth: 3.212936","period: 2008-12-08<br />.value_smooth: 3.222893","period: 2008-12-15<br />.value_smooth: 3.232623","period: 2008-12-22<br />.value_smooth: 3.242120","period: 2008-12-29<br />.value_smooth: 3.251379","period: 2009-01-05<br />.value_smooth: 3.260391","period: 2009-01-12<br />.value_smooth: 3.269151","period: 2009-01-19<br />.value_smooth: 3.277653","period: 2009-01-26<br />.value_smooth: 3.285889","period: 2009-02-02<br />.value_smooth: 3.293854","period: 2009-02-09<br />.value_smooth: 3.301540","period: 2009-02-16<br />.value_smooth: 3.308942","period: 2009-02-23<br />.value_smooth: 3.316053","period: 2009-03-02<br />.value_smooth: 3.322867","period: 2009-03-09<br />.value_smooth: 3.329377","period: 2009-03-16<br />.value_smooth: 3.335692","period: 2009-10-05<br />.value_smooth: 3.341927","period: 2009-10-12<br />.value_smooth: 3.348081","period: 2009-10-19<br />.value_smooth: 3.354157","period: 2009-10-26<br />.value_smooth: 3.360153","period: 2009-11-02<br />.value_smooth: 3.366071","period: 2009-11-09<br />.value_smooth: 3.371911","period: 2009-11-16<br />.value_smooth: 3.377672","period: 2009-11-23<br />.value_smooth: 3.383357","period: 2009-11-30<br />.value_smooth: 3.388965","period: 2009-12-07<br />.value_smooth: 3.394496","period: 2009-12-14<br />.value_smooth: 3.399952","period: 2009-12-21<br />.value_smooth: 3.405332","period: 2009-12-28<br />.value_smooth: 3.410637","period: 2010-01-04<br />.value_smooth: 3.415867","period: 2010-01-11<br />.value_smooth: 3.421023","period: 2010-01-18<br />.value_smooth: 3.426106","period: 2010-01-25<br />.value_smooth: 3.431115","period: 2010-02-01<br />.value_smooth: 3.436051","period: 2010-02-08<br />.value_smooth: 3.440916","period: 2010-02-15<br />.value_smooth: 3.445708","period: 2010-02-22<br />.value_smooth: 3.450428","period: 2010-03-01<br />.value_smooth: 3.455078","period: 2010-03-08<br />.value_smooth: 3.459657","period: 2010-03-15<br />.value_smooth: 3.464166","period: 2010-10-04<br />.value_smooth: 3.468605","period: 2010-10-11<br />.value_smooth: 3.472975","period: 2010-10-18<br />.value_smooth: 3.477276","period: 2010-10-25<br />.value_smooth: 3.481509","period: 2010-11-01<br />.value_smooth: 3.485674","period: 2010-11-08<br />.value_smooth: 3.489771","period: 2010-11-15<br />.value_smooth: 3.493801","period: 2010-11-22<br />.value_smooth: 3.497765","period: 2010-11-29<br />.value_smooth: 3.501663","period: 2010-12-06<br />.value_smooth: 3.505494","period: 2010-12-13<br />.value_smooth: 3.509261","period: 2010-12-20<br />.value_smooth: 3.512963","period: 2010-12-27<br />.value_smooth: 3.516600","period: 2011-01-03<br />.value_smooth: 3.520174","period: 2011-01-10<br />.value_smooth: 3.523684","period: 2011-01-17<br />.value_smooth: 3.527131","period: 2011-01-24<br />.value_smooth: 3.530516","period: 2011-01-31<br />.value_smooth: 3.533838","period: 2011-02-07<br />.value_smooth: 3.537099","period: 2011-02-14<br />.value_smooth: 3.540298","period: 2011-02-21<br />.value_smooth: 3.543436","period: 2011-02-28<br />.value_smooth: 3.546515","period: 2011-03-07<br />.value_smooth: 3.549533","period: 2011-03-14<br />.value_smooth: 3.552492","period: 2011-10-03<br />.value_smooth: 3.555392","period: 2011-10-10<br />.value_smooth: 3.558233","period: 2011-10-17<br />.value_smooth: 3.561016","period: 2011-10-24<br />.value_smooth: 3.563741","period: 2011-10-31<br />.value_smooth: 3.566410","period: 2011-11-07<br />.value_smooth: 3.569021","period: 2011-11-14<br />.value_smooth: 3.571576","period: 2011-11-21<br />.value_smooth: 3.574075","period: 2011-11-28<br />.value_smooth: 3.576519","period: 2011-12-05<br />.value_smooth: 3.578908","period: 2011-12-12<br />.value_smooth: 3.581242","period: 2011-12-19<br />.value_smooth: 3.583522","period: 2011-12-26<br />.value_smooth: 3.585748","period: 2012-01-02<br />.value_smooth: 3.587921","period: 2012-01-09<br />.value_smooth: 3.590041","period: 2012-01-16<br />.value_smooth: 3.592109","period: 2012-01-23<br />.value_smooth: 3.594125","period: 2012-01-30<br />.value_smooth: 3.596089","period: 2012-02-06<br />.value_smooth: 3.598003","period: 2012-02-13<br />.value_smooth: 3.599866","period: 2012-02-20<br />.value_smooth: 3.601679","period: 2012-02-27<br />.value_smooth: 3.603442","period: 2012-03-05<br />.value_smooth: 3.605156","period: 2012-03-12<br />.value_smooth: 3.606821","period: 2012-03-19<br />.value_smooth: 3.608437","period: 2012-10-01<br />.value_smooth: 3.610006","period: 2012-10-08<br />.value_smooth: 3.611528","period: 2012-10-15<br />.value_smooth: 3.613002","period: 2012-10-22<br />.value_smooth: 3.614430","period: 2012-10-29<br />.value_smooth: 3.615812","period: 2012-11-05<br />.value_smooth: 3.617148","period: 2012-11-12<br />.value_smooth: 3.618438","period: 2012-11-19<br />.value_smooth: 3.619684","period: 2012-11-26<br />.value_smooth: 3.620886","period: 2012-12-03<br />.value_smooth: 3.622044","period: 2012-12-10<br />.value_smooth: 3.623158","period: 2012-12-17<br />.value_smooth: 3.624230","period: 2012-12-24<br />.value_smooth: 3.625258","period: 2012-12-31<br />.value_smooth: 3.626245","period: 2013-01-07<br />.value_smooth: 3.627105","period: 2013-01-14<br />.value_smooth: 3.627756","period: 2013-01-21<br />.value_smooth: 3.628203","period: 2013-01-28<br />.value_smooth: 3.628452","period: 2013-02-04<br />.value_smooth: 3.628506","period: 2013-02-11<br />.value_smooth: 3.628371","period: 2013-02-18<br />.value_smooth: 3.628052","period: 2013-02-25<br />.value_smooth: 3.627554","period: 2013-03-04<br />.value_smooth: 3.626882","period: 2013-03-11<br />.value_smooth: 3.626039","period: 2013-03-18<br />.value_smooth: 3.625032","period: 2013-10-07<br />.value_smooth: 3.623866","period: 2013-10-14<br />.value_smooth: 3.622544","period: 2013-10-21<br />.value_smooth: 3.621072","period: 2013-10-28<br />.value_smooth: 3.619456","period: 2013-11-04<br />.value_smooth: 3.617699","period: 2013-11-11<br />.value_smooth: 3.615806","period: 2013-11-18<br />.value_smooth: 3.613784","period: 2013-11-25<br />.value_smooth: 3.611635","period: 2013-12-02<br />.value_smooth: 3.609366","period: 2013-12-09<br />.value_smooth: 3.606981","period: 2013-12-16<br />.value_smooth: 3.604486","period: 2013-12-23<br />.value_smooth: 3.601884","period: 2013-12-30<br />.value_smooth: 3.599181","period: 2014-01-06<br />.value_smooth: 3.596382","period: 2014-01-13<br />.value_smooth: 3.593491","period: 2014-01-20<br />.value_smooth: 3.590514","period: 2014-01-27<br />.value_smooth: 3.587456","period: 2014-02-03<br />.value_smooth: 3.584321","period: 2014-02-10<br />.value_smooth: 3.581114","period: 2014-02-17<br />.value_smooth: 3.577840","period: 2014-02-24<br />.value_smooth: 3.574504","period: 2014-03-03<br />.value_smooth: 3.571110","period: 2014-03-10<br />.value_smooth: 3.567665","period: 2014-03-17<br />.value_smooth: 3.564172","period: 2014-10-13<br />.value_smooth: 3.560637","period: 2014-10-20<br />.value_smooth: 3.557064","period: 2014-10-27<br />.value_smooth: 3.553459","period: 2014-11-03<br />.value_smooth: 3.549825","period: 2014-11-10<br />.value_smooth: 3.546169","period: 2014-11-17<br />.value_smooth: 3.542494","period: 2014-11-24<br />.value_smooth: 3.538807","period: 2014-12-01<br />.value_smooth: 3.535111","period: 2014-12-08<br />.value_smooth: 3.531412","period: 2014-12-15<br />.value_smooth: 3.527714","period: 2014-12-22<br />.value_smooth: 3.524023","period: 2014-12-29<br />.value_smooth: 3.520343","period: 2015-01-05<br />.value_smooth: 3.516679","period: 2015-01-12<br />.value_smooth: 3.513037","period: 2015-01-19<br />.value_smooth: 3.509420","period: 2015-01-26<br />.value_smooth: 3.505834","period: 2015-02-02<br />.value_smooth: 3.502284","period: 2015-02-09<br />.value_smooth: 3.498774","period: 2015-02-16<br />.value_smooth: 3.495310","period: 2015-02-23<br />.value_smooth: 3.491896","period: 2015-03-02<br />.value_smooth: 3.488538","period: 2015-03-09<br />.value_smooth: 3.485239","period: 2015-03-16<br />.value_smooth: 3.482006","period: 2015-03-23<br />.value_smooth: 3.478843","period: 2015-03-30<br />.value_smooth: 3.475754","period: 2015-10-05<br />.value_smooth: 3.472746","period: 2015-10-12<br />.value_smooth: 3.469821","period: 2015-10-19<br />.value_smooth: 3.466987","period: 2015-10-26<br />.value_smooth: 3.464246","period: 2015-11-02<br />.value_smooth: 3.461605","period: 2015-11-09<br />.value_smooth: 3.459068","period: 2015-11-16<br />.value_smooth: 3.456640","period: 2015-11-23<br />.value_smooth: 3.454327","period: 2015-11-30<br />.value_smooth: 3.452131","period: 2015-12-07<br />.value_smooth: 3.450060","period: 2015-12-14<br />.value_smooth: 3.448117","period: 2015-12-21<br />.value_smooth: 3.446308","period: 2015-12-28<br />.value_smooth: 3.444637","period: 2016-01-04<br />.value_smooth: 3.443109","period: 2016-01-11<br />.value_smooth: 3.441729","period: 2016-01-18<br />.value_smooth: 3.440503","period: 2016-01-25<br />.value_smooth: 3.439434","period: 2016-02-01<br />.value_smooth: 3.438528","period: 2016-02-08<br />.value_smooth: 3.437790","period: 2016-02-15<br />.value_smooth: 3.437225","period: 2016-02-22<br />.value_smooth: 3.436836","period: 2016-02-29<br />.value_smooth: 3.436631","period: 2016-03-07<br />.value_smooth: 3.436612","period: 2016-03-14<br />.value_smooth: 3.436786","period: 2016-03-21<br />.value_smooth: 3.437156","period: 2016-03-28<br />.value_smooth: 3.437729","period: 2016-10-03<br />.value_smooth: 3.438508","period: 2016-10-10<br />.value_smooth: 3.439499","period: 2016-10-17<br />.value_smooth: 3.440586","period: 2016-10-24<br />.value_smooth: 3.441651","period: 2016-10-31<br />.value_smooth: 3.442694","period: 2016-11-07<br />.value_smooth: 3.443717","period: 2016-11-14<br />.value_smooth: 3.444721","period: 2016-11-21<br />.value_smooth: 3.445706","period: 2016-11-28<br />.value_smooth: 3.446674","period: 2016-12-05<br />.value_smooth: 3.447626","period: 2016-12-12<br />.value_smooth: 3.448562","period: 2016-12-19<br />.value_smooth: 3.449484","period: 2016-12-26<br />.value_smooth: 3.450393","period: 2017-01-02<br />.value_smooth: 3.451289","period: 2017-01-09<br />.value_smooth: 3.452174","period: 2017-01-16<br />.value_smooth: 3.453048","period: 2017-01-23<br />.value_smooth: 3.453913","period: 2017-01-30<br />.value_smooth: 3.454770","period: 2017-02-06<br />.value_smooth: 3.455619","period: 2017-02-13<br />.value_smooth: 3.456462","period: 2017-02-20<br />.value_smooth: 3.457299","period: 2017-02-27<br />.value_smooth: 3.458132","period: 2017-03-06<br />.value_smooth: 3.458961","period: 2017-03-13<br />.value_smooth: 3.459788","period: 2017-03-20<br />.value_smooth: 3.460614","period: 2017-03-27<br />.value_smooth: 3.461439","period: 2017-10-02<br />.value_smooth: 3.462265","period: 2017-10-09<br />.value_smooth: 3.463092","period: 2017-10-16<br />.value_smooth: 3.463922","period: 2017-10-23<br />.value_smooth: 3.464755","period: 2017-10-30<br />.value_smooth: 3.465592","period: 2017-11-06<br />.value_smooth: 3.466436","period: 2017-11-13<br />.value_smooth: 3.467285","period: 2017-11-20<br />.value_smooth: 3.468143","period: 2017-11-27<br />.value_smooth: 3.469008","period: 2017-12-04<br />.value_smooth: 3.469883","period: 2017-12-11<br />.value_smooth: 3.470769","period: 2017-12-18<br />.value_smooth: 3.471666","period: 2017-12-25<br />.value_smooth: 3.472576","period: 2018-01-01<br />.value_smooth: 3.473499","period: 2018-01-08<br />.value_smooth: 3.474436","period: 2018-01-15<br />.value_smooth: 3.475389","period: 2018-01-22<br />.value_smooth: 3.476358","period: 2018-01-29<br />.value_smooth: 3.477345","period: 2018-02-05<br />.value_smooth: 3.478350","period: 2018-02-12<br />.value_smooth: 3.479374","period: 2018-02-19<br />.value_smooth: 3.480419","period: 2018-02-26<br />.value_smooth: 3.481485","period: 2018-03-05<br />.value_smooth: 3.482574","period: 2018-03-12<br />.value_smooth: 3.483686","period: 2018-03-19<br />.value_smooth: 3.484823","period: 2018-03-26<br />.value_smooth: 3.485984","period: 2018-10-01<br />.value_smooth: 3.487173","period: 2018-10-08<br />.value_smooth: 3.488388","period: 2018-10-15<br />.value_smooth: 3.489632","period: 2018-10-22<br />.value_smooth: 3.490905","period: 2018-10-29<br />.value_smooth: 3.492209","period: 2018-11-05<br />.value_smooth: 3.493543","period: 2018-11-12<br />.value_smooth: 3.494911","period: 2018-11-19<br />.value_smooth: 3.496311","period: 2018-11-26<br />.value_smooth: 3.497746","period: 2018-12-03<br />.value_smooth: 3.499216","period: 2018-12-10<br />.value_smooth: 3.500722","period: 2018-12-17<br />.value_smooth: 3.502266","period: 2018-12-24<br />.value_smooth: 3.503848","period: 2018-12-31<br />.value_smooth: 3.505469","period: 2019-01-07<br />.value_smooth: 3.507130","period: 2019-01-14<br />.value_smooth: 3.508833","period: 2019-01-21<br />.value_smooth: 3.510578","period: 2019-01-28<br />.value_smooth: 3.512366","period: 2019-02-04<br />.value_smooth: 3.514199","period: 2019-02-11<br />.value_smooth: 3.516076","period: 2019-02-18<br />.value_smooth: 3.518000","period: 2019-02-25<br />.value_smooth: 3.519971","period: 2019-03-04<br />.value_smooth: 3.521991","period: 2019-03-11<br />.value_smooth: 3.524059","period: 2019-03-18<br />.value_smooth: 3.526178","period: 2019-03-25<br />.value_smooth: 3.528348","period: 2019-10-07<br />.value_smooth: 3.530570","period: 2019-10-14<br />.value_smooth: 3.532845","period: 2019-10-21<br />.value_smooth: 3.535175","period: 2019-10-28<br />.value_smooth: 3.537559","period: 2019-11-04<br />.value_smooth: 3.540000","period: 2019-11-11<br />.value_smooth: 3.542498","period: 2019-11-18<br />.value_smooth: 3.545054","period: 2019-11-25<br />.value_smooth: 3.547669","period: 2019-12-02<br />.value_smooth: 3.550344","period: 2019-12-09<br />.value_smooth: 3.553081","period: 2019-12-16<br />.value_smooth: 3.555879","period: 2019-12-23<br />.value_smooth: 3.558741","period: 2019-12-30<br />.value_smooth: 3.561661","period: 2020-01-06<br />.value_smooth: 3.564635","period: 2020-01-13<br />.value_smooth: 3.567662","period: 2020-01-20<br />.value_smooth: 3.570741","period: 2020-01-27<br />.value_smooth: 3.573873","period: 2020-02-03<br />.value_smooth: 3.577056","period: 2020-02-10<br />.value_smooth: 3.580291","period: 2020-02-17<br />.value_smooth: 3.583577","period: 2020-02-24<br />.value_smooth: 3.586913","period: 2020-03-02<br />.value_smooth: 3.590299","period: 2020-03-09<br />.value_smooth: 3.593735","period: 2020-03-16<br />.value_smooth: 3.597220","period: 2020-03-23<br />.value_smooth: 3.600754","period: 2020-03-30<br />.value_smooth: 3.604336","period: 2020-10-05<br />.value_smooth: 3.607966","period: 2020-10-12<br />.value_smooth: 3.611644","period: 2020-10-19<br />.value_smooth: 3.615370","period: 2020-10-26<br />.value_smooth: 3.619141","period: 2020-11-02<br />.value_smooth: 3.622960","period: 2020-11-09<br />.value_smooth: 3.626824","period: 2020-11-16<br />.value_smooth: 3.630734","period: 2020-11-23<br />.value_smooth: 3.634689","period: 2020-11-30<br />.value_smooth: 3.638688","period: 2020-12-07<br />.value_smooth: 3.642732","period: 2020-12-14<br />.value_smooth: 3.646820","period: 2020-12-21<br />.value_smooth: 3.650951","period: 2020-12-28<br />.value_smooth: 3.655125","period: 2021-01-04<br />.value_smooth: 3.659341","period: 2021-01-11<br />.value_smooth: 3.663600","period: 2021-01-18<br />.value_smooth: 3.667901","period: 2021-01-25<br />.value_smooth: 3.672243","period: 2021-02-01<br />.value_smooth: 3.676626","period: 2021-02-08<br />.value_smooth: 3.681050","period: 2021-02-15<br />.value_smooth: 3.685513","period: 2021-02-22<br />.value_smooth: 3.690017","period: 2021-03-01<br />.value_smooth: 3.694559","period: 2021-03-08<br />.value_smooth: 3.699141","period: 2021-03-15<br />.value_smooth: 3.703761","period: 2021-03-22<br />.value_smooth: 3.708419","period: 2021-03-29<br />.value_smooth: 3.713115","period: 2021-10-04<br />.value_smooth: 3.717847","period: 2021-10-11<br />.value_smooth: 3.722617","period: 2021-10-18<br />.value_smooth: 3.727423","period: 2021-10-25<br />.value_smooth: 3.732265","period: 2021-11-01<br />.value_smooth: 3.737143","period: 2021-11-08<br />.value_smooth: 3.742055","period: 2021-11-15<br />.value_smooth: 3.747003","period: 2021-11-22<br />.value_smooth: 3.751984","period: 2021-11-29<br />.value_smooth: 3.757000","period: 2021-12-06<br />.value_smooth: 3.762049","period: 2021-12-13<br />.value_smooth: 3.767131","period: 2021-12-20<br />.value_smooth: 3.772246","period: 2021-12-27<br />.value_smooth: 3.777392","period: 2022-01-03<br />.value_smooth: 3.782571","period: 2022-01-10<br />.value_smooth: 3.787781","period: 2022-01-17<br />.value_smooth: 3.793022","period: 2022-01-24<br />.value_smooth: 3.798294","period: 2022-01-31<br />.value_smooth: 3.803596","period: 2022-02-07<br />.value_smooth: 3.808927","period: 2022-02-14<br />.value_smooth: 3.814288","period: 2022-02-21<br />.value_smooth: 3.819678","period: 2022-02-28<br />.value_smooth: 3.825096","period: 2022-03-07<br />.value_smooth: 3.830542","period: 2022-03-14<br />.value_smooth: 3.836016","period: 2022-03-21<br />.value_smooth: 3.841518","period: 2022-03-28<br />.value_smooth: 3.847046","period: 2022-10-03<br />.value_smooth: 3.852600","period: 2022-10-10<br />.value_smooth: 3.858180","period: 2022-10-17<br />.value_smooth: 3.863786","period: 2022-10-24<br />.value_smooth: 3.869417","period: 2022-10-31<br />.value_smooth: 3.875073","period: 2022-11-07<br />.value_smooth: 3.880753","period: 2022-11-14<br />.value_smooth: 3.886457","period: 2022-11-21<br />.value_smooth: 3.892185","period: 2022-11-28<br />.value_smooth: 3.897936","period: 2022-12-05<br />.value_smooth: 3.903709","period: 2022-12-12<br />.value_smooth: 3.909504","period: 2022-12-19<br />.value_smooth: 3.915322","period: 2022-12-26<br />.value_smooth: 3.921161","period: 2023-01-02<br />.value_smooth: 3.927020","period: 2023-01-09<br />.value_smooth: 3.932901","period: 2023-01-16<br />.value_smooth: 3.938801","period: 2023-01-23<br />.value_smooth: 3.944722","period: 2023-01-30<br />.value_smooth: 3.950661","period: 2023-02-06<br />.value_smooth: 3.956620","period: 2023-02-13<br />.value_smooth: 3.962597","period: 2023-02-20<br />.value_smooth: 3.968592","period: 2023-02-27<br />.value_smooth: 3.974605"],"type":"scatter","mode":"lines","line":{"width":3.77952755905512,"color":"rgba(51,102,255,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":43.7625570776256,"r":7.30593607305936,"b":25.5707762557078,"l":16.8036529680365},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(44,62,80,1)","family":"","size":14.6118721461187},"title":{"text":"Time Series Plot","font":{"color":"rgba(44,62,80,1)","family":"","size":17.5342465753425},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"date","autorange":true,"range":["1989-02-16","2024-10-10"],"tickmode":"auto","ticktext":["1990","2000","2010","2020"],"tickvals":[7305,10957,14610,18262],"categoryorder":"array","categoryarray":["1990","2000","2010","2020"],"nticks":null,"ticks":"outside","tickcolor":"rgba(204,204,204,1)","ticklen":3.65296803652968,"tickwidth":0.22139200221392,"showticklabels":true,"tickfont":{"color":"rgba(44,62,80,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(204,204,204,1)","gridwidth":0.22139200221392,"zeroline":false,"anchor":"y","title":{"text":"","font":{"color":"rgba(44,62,80,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":true,"range":[0.76485,6.31215],"tickmode":"auto","ticktext":["2","4","6"],"tickvals":[2,4,6],"categoryorder":"array","categoryarray":["2","4","6"],"nticks":null,"ticks":"outside","tickcolor":"rgba(204,204,204,1)","ticklen":3.65296803652968,"tickwidth":0.22139200221392,"showticklabels":true,"tickfont":{"color":"rgba(44,62,80,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(204,204,204,1)","gridwidth":0.22139200221392,"zeroline":false,"anchor":"x","title":{"text":"","font":{"color":"rgba(44,62,80,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(44,62,80,1)","width":0.33208800332088,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(44,62,80,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"644836f15f24":{"x":{},"y":{},"type":"scatter"},"64488c979ec":{"x":{},"y":{}}},"cur_data":"644836f15f24","visdat":{"644836f15f24":["function (y) ","x"],"64488c979ec":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Voila!</p>


</section>

 ]]></description>
  <category>code</category>
  <category>rtip</category>
  <category>rvest</category>
  <guid>https://www.spsanderson.com/steveondata/posts/rtip-2023-03-08/index.html</guid>
  <pubDate>Wed, 08 Mar 2023 05:00:00 GMT</pubDate>
</item>
<item>
  <title>tidy_bernoulli() with {data.table}</title>
  <dc:creator>Steven P. Sanderson II, MPH</dc:creator>
  <link>https://www.spsanderson.com/steveondata/posts/rtip-2023-03-07/index.html</link>
  <description><![CDATA[ 




<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>So I was challanged by Adrian Antico to learn <a href="https://rdatatable.gitlab.io/data.table/"><code>data.table</code></a>, so yesterday I started with a single function from my package <a href="https://www.spsanderson.com/TidyDensity/"><code>{TidyDensity}</code></a> called <strong>tidy_bernoulli()</strong>.</p>
<p>So let’s see how I did (hint, works but needs a lot of improvement, so I’ll learn it.)</p>
</section>
<section id="function" class="level1">
<h1>Function</h1>
<p>Let’s see the function in <code>data.table</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;">library</span>(data.table)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;">library</span>(tidyr)</span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;">library</span>(stats)</span>
<span id="cb1-4"><span class="fu" style="color: #4758AB;">library</span>(purrr)</span>
<span id="cb1-5"></span>
<span id="cb1-6">new_func <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="cf" style="color: #003B4F;">function</span>(num_sims, n, pr) {</span>
<span id="cb1-7"></span>
<span id="cb1-8">  <span class="co" style="color: #5E5E5E;"># Create a data.table with one row per simulation</span></span>
<span id="cb1-9">  sim_data <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">data.table</span>(<span class="at" style="color: #657422;">sim_number =</span> <span class="fu" style="color: #4758AB;">factor</span>(<span class="fu" style="color: #4758AB;">seq</span>(<span class="dv" style="color: #AD0000;">1</span>, num_sims, <span class="dv" style="color: #AD0000;">1</span>)))</span>
<span id="cb1-10">  </span>
<span id="cb1-11">  <span class="co" style="color: #5E5E5E;"># Group the data by sim_number and add columns for x and y</span></span>
<span id="cb1-12">  sim_data[, <span class="st" style="color: #20794D;">`</span><span class="at" style="color: #657422;">:=</span><span class="st" style="color: #20794D;">`</span> (</span>
<span id="cb1-13">    <span class="at" style="color: #657422;">x =</span> <span class="fu" style="color: #4758AB;">list</span>(<span class="dv" style="color: #AD0000;">1</span><span class="sc" style="color: #5E5E5E;">:</span>n),</span>
<span id="cb1-14">    <span class="at" style="color: #657422;">y =</span> <span class="fu" style="color: #4758AB;">list</span>(stats<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">rbinom</span>(<span class="at" style="color: #657422;">n =</span> n, <span class="at" style="color: #657422;">size =</span> <span class="dv" style="color: #AD0000;">1</span>, <span class="at" style="color: #657422;">prob =</span> pr))</span>
<span id="cb1-15">  ), by <span class="ot" style="color: #003B4F;">=</span> sim_number]</span>
<span id="cb1-16">  </span>
<span id="cb1-17">  <span class="co" style="color: #5E5E5E;"># Compute the density of the y values and add columns for dx and dy</span></span>
<span id="cb1-18">  sim_data[, <span class="st" style="color: #20794D;">`</span><span class="at" style="color: #657422;">:=</span><span class="st" style="color: #20794D;">`</span> (</span>
<span id="cb1-19">    <span class="at" style="color: #657422;">d =</span> <span class="fu" style="color: #4758AB;">list</span>(<span class="fu" style="color: #4758AB;">density</span>(<span class="fu" style="color: #4758AB;">unlist</span>(y), <span class="at" style="color: #657422;">n =</span> n)[<span class="fu" style="color: #4758AB;">c</span>(<span class="st" style="color: #20794D;">"x"</span>, <span class="st" style="color: #20794D;">"y"</span>)] <span class="sc" style="color: #5E5E5E;">|&gt;</span></span>
<span id="cb1-20">      <span class="fu" style="color: #4758AB;">set_names</span>(<span class="st" style="color: #20794D;">"dx"</span>, <span class="st" style="color: #20794D;">"dy"</span>) <span class="sc" style="color: #5E5E5E;">|&gt;</span></span>
<span id="cb1-21">      <span class="fu" style="color: #4758AB;">as_tibble</span>())</span>
<span id="cb1-22">  ), by <span class="ot" style="color: #003B4F;">=</span> sim_number]</span>
<span id="cb1-23">  </span>
<span id="cb1-24">  <span class="co" style="color: #5E5E5E;"># Compute the p-values for the y values and add a column for p</span></span>
<span id="cb1-25">  sim_data[, <span class="st" style="color: #20794D;">`</span><span class="at" style="color: #657422;">:=</span><span class="st" style="color: #20794D;">`</span> (</span>
<span id="cb1-26">    <span class="at" style="color: #657422;">p =</span> <span class="fu" style="color: #4758AB;">list</span>(stats<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">pbinom</span>(<span class="fu" style="color: #4758AB;">unlist</span>(y), <span class="at" style="color: #657422;">size =</span> <span class="dv" style="color: #AD0000;">1</span>, <span class="at" style="color: #657422;">prob =</span> pr))</span>
<span id="cb1-27">  ), by <span class="ot" style="color: #003B4F;">=</span> sim_number]</span>
<span id="cb1-28">  </span>
<span id="cb1-29">  <span class="co" style="color: #5E5E5E;"># Compute the q-values for the p-values and add a column for q</span></span>
<span id="cb1-30">  sim_data[, <span class="st" style="color: #20794D;">`</span><span class="at" style="color: #657422;">:=</span><span class="st" style="color: #20794D;">`</span> (</span>
<span id="cb1-31">    <span class="at" style="color: #657422;">q =</span> <span class="fu" style="color: #4758AB;">list</span>(stats<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">qbinom</span>(<span class="fu" style="color: #4758AB;">unlist</span>(p), <span class="at" style="color: #657422;">size =</span> <span class="dv" style="color: #AD0000;">1</span>, <span class="at" style="color: #657422;">prob =</span> pr))</span>
<span id="cb1-32">  ), by <span class="ot" style="color: #003B4F;">=</span> sim_number]</span>
<span id="cb1-33">  </span>
<span id="cb1-34">  <span class="co" style="color: #5E5E5E;"># Unnest the columns for x, y, d, p, and q</span></span>
<span id="cb1-35">  sim_data <span class="ot" style="color: #003B4F;">&lt;-</span> sim_data[, </span>
<span id="cb1-36">                       <span class="fu" style="color: #4758AB;">unnest</span>(</span>
<span id="cb1-37">                         .SD, </span>
<span id="cb1-38">                         <span class="at" style="color: #657422;">cols =</span> <span class="fu" style="color: #4758AB;">c</span>(<span class="st" style="color: #20794D;">"x"</span>, <span class="st" style="color: #20794D;">"y"</span>, <span class="st" style="color: #20794D;">"d"</span>, <span class="st" style="color: #20794D;">"p"</span>, <span class="st" style="color: #20794D;">"q"</span>)</span>
<span id="cb1-39">                         ), </span>
<span id="cb1-40">                       by <span class="ot" style="color: #003B4F;">=</span> sim_number]</span>
<span id="cb1-41">  </span>
<span id="cb1-42">  <span class="co" style="color: #5E5E5E;"># Remove the grouping</span></span>
<span id="cb1-43">  sim_data[, sim_number <span class="sc" style="color: #5E5E5E;">:</span><span class="er" style="color: #AD0000;">=</span> <span class="fu" style="color: #4758AB;">as.factor</span>(sim_number)]</span>
<span id="cb1-44">  </span>
<span id="cb1-45">  <span class="fu" style="color: #4758AB;">return</span>(sim_data)</span>
<span id="cb1-46">}</span></code></pre></div>
</div>
</section>
<section id="example" class="level1">
<h1>Example</h1>
<p>Now, let’s see the output of the original function <strong>tidy_bernoulli()</strong> and <strong>new_func()</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;">library</span>(TidyDensity)</span>
<span id="cb2-2">n <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="dv" style="color: #AD0000;">50</span></span>
<span id="cb2-3">pr <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fl" style="color: #AD0000;">0.1</span></span>
<span id="cb2-4">sims <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="dv" style="color: #AD0000;">5</span></span>
<span id="cb2-5"></span>
<span id="cb2-6"><span class="fu" style="color: #4758AB;">set.seed</span>(<span class="dv" style="color: #AD0000;">123</span>)</span>
<span id="cb2-7">tb <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">tidy_bernoulli</span>(<span class="at" style="color: #657422;">.n =</span> n, <span class="at" style="color: #657422;">.prob =</span> pr, <span class="at" style="color: #657422;">.num_sims =</span> sims)</span>
<span id="cb2-8"></span>
<span id="cb2-9"><span class="fu" style="color: #4758AB;">set.seed</span>(<span class="dv" style="color: #AD0000;">123</span>)</span>
<span id="cb2-10">nf <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">new_func</span>(<span class="at" style="color: #657422;">n =</span> n, <span class="at" style="color: #657422;">num_sims =</span> sims, <span class="at" style="color: #657422;">pr =</span> pr)</span>
<span id="cb2-11"></span>
<span id="cb2-12"><span class="fu" style="color: #4758AB;">print</span>(tb)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 250 × 7
   sim_number     x     y      dx     dy     p     q
   &lt;fct&gt;      &lt;int&gt; &lt;int&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 1              1     0 -0.405  0.0292   0.9     0
 2 1              2     0 -0.368  0.0637   0.9     0
 3 1              3     0 -0.331  0.129    0.9     0
 4 1              4     0 -0.294  0.243    0.9     0
 5 1              5     1 -0.258  0.424    1       1
 6 1              6     0 -0.221  0.688    0.9     0
 7 1              7     0 -0.184  1.03     0.9     0
 8 1              8     0 -0.147  1.44     0.9     0
 9 1              9     0 -0.110  1.87     0.9     0
10 1             10     0 -0.0727 2.25     0.9     0
# … with 240 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="fu" style="color: #4758AB;">print</span>(nf)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     sim_number  x y         dx          dy   p q
  1:          1  1 0 -0.4053113 0.029196114 0.9 0
  2:          1  2 0 -0.3683598 0.063683226 0.9 0
  3:          1  3 0 -0.3314083 0.129227066 0.9 0
  4:          1  4 0 -0.2944568 0.242967496 0.9 0
  5:          1  5 1 -0.2575054 0.424395426 1.0 1
 ---                                             
246:          5 46 0  1.2575054 0.057872104 0.9 0
247:          5 47 0  1.2944568 0.033131931 0.9 0
248:          5 48 1  1.3314083 0.017621873 1.0 1
249:          5 49 1  1.3683598 0.008684076 1.0 1
250:          5 50 0  1.4053113 0.003981288 0.9 0</code></pre>
</div>
</div>
<p>Ok so at least the output is identical which is a good sign. Now let’s benchmark the two solutions.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="fu" style="color: #4758AB;">library</span>(rbenchmark)</span>
<span id="cb6-2"><span class="fu" style="color: #4758AB;">library</span>(dplyr)</span>
<span id="cb6-3"></span>
<span id="cb6-4"><span class="fu" style="color: #4758AB;">benchmark</span>(</span>
<span id="cb6-5">  <span class="st" style="color: #20794D;">"original"</span> <span class="ot" style="color: #003B4F;">=</span> {</span>
<span id="cb6-6">    <span class="fu" style="color: #4758AB;">tidy_bernoulli</span>(<span class="at" style="color: #657422;">.n =</span> n, <span class="at" style="color: #657422;">.prob =</span> pr, <span class="at" style="color: #657422;">.num_sims =</span> sims)</span>
<span id="cb6-7">  },</span>
<span id="cb6-8">  <span class="st" style="color: #20794D;">"data.table"</span> <span class="ot" style="color: #003B4F;">=</span> {</span>
<span id="cb6-9">    <span class="fu" style="color: #4758AB;">new_func</span>(<span class="at" style="color: #657422;">n =</span> n, <span class="at" style="color: #657422;">pr =</span> pr, <span class="at" style="color: #657422;">num_sims =</span> sims)</span>
<span id="cb6-10">  },</span>
<span id="cb6-11">  <span class="at" style="color: #657422;">replications =</span> <span class="dv" style="color: #AD0000;">100</span>,</span>
<span id="cb6-12">  <span class="at" style="color: #657422;">columns =</span> <span class="fu" style="color: #4758AB;">c</span>(<span class="st" style="color: #20794D;">"test"</span>,<span class="st" style="color: #20794D;">"replications"</span>,<span class="st" style="color: #20794D;">"elapsed"</span>,<span class="st" style="color: #20794D;">"relative"</span>,<span class="st" style="color: #20794D;">"user.self"</span>,<span class="st" style="color: #20794D;">"sys.self"</span>  )</span>
<span id="cb6-13">) <span class="sc" style="color: #5E5E5E;">|&gt;</span></span>
<span id="cb6-14">  <span class="fu" style="color: #4758AB;">arrange</span>(relative)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        test replications elapsed relative user.self sys.self
1   original          100    3.29     1.00      2.51     0.08
2 data.table          100    4.64     1.41      3.34     0.04</code></pre>
</div>
</div>
<p>Yeah, needs some work but it’s a start.</p>


</section>

 ]]></description>
  <category>code</category>
  <category>rtip</category>
  <category>data.table</category>
  <guid>https://www.spsanderson.com/steveondata/posts/rtip-2023-03-07/index.html</guid>
  <pubDate>Tue, 07 Mar 2023 05:00:00 GMT</pubDate>
</item>
<item>
  <title>Simple examples of imap() from {purrr}</title>
  <dc:creator>Steven P. Sanderson II, MPH</dc:creator>
  <link>https://www.spsanderson.com/steveondata/posts/rtip-2023-03-06/index.html</link>
  <description><![CDATA[ 




<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>The <a href="https://purrr.tidyverse.org/reference/imap.html"><code>imap()</code></a> function is a powerful tool for iterating over a list or a vector while also keeping track of the index or names of the elements. This function applies a given function to each element of a list, along with the name or index of that element, and returns a new list with the results.</p>
<p>The <code>imap()</code> function takes two main arguments: <code>x</code> and <code>.f</code>. <code>x</code> is the list or vector to iterate over, and <code>.f</code> is the function to apply to each element. The .f function takes two arguments: x and i, where x is the value of the element and i is the index or name of the element.</p>
</section>
<section id="function" class="level1">
<h1>Function</h1>
<p>Here is the <code>imap()</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;">imap</span>(.x, .f, ...)</span></code></pre></div>
</div>
<p>Here is the documentation from the function page:</p>
<ul>
<li><code>.x</code> - A list or atomic vector.</li>
<li><code>.f</code> - A function, specified in one of the following ways:
<ul>
<li>A named function, e.g.&nbsp;paste.</li>
<li>An anonymous function, e.g.&nbsp;(x, idx) x + idx or function(x, idx) x + idx.</li>
<li>A formula, e.g.&nbsp;~ .x + .y. You must use .x to refer to the current element and .y to refer to the current index. Only recommended if you require backward compatibility with older versions of R.</li>
</ul></li>
<li><code>...</code> - Additional arguments passed on to the mapped function. We now generally recommend against using … to pass additional (constant) arguments to .f. Instead use a shorthand anonymous function:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;"># Instead of</span></span>
<span id="cb2-2">x <span class="sc" style="color: #5E5E5E;">|&gt;</span> <span class="fu" style="color: #4758AB;">map</span>(f, <span class="dv" style="color: #AD0000;">1</span>, <span class="dv" style="color: #AD0000;">2</span>, <span class="at" style="color: #657422;">collapse =</span> <span class="st" style="color: #20794D;">","</span>)</span>
<span id="cb2-3"><span class="co" style="color: #5E5E5E;"># do:</span></span>
<span id="cb2-4">x <span class="sc" style="color: #5E5E5E;">|&gt;</span> <span class="fu" style="color: #4758AB;">map</span>(\(x) <span class="fu" style="color: #4758AB;">f</span>(x, <span class="dv" style="color: #AD0000;">1</span>, <span class="dv" style="color: #AD0000;">2</span>, <span class="at" style="color: #657422;">collapse =</span> <span class="st" style="color: #20794D;">","</span>))</span></code></pre></div>
</div>
<p>This makes it easier to understand which arguments belong to which function and will tend to yield better error messages.</p>
</section>
<section id="example" class="level1">
<h1>Example</h1>
<p>Here’s an example of using imap() with a simple list of integers:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;">library</span>(purrr)</span>
<span id="cb3-2"></span>
<span id="cb3-3"><span class="co" style="color: #5E5E5E;"># create a list of integers</span></span>
<span id="cb3-4">my_list <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">list</span>(<span class="dv" style="color: #AD0000;">1</span>, <span class="dv" style="color: #AD0000;">2</span>, <span class="dv" style="color: #AD0000;">3</span>, <span class="dv" style="color: #AD0000;">4</span>, <span class="dv" style="color: #AD0000;">5</span>)</span>
<span id="cb3-5"></span>
<span id="cb3-6"><span class="co" style="color: #5E5E5E;"># define a function to apply to each element of the list</span></span>
<span id="cb3-7">my_function <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="cf" style="color: #003B4F;">function</span>(x, i) {</span>
<span id="cb3-8">  <span class="fu" style="color: #4758AB;">paste</span>(<span class="st" style="color: #20794D;">"The element at index"</span>, i, <span class="st" style="color: #20794D;">"is"</span>, x)</span>
<span id="cb3-9">}</span>
<span id="cb3-10"></span>
<span id="cb3-11"><span class="co" style="color: #5E5E5E;"># apply the function to each element of the list using imap()</span></span>
<span id="cb3-12">result <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">imap</span>(my_list, my_function)</span>
<span id="cb3-13"></span>
<span id="cb3-14"><span class="co" style="color: #5E5E5E;"># print the result</span></span>
<span id="cb3-15"><span class="fu" style="color: #4758AB;">print</span>(result)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] "The element at index 1 is 1"

[[2]]
[1] "The element at index 2 is 2"

[[3]]
[1] "The element at index 3 is 3"

[[4]]
[1] "The element at index 4 is 4"

[[5]]
[1] "The element at index 5 is 5"</code></pre>
</div>
</div>
<p>In this example, we create a list of integers called my_list. We define a function called my_function that takes two arguments: x, which is the value of each element in the list, and i, which is the index of that element. We then use imap() to apply my_function to each element of my_list, passing both the value and the index of the element as arguments. The result is a new list where each element contains the output of my_function applied to the corresponding element of my_list.</p>
<p>Now let’s take a look at a slightly more complex example. In this case, we will use imap() to iterate over a list of data frames, apply a function to each data frame that subsets the data to include only certain columns, and return a new list of data frames with the subsetted data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="co" style="color: #5E5E5E;"># create a list of data frames</span></span>
<span id="cb5-2">my_list <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">list</span>(</span>
<span id="cb5-3">  <span class="fu" style="color: #4758AB;">data.frame</span>(<span class="at" style="color: #657422;">x =</span> <span class="dv" style="color: #AD0000;">1</span><span class="sc" style="color: #5E5E5E;">:</span><span class="dv" style="color: #AD0000;">5</span>, <span class="at" style="color: #657422;">y =</span> <span class="fu" style="color: #4758AB;">c</span>(<span class="st" style="color: #20794D;">"a"</span>, <span class="st" style="color: #20794D;">"b"</span>, <span class="st" style="color: #20794D;">"c"</span>, <span class="st" style="color: #20794D;">"d"</span>, <span class="st" style="color: #20794D;">"e"</span>)),</span>
<span id="cb5-4">  <span class="fu" style="color: #4758AB;">data.frame</span>(<span class="at" style="color: #657422;">x =</span> <span class="dv" style="color: #AD0000;">6</span><span class="sc" style="color: #5E5E5E;">:</span><span class="dv" style="color: #AD0000;">10</span>, <span class="at" style="color: #657422;">y =</span> <span class="fu" style="color: #4758AB;">c</span>(<span class="st" style="color: #20794D;">"f"</span>, <span class="st" style="color: #20794D;">"g"</span>, <span class="st" style="color: #20794D;">"h"</span>, <span class="st" style="color: #20794D;">"i"</span>, <span class="st" style="color: #20794D;">"j"</span>)),</span>
<span id="cb5-5">  <span class="fu" style="color: #4758AB;">data.frame</span>(<span class="at" style="color: #657422;">x =</span> <span class="dv" style="color: #AD0000;">11</span><span class="sc" style="color: #5E5E5E;">:</span><span class="dv" style="color: #AD0000;">15</span>, <span class="at" style="color: #657422;">y =</span> <span class="fu" style="color: #4758AB;">c</span>(<span class="st" style="color: #20794D;">"k"</span>, <span class="st" style="color: #20794D;">"l"</span>, <span class="st" style="color: #20794D;">"m"</span>, <span class="st" style="color: #20794D;">"n"</span>, <span class="st" style="color: #20794D;">"o"</span>))</span>
<span id="cb5-6">)</span>
<span id="cb5-7"></span>
<span id="cb5-8"><span class="co" style="color: #5E5E5E;"># define a function to apply to each element of the list</span></span>
<span id="cb5-9">my_function <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="cf" style="color: #003B4F;">function</span>(df, i) {</span>
<span id="cb5-10">  <span class="co" style="color: #5E5E5E;"># subset the data to include only the x column</span></span>
<span id="cb5-11">  df_subset <span class="ot" style="color: #003B4F;">&lt;-</span> df[, <span class="st" style="color: #20794D;">"x"</span>, drop <span class="ot" style="color: #003B4F;">=</span> <span class="cn" style="color: #8f5902;">FALSE</span>]</span>
<span id="cb5-12">  <span class="co" style="color: #5E5E5E;"># rename the column to include the index of the element</span></span>
<span id="cb5-13">  <span class="fu" style="color: #4758AB;">colnames</span>(df_subset) <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">paste</span>(<span class="st" style="color: #20794D;">"x_"</span>, i, <span class="at" style="color: #657422;">sep =</span> <span class="st" style="color: #20794D;">""</span>)</span>
<span id="cb5-14">  <span class="co" style="color: #5E5E5E;"># return the subsetted data frame</span></span>
<span id="cb5-15">  <span class="fu" style="color: #4758AB;">return</span>(df_subset)</span>
<span id="cb5-16">}</span>
<span id="cb5-17"></span>
<span id="cb5-18"><span class="co" style="color: #5E5E5E;"># apply the function to each element of the list using imap</span></span>
<span id="cb5-19">result <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">imap</span>(my_list, my_function)</span>
<span id="cb5-20"></span>
<span id="cb5-21"><span class="co" style="color: #5E5E5E;"># print the result</span></span>
<span id="cb5-22"><span class="fu" style="color: #4758AB;">print</span>(result)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
  x_1
1   1
2   2
3   3
4   4
5   5

[[2]]
  x_2
1   6
2   7
3   8
4   9
5  10

[[3]]
  x_3
1  11
2  12
3  13
4  14
5  15</code></pre>
</div>
</div>
<p>In this example, we create a list of three data frames called my_list. We define a function called my_function that takes two arguments: df, which is the value of each element in the list (a data frame), and i, which is the index of that element. The function subsets the data frame to include only the x column, renames the column to include the index of the element, and returns the subsetted data frame.</p>
<p>We use imap() to apply my_function to each element of my_list, passing both the data frame and the index of the element as arguments. The result is a new list of data frames, where each data frame contains only the x column from the original data frame, with a new name that includes the index of the element.</p>
<p>As you can see, the output is a list of three data frames, each containing only the x column from the corresponding original data frame, with a new name that includes the index of the element.</p>
<p>In summary, the imap() function from the R library purrr is a useful tool for iterating over a list or a vector while also keeping track of the index or names of the elements. The function takes a list or a vector as its first argument, and a function as its second argument, which takes two arguments: the value of each element, and the index or name of that element. The function returns a new list or vector with the results of applying the function to each element of the original list or vector. This function is particularly useful for complex data structures, where the index or name of each element is important for further data analysis or processing.</p>
<p>Voila!</p>


</section>

 ]]></description>
  <category>code</category>
  <category>rtip</category>
  <category>purrr</category>
  <guid>https://www.spsanderson.com/steveondata/posts/rtip-2023-03-06/index.html</guid>
  <pubDate>Mon, 06 Mar 2023 05:00:00 GMT</pubDate>
</item>
<item>
  <title>Simple examples of pmap() from {purrr}</title>
  <dc:creator>Steven P. Sanderson II, MPH</dc:creator>
  <link>https://www.spsanderson.com/steveondata/posts/rtip-2023-03-03/index.html</link>
  <description><![CDATA[ 




<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>The pmap() function in R is part of the purrr library, which is a package designed to make it easier to work with functions that operate on vectors, lists, and other types of data structures.</p>
<p>The pmap() function is used to apply a function to a list of arguments, where each element in the list contains the arguments for a single function call. The function is applied in parallel, meaning that each call is executed concurrently, which can help speed up computations when working with large datasets.</p>
<p>Here is the basic syntax of the pmap() function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;">pmap</span>(.l, .f, ...)</span></code></pre></div>
</div>
<p>where:</p>
<ul>
<li><code>.l</code> - is a list of arguments, where each element of the list contains the arguments for a single function call.</li>
<li><code>.f</code> - is the function to apply to the arguments in .l.</li>
<li><code>...</code> - is used to pass additional arguments to .f.</li>
</ul>
<p>The <code>pmap()</code> function returns a list, where each element of the list contains the output of a single function call.</p>
<p>Let’s define a function for an example.</p>
</section>
<section id="function" class="level1">
<h1>Function</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">my_function <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="cf" style="color: #003B4F;">function</span>(a, b, c) {</span>
<span id="cb2-2">  <span class="co" style="color: #5E5E5E;"># do something with a, b, and c</span></span>
<span id="cb2-3">  <span class="fu" style="color: #4758AB;">return</span>(a <span class="sc" style="color: #5E5E5E;">+</span> b <span class="sc" style="color: #5E5E5E;">+</span> c)</span>
<span id="cb2-4">}</span></code></pre></div>
</div>
<p>A very simple function that just adds up the elements passed.</p>
<p>Now let’s go over a couple simple examples.</p>
</section>
<section id="example" class="level1">
<h1>Example</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;">library</span>(purrr)</span>
<span id="cb3-2"><span class="fu" style="color: #4758AB;">library</span>(TidyDensity)</span>
<span id="cb3-3"></span>
<span id="cb3-4"></span>
<span id="cb3-5"><span class="co" style="color: #5E5E5E;"># create a list of vectors with your arguments</span></span>
<span id="cb3-6">my_args <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">list</span>(</span>
<span id="cb3-7">  <span class="fu" style="color: #4758AB;">c</span>(<span class="dv" style="color: #AD0000;">1</span>, <span class="dv" style="color: #AD0000;">2</span>, <span class="dv" style="color: #AD0000;">3</span>),</span>
<span id="cb3-8">  <span class="fu" style="color: #4758AB;">c</span>(<span class="dv" style="color: #AD0000;">4</span>, <span class="dv" style="color: #AD0000;">5</span>, <span class="dv" style="color: #AD0000;">6</span>),</span>
<span id="cb3-9">  <span class="fu" style="color: #4758AB;">c</span>(<span class="dv" style="color: #AD0000;">7</span>, <span class="dv" style="color: #AD0000;">8</span>, <span class="dv" style="color: #AD0000;">9</span>)</span>
<span id="cb3-10">)</span>
<span id="cb3-11"></span>
<span id="cb3-12"><span class="co" style="color: #5E5E5E;"># apply your function to each combination of arguments in parallel</span></span>
<span id="cb3-13">results <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">pmap</span>(my_args, my_function)</span>
<span id="cb3-14"></span>
<span id="cb3-15"><span class="co" style="color: #5E5E5E;"># print the results</span></span>
<span id="cb3-16"><span class="fu" style="color: #4758AB;">print</span>(results)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] 12

[[2]]
[1] 15

[[3]]
[1] 18</code></pre>
</div>
</div>
<p>Now lets see a couple more examples.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">argsl <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">list</span>(</span>
<span id="cb5-2">  <span class="fu" style="color: #4758AB;">c</span>(<span class="dv" style="color: #AD0000;">100</span>, <span class="dv" style="color: #AD0000;">100</span>, <span class="dv" style="color: #AD0000;">100</span>, <span class="dv" style="color: #AD0000;">100</span>), <span class="co" style="color: #5E5E5E;"># this is .n</span></span>
<span id="cb5-3">  <span class="fu" style="color: #4758AB;">c</span>(<span class="dv" style="color: #AD0000;">0</span>,<span class="dv" style="color: #AD0000;">1</span>,<span class="dv" style="color: #AD0000;">2</span>,<span class="dv" style="color: #AD0000;">3</span>),            <span class="co" style="color: #5E5E5E;"># this is .mean</span></span>
<span id="cb5-4">  <span class="fu" style="color: #4758AB;">c</span>(<span class="dv" style="color: #AD0000;">4</span>,<span class="dv" style="color: #AD0000;">3</span>,<span class="dv" style="color: #AD0000;">2</span>,<span class="dv" style="color: #AD0000;">1</span>),            <span class="co" style="color: #5E5E5E;"># this is .sd</span></span>
<span id="cb5-5">  <span class="fu" style="color: #4758AB;">c</span>(<span class="dv" style="color: #AD0000;">10</span>,<span class="dv" style="color: #AD0000;">10</span>,<span class="dv" style="color: #AD0000;">10</span>,<span class="dv" style="color: #AD0000;">10</span>)         <span class="co" style="color: #5E5E5E;"># this is .num_sims</span></span>
<span id="cb5-6">)</span>
<span id="cb5-7"></span>
<span id="cb5-8"><span class="fu" style="color: #4758AB;">pmap</span>(argsl, tidy_normal)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
# A tibble: 1,000 × 7
   sim_number     x      y    dx        dy     p      q
   &lt;fct&gt;      &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
 1 1              1  3.56  -15.0 0.0000353 0.814  3.56 
 2 1              2 -0.433 -14.6 0.0000679 0.457 -0.433
 3 1              3 -1.93  -14.3 0.000125  0.315 -1.93 
 4 1              4  1.68  -14.0 0.000219  0.663  1.68 
 5 1              5  4.18  -13.7 0.000369  0.852  4.18 
 6 1              6  0.805 -13.4 0.000596  0.580  0.805
 7 1              7  7.99  -13.1 0.000922  0.977  7.99 
 8 1              8 -1.61  -12.8 0.00137   0.344 -1.61 
 9 1              9  1.83  -12.5 0.00195   0.676  1.83 
10 1             10  6.66  -12.1 0.00267   0.952  6.66 
# … with 990 more rows

[[2]]
# A tibble: 1,000 × 7
   sim_number     x      y    dx        dy      p      q
   &lt;fct&gt;      &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
 1 1              1 -0.335 -9.02 0.0000814 0.328  -0.335
 2 1              2  2.00  -8.82 0.000162  0.630   2.00 
 3 1              3 -0.238 -8.62 0.000304  0.340  -0.238
 4 1              4  1.17  -8.41 0.000544  0.523   1.17 
 5 1              5  1.50  -8.21 0.000921  0.567   1.50 
 6 1              6  4.68  -8.01 0.00148   0.890   4.68 
 7 1              7  4.59  -7.81 0.00227   0.884   4.59 
 8 1              8 -1.18  -7.61 0.00331   0.233  -1.18 
 9 1              9  2.35  -7.40 0.00460   0.673   2.35 
10 1             10 -3.73  -7.20 0.00610   0.0574 -3.73 
# … with 990 more rows

[[3]]
# A tibble: 1,000 × 7
   sim_number     x      y    dx       dy     p      q
   &lt;fct&gt;      &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
 1 1              1  4.42  -3.98 0.000118 0.886  4.42 
 2 1              2  2.24  -3.86 0.000211 0.547  2.24 
 3 1              3 -0.207 -3.73 0.000369 0.135 -0.207
 4 1              4  3.32  -3.61 0.000622 0.745  3.32 
 5 1              5  0.999 -3.48 0.00101  0.308  0.999
 6 1              6  4.08  -3.36 0.00160  0.851  4.08 
 7 1              7  5.81  -3.23 0.00244  0.972  5.81 
 8 1              8  6.11  -3.11 0.00362  0.980  6.11 
 9 1              9  2.30  -2.98 0.00518  0.560  2.30 
10 1             10  0.231 -2.86 0.00718  0.188  0.231
# … with 990 more rows

[[4]]
# A tibble: 1,000 × 7
   sim_number     x     y      dx       dy       p     q
   &lt;fct&gt;      &lt;int&gt; &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;
 1 1              1 3.41  -0.635  0.000128 0.658   3.41 
 2 1              2 0.415 -0.557  0.000243 0.00487 0.415
 3 1              3 3.24  -0.479  0.000440 0.593   3.24 
 4 1              4 3.73  -0.401  0.000758 0.768   3.73 
 5 1              5 4.22  -0.324  0.00124  0.889   4.22 
 6 1              6 3.70  -0.246  0.00193  0.757   3.70 
 7 1              7 4.35  -0.168  0.00288  0.911   4.35 
 8 1              8 1.50  -0.0899 0.00408  0.0672  1.50 
 9 1              9 2.58  -0.0120 0.00551  0.336   2.58 
10 1             10 3.41   0.0658 0.00713  0.661   3.41 
# … with 990 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="fu" style="color: #4758AB;">pmap</span>(argsl, tidy_normal) <span class="sc" style="color: #5E5E5E;">|&gt;</span></span>
<span id="cb7-2">  <span class="fu" style="color: #4758AB;">map</span>(tidy_autoplot)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="https://www.spsanderson.com/steveondata/posts/rtip-2023-03-03/index_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[2]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="https://www.spsanderson.com/steveondata/posts/rtip-2023-03-03/index_files/figure-html/unnamed-chunk-4-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[3]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="https://www.spsanderson.com/steveondata/posts/rtip-2023-03-03/index_files/figure-html/unnamed-chunk-4-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[4]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="https://www.spsanderson.com/steveondata/posts/rtip-2023-03-03/index_files/figure-html/unnamed-chunk-4-4.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Voila!</p>


</section>

 ]]></description>
  <category>code</category>
  <category>rtip</category>
  <category>purrr</category>
  <guid>https://www.spsanderson.com/steveondata/posts/rtip-2023-03-03/index.html</guid>
  <pubDate>Fri, 03 Mar 2023 05:00:00 GMT</pubDate>
</item>
<item>
  <title>Forecasting Timeseries in a list with R</title>
  <dc:creator>Steven P. Sanderson II, MPH</dc:creator>
  <link>https://www.spsanderson.com/steveondata/posts/rtip-2023-03-02/index.html</link>
  <description><![CDATA[ 




<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>In this article, we will discuss how to perform an ARIMA forecast on nested data or data that is in a list using R programming language. This is a common scenario in which we have data stored in a list format, where each element of the list corresponds to a different time series. We will use the R programming language, specifically the “forecast” package, to perform the ARIMA forecast.</p>
<p>First, we will need to load the required packages and data. For this example, we will use the “AirPassengers” dataset which is included in the “datasets” package. This dataset contains the number of international airline passengers per month from 1949 to 1960. We will then create a list containing subsets of this data for each year.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;">library</span>(forecast)</span>
<span id="cb1-2"></span>
<span id="cb1-3">yearly_data <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">split</span>(AirPassengers, <span class="at" style="color: #657422;">f =</span> <span class="fu" style="color: #4758AB;">ceiling</span>(<span class="fu" style="color: #4758AB;">seq_along</span>(AirPassengers)<span class="sc" style="color: #5E5E5E;">/</span><span class="dv" style="color: #AD0000;">12</span>))</span>
<span id="cb1-4"></span>
<span id="cb1-5">yearly_data</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$`1`
 [1] 112 118 132 129 121 135 148 148 136 119 104 118

$`2`
 [1] 115 126 141 135 125 149 170 170 158 133 114 140

$`3`
 [1] 145 150 178 163 172 178 199 199 184 162 146 166

$`4`
 [1] 171 180 193 181 183 218 230 242 209 191 172 194

$`5`
 [1] 196 196 236 235 229 243 264 272 237 211 180 201

$`6`
 [1] 204 188 235 227 234 264 302 293 259 229 203 229

$`7`
 [1] 242 233 267 269 270 315 364 347 312 274 237 278

$`8`
 [1] 284 277 317 313 318 374 413 405 355 306 271 306

$`9`
 [1] 315 301 356 348 355 422 465 467 404 347 305 336

$`10`
 [1] 340 318 362 348 363 435 491 505 404 359 310 337

$`11`
 [1] 360 342 406 396 420 472 548 559 463 407 362 405

$`12`
 [1] 417 391 419 461 472 535 622 606 508 461 390 432</code></pre>
</div>
</div>
<p>In the above code, we use the “split” function to split the data into yearly subsets. The “f” parameter is used to specify the grouping variable which, in this case, is the sequence of numbers from 1 to the length of the dataset divided by 12, rounded up to the nearest integer. This creates a list of 12 elements, one for each year.</p>
</section>
<section id="function" class="level1">
<h1>Function</h1>
<p>Next, we will define a function that takes a single element of the list, fits an ARIMA model, and generates a forecast.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">arima_forecast <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="cf" style="color: #003B4F;">function</span>(x){</span>
<span id="cb3-2">  fit <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">auto.arima</span>(x)</span>
<span id="cb3-3">  <span class="fu" style="color: #4758AB;">forecast</span>(fit)</span>
<span id="cb3-4">}</span></code></pre></div>
</div>
<p>This function takes a single argument “x” which is one of the elements of the list. We use the “auto.arima” function from the “forecast” package to fit an ARIMA model to the data. The “forecast” function is then used to generate a forecast based on this model.</p>
</section>
<section id="example" class="level1">
<h1>Example</h1>
<p>We can now use the “lapply” function to apply this function to each element of the list.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">forecasts <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">lapply</span>(yearly_data, arima_forecast)</span></code></pre></div>
</div>
<p>The “lapply” function applies the “arima_forecast” function to each element of the “yearly_data” list and returns a list of forecasts.</p>
<p>Finally, we can extract and plot the forecasts for a specific year.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="fu" style="color: #4758AB;">plot</span>(forecasts[[<span class="dv" style="color: #AD0000;">5</span>]])</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://www.spsanderson.com/steveondata/posts/rtip-2023-03-02/index_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Now lets take a look at them all.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="fu" style="color: #4758AB;">par</span>(<span class="at" style="color: #657422;">mfrow =</span> <span class="fu" style="color: #4758AB;">c</span>(<span class="dv" style="color: #AD0000;">2</span>,<span class="dv" style="color: #AD0000;">1</span>))</span>
<span id="cb6-2"></span>
<span id="cb6-3">purrr<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">map</span>(forecasts, plot)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://www.spsanderson.com/steveondata/posts/rtip-2023-03-02/index_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="https://www.spsanderson.com/steveondata/posts/rtip-2023-03-02/index_files/figure-html/unnamed-chunk-5-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="https://www.spsanderson.com/steveondata/posts/rtip-2023-03-02/index_files/figure-html/unnamed-chunk-5-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="https://www.spsanderson.com/steveondata/posts/rtip-2023-03-02/index_files/figure-html/unnamed-chunk-5-4.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="https://www.spsanderson.com/steveondata/posts/rtip-2023-03-02/index_files/figure-html/unnamed-chunk-5-5.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="https://www.spsanderson.com/steveondata/posts/rtip-2023-03-02/index_files/figure-html/unnamed-chunk-5-6.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$`1`
$`1`$mean
Time Series:
Start = 13 
End = 22 
Frequency = 1 
 [1] 132.2237 126.4744 126.4744 126.4744 126.4744 126.4744 126.4744 126.4744
 [9] 126.4744 126.4744

$`1`$lower
Time Series:
Start = 13 
End = 22 
Frequency = 1 
        80%      95%
13 120.1608 113.7751
14 110.0828 101.4056
15 110.0828 101.4056
16 110.0828 101.4056
17 110.0828 101.4056
18 110.0828 101.4056
19 110.0828 101.4056
20 110.0828 101.4056
21 110.0828 101.4056
22 110.0828 101.4056

$`1`$upper
Time Series:
Start = 13 
End = 22 
Frequency = 1 
        80%      95%
13 144.2865 150.6722
14 142.8660 151.5432
15 142.8660 151.5432
16 142.8660 151.5432
17 142.8660 151.5432
18 142.8660 151.5432
19 142.8660 151.5432
20 142.8660 151.5432
21 142.8660 151.5432
22 142.8660 151.5432


$`2`
$`2`$mean
Time Series:
Start = 13 
End = 22 
Frequency = 1 
 [1] 153.8708 139.5919 139.5919 139.5919 139.5919 139.5919 139.5919 139.5919
 [9] 139.5919 139.5919

$`2`$lower
Time Series:
Start = 13 
End = 22 
Frequency = 1 
        80%      95%
13 136.3778 127.1175
14 115.8789 103.3260
15 115.8789 103.3260
16 115.8789 103.3260
17 115.8789 103.3260
18 115.8789 103.3260
19 115.8789 103.3260
20 115.8789 103.3260
21 115.8789 103.3260
22 115.8789 103.3260

$`2`$upper
Time Series:
Start = 13 
End = 22 
Frequency = 1 
        80%      95%
13 171.3638 180.6240
14 163.3048 175.8577
15 163.3048 175.8577
16 163.3048 175.8577
17 163.3048 175.8577
18 163.3048 175.8577
19 163.3048 175.8577
20 163.3048 175.8577
21 163.3048 175.8577
22 163.3048 175.8577


$`3`
$`3`$mean
Time Series:
Start = 13 
End = 22 
Frequency = 1 
 [1] 173.6413 170.0479 170.0479 170.0479 170.0479 170.0479 170.0479 170.0479
 [9] 170.0479 170.0479

$`3`$lower
Time Series:
Start = 13 
End = 22 
Frequency = 1 
        80%      95%
13 153.5404 142.8995
14 146.6452 134.2565
15 146.6452 134.2565
16 146.6452 134.2565
17 146.6452 134.2565
18 146.6452 134.2565
19 146.6452 134.2565
20 146.6452 134.2565
21 146.6452 134.2565
22 146.6452 134.2565

$`3`$upper
Time Series:
Start = 13 
End = 22 
Frequency = 1 
        80%      95%
13 193.7423 204.3831
14 193.4506 205.8393
15 193.4506 205.8393
16 193.4506 205.8393
17 193.4506 205.8393
18 193.4506 205.8393
19 193.4506 205.8393
20 193.4506 205.8393
21 193.4506 205.8393
22 193.4506 205.8393


$`4`
$`4`$mean
Time Series:
Start = 13 
End = 22 
Frequency = 1 
 [1] 194.0074 194.0119 194.0147 194.0164 194.0174 194.0180 194.0184 194.0186
 [9] 194.0187 194.0188

$`4`$lower
Time Series:
Start = 13 
End = 22 
Frequency = 1 
        80%      95%
13 169.7973 156.9812
14 165.6741 150.6730
15 164.2944 148.5614
16 163.8005 147.8051
17 163.6201 147.5288
18 163.5539 147.4272
19 163.5296 147.3898
20 163.5207 147.3761
21 163.5175 147.3711
22 163.5163 147.3692

$`4`$upper
Time Series:
Start = 13 
End = 22 
Frequency = 1 
        80%      95%
13 218.2176 231.0336
14 222.3497 237.3509
15 223.7350 239.4680
16 224.2322 240.2276
17 224.4146 240.5059
18 224.4821 240.6088
19 224.5071 240.6469
20 224.5165 240.6611
21 224.5200 240.6664
22 224.5213 240.6684


$`5`
$`5`$mean
Time Series:
Start = 13 
End = 22 
Frequency = 1 
 [1] 206.8929 210.7977 213.3851 215.0996 216.2356 216.9884 217.4872 217.8178
 [9] 218.0368 218.1819

$`5`$lower
Time Series:
Start = 13 
End = 22 
Frequency = 1 
        80%      95%
13 178.2600 163.1026
14 176.4492 158.2662
15 176.8082 157.4455
16 177.5860 157.7275
17 178.3181 158.2458
18 178.8949 158.7294
19 179.3167 159.1104
20 179.6134 159.3893
21 179.8176 159.5856
22 179.9562 159.7208

$`5`$upper
Time Series:
Start = 13 
End = 22 
Frequency = 1 
        80%      95%
13 235.5258 250.6831
14 245.1461 263.3291
15 249.9620 269.3246
16 252.6131 272.4716
17 254.1531 274.2255
18 255.0819 275.2475
19 255.6578 275.8641
20 256.0221 276.2462
21 256.2559 276.4879
22 256.4076 276.6430


$`6`
$`6`$mean
Time Series:
Start = 13 
End = 22 
Frequency = 1 
 [1] 245.0709 240.0400 240.0400 240.0400 240.0400 240.0400 240.0400 240.0400
 [9] 240.0400 240.0400

$`6`$lower
Time Series:
Start = 13 
End = 22 
Frequency = 1 
        80%      95%
13 212.6687 195.5160
14 196.9893 174.1996
15 196.9893 174.1996
16 196.9893 174.1996
17 196.9893 174.1996
18 196.9893 174.1996
19 196.9893 174.1996
20 196.9893 174.1996
21 196.9893 174.1996
22 196.9893 174.1996

$`6`$upper
Time Series:
Start = 13 
End = 22 
Frequency = 1 
        80%      95%
13 277.4731 294.6259
14 283.0907 305.8803
15 283.0907 305.8803
16 283.0907 305.8803
17 283.0907 305.8803
18 283.0907 305.8803
19 283.0907 305.8803
20 283.0907 305.8803
21 283.0907 305.8803
22 283.0907 305.8803


$`7`
$`7`$mean
Time Series:
Start = 13 
End = 22 
Frequency = 1 
 [1] 278.0001 278.0001 278.0002 278.0002 278.0002 278.0002 278.0002 278.0002
 [9] 278.0002 278.0002

$`7`$lower
Time Series:
Start = 13 
End = 22 
Frequency = 1 
        80%      95%
13 236.8903 215.1282
14 228.5879 202.4307
15 225.3145 197.4243
16 223.9224 195.2953
17 223.3147 194.3659
18 223.0466 193.9559
19 222.9278 193.7742
20 222.8751 193.6936
21 222.8516 193.6577
22 222.8412 193.6418

$`7`$upper
Time Series:
Start = 13 
End = 22 
Frequency = 1 
        80%      95%
13 319.1098 340.8720
14 327.4123 353.5695
15 330.6859 358.5760
16 332.0780 360.7051
17 332.6857 361.6345
18 332.9538 362.0445
19 333.0726 362.2262
20 333.1254 362.3069
21 333.1488 362.3427
22 333.1592 362.3587


$`8`
$`8`$mean
Time Series:
Start = 13 
End = 22 
Frequency = 1 
 [1] 349.0540 373.2678 369.7906 348.0549 325.4487 315.1915 319.8599 332.7645
 [9] 344.2812 348.1670

$`8`$lower
Time Series:
Start = 13 
End = 22 
Frequency = 1 
        80%      95%
13 315.6225 297.9249
14 322.1404 295.0752
15 314.7795 285.6584
16 292.8344 263.6024
17 266.5768 235.4118
18 252.9822 220.0505
19 257.0954 223.8699
20 269.7958 236.4622
21 280.1875 246.2583
22 283.2781 248.9280

$`8`$upper
Time Series:
Start = 13 
End = 22 
Frequency = 1 
        80%      95%
13 382.4855 400.1831
14 424.3952 451.4604
15 424.8018 453.9229
16 403.2754 432.5074
17 384.3206 415.4855
18 377.4009 410.3325
19 382.6243 415.8498
20 395.7332 429.0668
21 408.3750 442.3042
22 413.0559 447.4061


$`9`
$`9`$mean
Time Series:
Start = 13 
End = 22 
Frequency = 1 
 [1] 378.9729 406.5723 408.7509 392.6048 372.9147 361.5778 362.0569 370.2398
 [9] 379.1516 383.6927

$`9`$lower
Time Series:
Start = 13 
End = 22 
Frequency = 1 
        80%      95%
13 336.2126 313.5766
14 342.0963 307.9648
15 339.3660 302.6358
16 323.1265 286.3469
17 300.2319 261.7560
18 285.7363 245.5882
19 285.5516 245.0521
20 293.6654 253.1294
21 301.8675 260.9558
22 305.8147 264.5885

$`9`$upper
Time Series:
Start = 13 
End = 22 
Frequency = 1 
        80%      95%
13 421.7333 444.3692
14 471.0482 505.1797
15 478.1359 514.8660
16 462.0831 498.8627
17 445.5975 484.0734
18 437.4193 477.5674
19 438.5622 479.0617
20 446.8142 487.3503
21 456.4356 497.3473
22 461.5707 502.7968


$`10`
$`10`$mean
Time Series:
Start = 13 
End = 22 
Frequency = 1 
 [1] 391.9249 381.5489 381.5489 381.5489 381.5489 381.5489 381.5489 381.5489
 [9] 381.5489 381.5489

$`10`$lower
Time Series:
Start = 13 
End = 22 
Frequency = 1 
        80%      95%
13 331.8921 300.1126
14 304.6704 263.9734
15 304.6704 263.9734
16 304.6704 263.9734
17 304.6704 263.9734
18 304.6704 263.9734
19 304.6704 263.9734
20 304.6704 263.9734
21 304.6704 263.9734
22 304.6704 263.9734

$`10`$upper
Time Series:
Start = 13 
End = 22 
Frequency = 1 
        80%      95%
13 451.9577 483.7372
14 458.4274 499.1244
15 458.4274 499.1244
16 458.4274 499.1244
17 458.4274 499.1244
18 458.4274 499.1244
19 458.4274 499.1244
20 458.4274 499.1244
21 458.4274 499.1244
22 458.4274 499.1244


$`11`
$`11`$mean
Time Series:
Start = 13 
End = 22 
Frequency = 1 
 [1] 408.4203 410.7762 412.3990 413.5168 414.2868 414.8171 415.1824 415.4340
 [9] 415.6074 415.7268

$`11`$lower
Time Series:
Start = 13 
End = 22 
Frequency = 1 
        80%      95%
13 342.2241 307.1820
14 330.3960 287.8452
15 326.1006 280.4170
16 324.5481 277.4509
17 324.0788 276.3255
18 324.0270 275.9656
19 324.1175 275.9106
20 324.2390 275.9632
21 324.3506 276.0422
22 324.4407 276.1168

$`11`$upper
Time Series:
Start = 13 
End = 22 
Frequency = 1 
        80%      95%
13 474.6165 509.6586
14 491.1565 533.7072
15 498.6974 544.3810
16 502.4855 549.5827
17 504.4948 552.2480
18 505.6072 553.6686
19 506.2474 554.4543
20 506.6291 554.9049
21 506.8641 555.1726
22 507.0128 555.3367


$`12`
$`12`$mean
Time Series:
Start = 13 
End = 22 
Frequency = 1 
 [1] 502.9998 476.0531 476.0531 476.0531 476.0531 476.0531 476.0531 476.0531
 [9] 476.0531 476.0531

$`12`$lower
Time Series:
Start = 13 
End = 22 
Frequency = 1 
        80%      95%
13 437.2687 402.4728
14 387.1722 340.1214
15 387.1722 340.1214
16 387.1722 340.1214
17 387.1722 340.1214
18 387.1722 340.1214
19 387.1722 340.1214
20 387.1722 340.1214
21 387.1722 340.1214
22 387.1722 340.1214

$`12`$upper
Time Series:
Start = 13 
End = 22 
Frequency = 1 
        80%      95%
13 568.7308 603.5267
14 564.9341 611.9848
15 564.9341 611.9848
16 564.9341 611.9848
17 564.9341 611.9848
18 564.9341 611.9848
19 564.9341 611.9848
20 564.9341 611.9848
21 564.9341 611.9848
22 564.9341 611.9848</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="fu" style="color: #4758AB;">dev.off</span>()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>null device 
          1 </code></pre>
</div>
</div>
<p>Voila!</p>


</section>

 ]]></description>
  <category>code</category>
  <category>rtip</category>
  <category>purrr</category>
  <category>timeseries</category>
  <guid>https://www.spsanderson.com/steveondata/posts/rtip-2023-03-02/index.html</guid>
  <pubDate>Thu, 02 Mar 2023 05:00:00 GMT</pubDate>
</item>
<item>
  <title>Text Processing Made Easy with {healthyR}’s sql_left(), sql_mid(), and sql_right() Functions in R</title>
  <dc:creator>Steven P. Sanderson II, MPH</dc:creator>
  <link>https://www.spsanderson.com/steveondata/posts/rtip-2023-03-01/index.html</link>
  <description><![CDATA[ 




<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>Are you tired of manually manipulating text data in R? Do you find yourself frequently needing to extract substrings from long strings or to grab just the first few characters of a string? If so, you’re in luck! The <a href="https://www.spsanderson.com/healthyR/"><code>{healthyR}</code></a> library has three <a href="https://github.com/spsanderson/healthyR/blob/HEAD/R/sql_string_split.R">functions</a> that will make your text processing tasks much easier: <code>sql_left()</code>, <code>sql_mid()</code>, and <code>sql_right()</code>.</p>
</section>
<section id="function" class="level1">
<h1>Function</h1>
<p>Here are the function calls, I will also make the source avilable in the same cell so steal this code!!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;"># LEFT</span></span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;">sql_left</span>(<span class="st" style="color: #20794D;">"text"</span>, <span class="dv" style="color: #AD0000;">3</span>)</span>
<span id="cb1-3"></span>
<span id="cb1-4">sql_left <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="cf" style="color: #003B4F;">function</span>(.text, .num_char) {</span>
<span id="cb1-5">    base<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">substr</span>(.text, <span class="dv" style="color: #AD0000;">1</span>, .num_char)</span>
<span id="cb1-6">}</span>
<span id="cb1-7"></span>
<span id="cb1-8"><span class="co" style="color: #5E5E5E;"># MID</span></span>
<span id="cb1-9"><span class="fu" style="color: #4758AB;">sql_mid</span>(<span class="st" style="color: #20794D;">"this is some text"</span>, <span class="dv" style="color: #AD0000;">6</span>, <span class="dv" style="color: #AD0000;">2</span>)</span>
<span id="cb1-10"></span>
<span id="cb1-11">sql_mid <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="cf" style="color: #003B4F;">function</span>(.text, .start_num, .num_char) {</span>
<span id="cb1-12">    base<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">substr</span>(.text, .start_num, .start_num <span class="sc" style="color: #5E5E5E;">+</span> .num_char <span class="sc" style="color: #5E5E5E;">-</span> <span class="dv" style="color: #AD0000;">1</span>)</span>
<span id="cb1-13">}</span>
<span id="cb1-14"></span>
<span id="cb1-15"><span class="co" style="color: #5E5E5E;"># RIGHT</span></span>
<span id="cb1-16"><span class="fu" style="color: #4758AB;">sql_right</span>(<span class="st" style="color: #20794D;">"this is some more text"</span>, <span class="dv" style="color: #AD0000;">3</span>)</span>
<span id="cb1-17"></span>
<span id="cb1-18">sql_right <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="cf" style="color: #003B4F;">function</span>(.text, .num_char) {</span>
<span id="cb1-19">    base<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">substr</span>(.text, base<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">nchar</span>(.text) <span class="sc" style="color: #5E5E5E;">-</span> (.num_char<span class="dv" style="color: #AD0000;">-1</span>), base<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">nchar</span>(.text))</span>
<span id="cb1-20">}</span></code></pre></div>
</div>
</section>
<section id="example" class="level1">
<h1>Example</h1>
<p>Let’s start with sql_left(). This function is similar to the LEFT() function in SQL and Excel, in that it returns the specified number of characters from the beginning of a string. For example, if we have the string “Hello, world!”, and we want to grab just the first three characters, we can use sql_left() like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;">library</span>(healthyR)</span>
<span id="cb2-2"><span class="fu" style="color: #4758AB;">sql_left</span>(<span class="st" style="color: #20794D;">"Hello, world!"</span>, <span class="dv" style="color: #AD0000;">3</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Hel"</code></pre>
</div>
</div>
<p>This will return the string “Hel”.</p>
<p>Next up is sql_mid(). This function is similar to the SUBSTRING() and MID() functions in SQL and Excel, in that it returns a specified portion of a string. The first argument is the string itself, the second argument is the starting position of the substring, and the third argument is the length of the substring. For example, if we have the string “This is some text”, and we want to grab the two characters starting at position six, we can use sql_mid() like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="fu" style="color: #4758AB;">sql_mid</span>(<span class="st" style="color: #20794D;">"This is some text"</span>, <span class="dv" style="color: #AD0000;">6</span>, <span class="dv" style="color: #AD0000;">2</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "is"</code></pre>
</div>
</div>
<p>This will return the string “is”.</p>
<p>Finally, we have sql_right(). This function is similar to the RIGHT() function in SQL and Excel, in that it returns the specified number of characters from the end of a string. For example, if we have the string “This is some more text”, and we want to grab just the last three characters, we can use sql_right() like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="fu" style="color: #4758AB;">sql_right</span>(<span class="st" style="color: #20794D;">"This is some more text"</span>, <span class="dv" style="color: #AD0000;">3</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "ext"</code></pre>
</div>
</div>
<p>This will return the string “ext”.</p>
<p>These three functions can be extremely helpful when working with text data in R. They can save you time and effort, and make your code more concise and readable. So next time you find yourself needing to manipulate text data, remember to reach for sql_left(), sql_mid(), and sql_right()!</p>
<p>Voila!</p>


</section>

 ]]></description>
  <category>code</category>
  <category>rtip</category>
  <category>sql</category>
  <category>healthyr</category>
  <guid>https://www.spsanderson.com/steveondata/posts/rtip-2023-03-01/index.html</guid>
  <pubDate>Wed, 01 Mar 2023 05:00:00 GMT</pubDate>
</item>
<item>
  <title>Open a File Folder in R</title>
  <dc:creator>Steven P. Sanderson II, MPH</dc:creator>
  <link>https://www.spsanderson.com/steveondata/posts/rtip-2023-02-28/index.html</link>
  <description><![CDATA[ 




<section id="inroduction" class="level1">
<h1>Inroduction</h1>
<p>When writing a function, it is possible that you may want to ask the user where they want the data stored and if they want to open the file folder after the download has taken place. Well we can do this in R by invoking the <code>shell.exec()</code> command where we use a variable like <code>f_path</code> that is the path to the folder. We are going to go over a super simple example.</p>
</section>
<section id="function" class="level1">
<h1>Function</h1>
<p>Here is the function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;">shell.exec</span>(file)</span></code></pre></div>
</div>
<p>Here are the arguments.</p>
<ul>
<li><code>file</code> - file, directory or URL to be opened.</li>
</ul>
<p>Now let’s go over a simple example</p>
</section>
<section id="example" class="level1">
<h1>Example</h1>
<p>Here we go.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;"># Create a temporary file to store the zip file</span></span>
<span id="cb2-2">f_path <span class="ot" style="color: #003B4F;">&lt;-</span> utils<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">choose.dir</span>()</span>
<span id="cb2-3"></span>
<span id="cb2-4"><span class="co" style="color: #5E5E5E;"># Open file folder?</span></span>
<span id="cb2-5"><span class="cf" style="color: #003B4F;">if</span> (.open_folder){</span>
<span id="cb2-6">    <span class="fu" style="color: #4758AB;">shell.exec</span>(f_path)</span>
<span id="cb2-7">}</span></code></pre></div>
</div>
<p>If in our function creation we make a variable <code>.open_folder</code> and set it equal to <strong>TRUE</strong> then the if statement will execute and <code>shell.exec(f_path)</code> will open the specified path set by <code>utils::choose.dir()</code></p>
<p>Voila!</p>


</section>

 ]]></description>
  <category>code</category>
  <category>rtip</category>
  <category>shell</category>
  <guid>https://www.spsanderson.com/steveondata/posts/rtip-2023-02-28/index.html</guid>
  <pubDate>Tue, 28 Feb 2023 05:00:00 GMT</pubDate>
</item>
<item>
  <title>Quickly Generate Nested Time Series Models</title>
  <dc:creator>Steven P. Sanderson II, MPH</dc:creator>
  <link>https://www.spsanderson.com/steveondata/posts/rtip-2023-02-27/index.html</link>
  <description><![CDATA[ 




<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>There are many approaches to modeling time series data in R. One of the types of data that we might come across is a nested time series. This means the data is grouped simply by one or more keys. There are many methods in which to accomplish this task. This will be a quick post, but if you want a longer more detailed and quite frankly well written out one, then <a href="https://rpubs.com/alfado/purrr">this is a really good article</a></p>
</section>
<section id="exampmle" class="level1">
<h1>Exampmle</h1>
<p>Let’s just get to it with a very simple example, the motivation here isn’t to be all encompassing, but rather to just showcase it is possible for those who may not know it is.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;">library</span>(healthyR.data)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;">library</span>(dplyr)</span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;">library</span>(timetk)</span>
<span id="cb1-4"></span>
<span id="cb1-5">ts_tbl <span class="ot" style="color: #003B4F;">&lt;-</span> healthyR_data <span class="sc" style="color: #5E5E5E;">|&gt;</span> </span>
<span id="cb1-6">  <span class="fu" style="color: #4758AB;">filter</span>(ip_op_flag <span class="sc" style="color: #5E5E5E;">==</span> <span class="st" style="color: #20794D;">"I"</span>) <span class="sc" style="color: #5E5E5E;">|&gt;</span> </span>
<span id="cb1-7">  <span class="fu" style="color: #4758AB;">select</span>(visit_end_date_time, service_line, length_of_stay) <span class="sc" style="color: #5E5E5E;">|&gt;</span></span>
<span id="cb1-8">  <span class="fu" style="color: #4758AB;">mutate</span>(<span class="at" style="color: #657422;">visit_end_date_time =</span> <span class="fu" style="color: #4758AB;">as.Date</span>(visit_end_date_time)) <span class="sc" style="color: #5E5E5E;">|&gt;</span></span>
<span id="cb1-9">  <span class="fu" style="color: #4758AB;">group_by</span>(service_line) <span class="sc" style="color: #5E5E5E;">|&gt;</span></span>
<span id="cb1-10">  <span class="fu" style="color: #4758AB;">summarise_by_time</span>(</span>
<span id="cb1-11">    <span class="at" style="color: #657422;">.date_var =</span> visit_end_date_time,</span>
<span id="cb1-12">    <span class="at" style="color: #657422;">.by =</span> <span class="st" style="color: #20794D;">"month"</span>,</span>
<span id="cb1-13">    <span class="at" style="color: #657422;">los =</span> <span class="fu" style="color: #4758AB;">mean</span>(length_of_stay)</span>
<span id="cb1-14">  ) <span class="sc" style="color: #5E5E5E;">|&gt;</span></span>
<span id="cb1-15">  <span class="fu" style="color: #4758AB;">ungroup</span>()</span>
<span id="cb1-16"></span>
<span id="cb1-17"><span class="fu" style="color: #4758AB;">glimpse</span>(ts_tbl)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 2,148
Columns: 3
$ service_line        &lt;chr&gt; "Alcohol Abuse", "Alcohol Abuse", "Alcohol Abuse",…
$ visit_end_date_time &lt;date&gt; 2011-09-01, 2011-10-01, 2011-11-01, 2011-12-01, 2…
$ los                 &lt;dbl&gt; 3.666667, 3.181818, 4.380952, 3.464286, 3.677419, …</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;">library</span>(forecast)</span>
<span id="cb3-2"><span class="fu" style="color: #4758AB;">library</span>(broom)</span>
<span id="cb3-3"><span class="fu" style="color: #4758AB;">library</span>(tidyr)</span>
<span id="cb3-4"></span>
<span id="cb3-5">glanced_models <span class="ot" style="color: #003B4F;">&lt;-</span> ts_tbl <span class="sc" style="color: #5E5E5E;">|&gt;</span> </span>
<span id="cb3-6">  <span class="fu" style="color: #4758AB;">nest_by</span>(service_line) <span class="sc" style="color: #5E5E5E;">|&gt;</span> </span>
<span id="cb3-7">  <span class="fu" style="color: #4758AB;">mutate</span>(<span class="at" style="color: #657422;">AA =</span> <span class="fu" style="color: #4758AB;">list</span>(<span class="fu" style="color: #4758AB;">auto.arima</span>(data<span class="sc" style="color: #5E5E5E;">$</span>los))) <span class="sc" style="color: #5E5E5E;">|&gt;</span> </span>
<span id="cb3-8">  <span class="fu" style="color: #4758AB;">mutate</span>(<span class="at" style="color: #657422;">perf =</span> <span class="fu" style="color: #4758AB;">list</span>(<span class="fu" style="color: #4758AB;">glance</span>(AA))) <span class="sc" style="color: #5E5E5E;">|&gt;</span> </span>
<span id="cb3-9">  <span class="fu" style="color: #4758AB;">unnest</span>(<span class="at" style="color: #657422;">cols =</span> <span class="fu" style="color: #4758AB;">c</span>(perf))</span>
<span id="cb3-10"></span>
<span id="cb3-11">glanced_models <span class="sc" style="color: #5E5E5E;">|&gt;</span></span>
<span id="cb3-12">  <span class="fu" style="color: #4758AB;">select</span>(<span class="sc" style="color: #5E5E5E;">-</span>data)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 23 × 7
# Groups:   service_line [23]
   service_line                  AA         sigma logLik   AIC   BIC  nobs
   &lt;chr&gt;                         &lt;list&gt;     &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt;
 1 Alcohol Abuse                 &lt;fr_ARIMA&gt; 2.22  -241.   493.  506.   109
 2 Bariatric Surgery For Obesity &lt;fr_ARIMA&gt; 0.609  -80.1  168.  178.    88
 3 CHF                           &lt;fr_ARIMA&gt; 0.963 -152.   309.  314.   110
 4 COPD                          &lt;fr_ARIMA&gt; 0.987 -155.   315.  320.   110
 5 CVA                           &lt;fr_ARIMA&gt; 1.50  -201.   407.  412.   110
 6 Carotid Endarterectomy        &lt;fr_ARIMA&gt; 6.27  -166.   335.  339.    51
 7 Cellulitis                    &lt;fr_ARIMA&gt; 1.07  -163.   329.  335.   110
 8 Chest Pain                    &lt;fr_ARIMA&gt; 0.848 -139.   281.  287.   110
 9 GI Hemorrhage                 &lt;fr_ARIMA&gt; 1.21  -179.   361.  366.   111
10 Joint Replacement             &lt;fr_ARIMA&gt; 1.65  -196.   396.  401.   102
# … with 13 more rows</code></pre>
</div>
</div>
<p>Voila!</p>


</section>

 ]]></description>
  <category>code</category>
  <category>rtip</category>
  <category>timeseries</category>
  <category>autoarima</category>
  <guid>https://www.spsanderson.com/steveondata/posts/rtip-2023-02-27/index.html</guid>
  <pubDate>Mon, 27 Feb 2023 05:00:00 GMT</pubDate>
</item>
<item>
  <title>Data Preppers with {healthyR.ai}</title>
  <dc:creator>Steven P. Sanderson II, MPH</dc:creator>
  <link>https://www.spsanderson.com/steveondata/posts/rtip-2023-02-23/index.html</link>
  <description><![CDATA[ 




<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>There are many different methods that one can choose from in order to model their data. This brings with it a fundamental issue of how to prepare your data for the specified algorithm. With the [<code>{healthyR.ai}</code>] package there are many different functions in this family that will help solve this issue for some algorithms but of course not all, that would be utterly exhausting for me to do on my own.</p>
<p>In <strong>healthyR.ai</strong> I call these <em>Data Preppers</em> because they prep the data you supply to the format necessary for the algorithm to function properly.</p>
<p>Let’s take a look at one.</p>
</section>
<section id="function" class="level1">
<h1>Function</h1>
<p>Here we are going to use the <code>hai_c50_data_prepper(.data, .recipe_formula)</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;">hai_c50_data_prepper</span>(.data, .recipe_formula)</span></code></pre></div>
</div>
<p>Here are the simple arguments:</p>
<ul>
<li><code>.data</code> - The data that you are passing to the function. Can be any type of data that is accepted by the data parameter of the recipes::recipe() function.</li>
<li><code>.recipe_formula</code> - The formula that is going to be passed. For example if you are using the iris data then the formula would most likely be something like <code>Species ~</code> .</li>
</ul>
</section>
<section id="example" class="level1">
<h1>Example</h1>
<p>Here is a small example:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;">library</span>(healthyR.ai)</span>
<span id="cb2-2"></span>
<span id="cb2-3"><span class="fu" style="color: #4758AB;">hai_c50_data_prepper</span>(<span class="at" style="color: #657422;">.data =</span> Titanic, <span class="at" style="color: #657422;">.recipe_formula =</span> Survived <span class="sc" style="color: #5E5E5E;">~</span> .)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Recipe

Inputs:

      role #variables
   outcome          1
 predictor          4

Operations:

Factor variables from tidyselect::vars_select_helpers$where(is.charac...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">rec_obj <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">hai_c50_data_prepper</span>(Titanic, Survived <span class="sc" style="color: #5E5E5E;">~</span> .)</span>
<span id="cb4-2"><span class="fu" style="color: #4758AB;">get_juiced_data</span>(rec_obj)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 32 × 5
   Class Sex    Age       n Survived
   &lt;fct&gt; &lt;fct&gt;  &lt;fct&gt; &lt;dbl&gt; &lt;fct&gt;   
 1 1st   Male   Child     0 No      
 2 2nd   Male   Child     0 No      
 3 3rd   Male   Child    35 No      
 4 Crew  Male   Child     0 No      
 5 1st   Female Child     0 No      
 6 2nd   Female Child     0 No      
 7 3rd   Female Child    17 No      
 8 Crew  Female Child     0 No      
 9 1st   Male   Adult   118 No      
10 2nd   Male   Adult   154 No      
# … with 22 more rows</code></pre>
</div>
</div>
<p>Here are the rest of the data-preppers at the time of writing this article:</p>
<ul>
<li><a href="https://www.spsanderson.com/healthyR.ai/reference/hai_c50_data_prepper.html">hai_c50_data_prepper()</a></li>
<li><a href="https://www.spsanderson.com/healthyR.ai/reference/hai_cubist_data_prepper.html">hai_cubist_data_prepper()</a></li>
<li><a href="https://www.spsanderson.com/healthyR.ai/reference/hai_earth_data_prepper.html">hai_earth_data_prepper()</a></li>
<li><a href="https://www.spsanderson.com/healthyR.ai/reference/hai_glmnet_data_prepper.html">hai_glmnet_data_prepper()</a></li>
<li><a href="https://www.spsanderson.com/healthyR.ai/reference/hai_knn_data_prepper.html">hai_knn_data_prepper()</a></li>
<li><a href="https://www.spsanderson.com/healthyR.ai/reference/hai_ranger_data_prepper.html">hai_ranger_data_prepper()</a></li>
<li><a href="https://www.spsanderson.com/healthyR.ai/reference/hai_svm_poly_data_prepper.html">hai_svm_poly_data_prepper()</a></li>
<li><a href="https://www.spsanderson.com/healthyR.ai/reference/hai_svm_rbf_data_prepper.html">hai_svm_rbf_data_prepper()</a></li>
<li><a href="https://www.spsanderson.com/healthyR.ai/reference/hai_xgboost_data_prepper.html">hai_xgboost_data_prepper()</a></li>
</ul>
<p>Voila!</p>


</section>

 ]]></description>
  <category>code</category>
  <category>rtip</category>
  <category>healthyrai</category>
  <category>preprocessor</category>
  <guid>https://www.spsanderson.com/steveondata/posts/rtip-2023-02-23/index.html</guid>
  <pubDate>Fri, 24 Feb 2023 05:00:00 GMT</pubDate>
</item>
<item>
  <title>Calibrate and Plot a Time Series with {healthyR.ts}</title>
  <dc:creator>Steven P. Sanderson II, MPH</dc:creator>
  <link>https://www.spsanderson.com/steveondata/posts/rtip-2023-02-22/index.html</link>
  <description><![CDATA[ 




<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>In time series analysis, it is common to split the data into training and testing sets to evaluate the accuracy of a model. However, it is important to ensure that the model is calibrated on the training set before evaluating its performance on the testing set. The <a href="https://www.spsanderson.com/healthyR.ts/"><code>{healthyR.ts}</code></a> library provides a function called <a href="https://www.spsanderson.com/healthyR.ts/reference/calibrate_and_plot.html"><code>calibrate_and_plot()</code></a> that simplifies this process.</p>
</section>
<section id="function" class="level1">
<h1>Function</h1>
<p>Here is the full function call:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;">calibrate_and_plot</span>(</span>
<span id="cb1-2">  ...,</span>
<span id="cb1-3">  <span class="at" style="color: #657422;">.type =</span> <span class="st" style="color: #20794D;">"testing"</span>,</span>
<span id="cb1-4">  .splits_obj,</span>
<span id="cb1-5">  .data,</span>
<span id="cb1-6">  <span class="at" style="color: #657422;">.print_info =</span> <span class="cn" style="color: #8f5902;">TRUE</span>,</span>
<span id="cb1-7">  <span class="at" style="color: #657422;">.interactive =</span> <span class="cn" style="color: #8f5902;">FALSE</span></span>
<span id="cb1-8">)</span></code></pre></div>
</div>
<p>Here are the arguments to the parameters:</p>
<ul>
<li><code>...</code> - The workflow(s) you want to add to the function.</li>
<li><code>.type</code> - Either the training(splits) or testing(splits) data.</li>
<li><code>.splits_obj</code> - The splits object.</li>
<li><code>.data</code> - The full data set.</li>
<li><code>.print_info</code> - The default is TRUE and will print out the calibration accuracy tibble and the resulting plotly plot.</li>
<li><code>.interactive</code> - The defaults is FALSE. This controls if a forecast plot is interactive or not via plotly.</li>
</ul>
</section>
<section id="example" class="level1">
<h1>Example</h1>
<p>By default, <code>calibrate_and_plot()</code> will print out a calibration accuracy tibble and a resulting plotly plot. This can be controlled with the print_info argument, which is set to TRUE by default. If you prefer a non-interactive forecast plot, you can set the interactive argument to FALSE.</p>
<p>Here’s an example of how to use the <code>calibrate_and_plot()</code> function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;">library</span>(healthyR.ts)</span>
<span id="cb2-2"><span class="fu" style="color: #4758AB;">library</span>(dplyr)</span>
<span id="cb2-3"><span class="fu" style="color: #4758AB;">library</span>(timetk)</span>
<span id="cb2-4"><span class="fu" style="color: #4758AB;">library</span>(parsnip)</span>
<span id="cb2-5"><span class="fu" style="color: #4758AB;">library</span>(recipes)</span>
<span id="cb2-6"><span class="fu" style="color: #4758AB;">library</span>(workflows)</span>
<span id="cb2-7"><span class="fu" style="color: #4758AB;">library</span>(rsample)</span>
<span id="cb2-8"></span>
<span id="cb2-9"><span class="co" style="color: #5E5E5E;"># Get the Data</span></span>
<span id="cb2-10">data <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">ts_to_tbl</span>(AirPassengers) <span class="sc" style="color: #5E5E5E;">|&gt;</span></span>
<span id="cb2-11">  <span class="fu" style="color: #4758AB;">select</span>(<span class="sc" style="color: #5E5E5E;">-</span>index)</span>
<span id="cb2-12"></span>
<span id="cb2-13"><span class="co" style="color: #5E5E5E;"># Split the data into training and testing sets</span></span>
<span id="cb2-14">splits <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">time_series_split</span>(</span>
<span id="cb2-15">   data</span>
<span id="cb2-16">  , date_col</span>
<span id="cb2-17">  , <span class="at" style="color: #657422;">assess =</span> <span class="dv" style="color: #AD0000;">12</span></span>
<span id="cb2-18">  , <span class="at" style="color: #657422;">skip =</span> <span class="dv" style="color: #AD0000;">3</span></span>
<span id="cb2-19">  , <span class="at" style="color: #657422;">cumulative =</span> <span class="cn" style="color: #8f5902;">TRUE</span></span>
<span id="cb2-20">)</span>
<span id="cb2-21"></span>
<span id="cb2-22"><span class="co" style="color: #5E5E5E;"># Make the recipe object</span></span>
<span id="cb2-23">rec_obj <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">recipe</span>(value <span class="sc" style="color: #5E5E5E;">~</span> ., <span class="at" style="color: #657422;">data =</span> <span class="fu" style="color: #4758AB;">training</span>(splits))</span>
<span id="cb2-24"></span>
<span id="cb2-25"><span class="co" style="color: #5E5E5E;"># Make the Model</span></span>
<span id="cb2-26">model_spec <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">linear_reg</span>(</span>
<span id="cb2-27">   <span class="at" style="color: #657422;">mode =</span> <span class="st" style="color: #20794D;">"regression"</span></span>
<span id="cb2-28">   , <span class="at" style="color: #657422;">penalty =</span> <span class="fl" style="color: #AD0000;">0.5</span></span>
<span id="cb2-29">   , <span class="at" style="color: #657422;">mixture =</span> <span class="fl" style="color: #AD0000;">0.5</span></span>
<span id="cb2-30">) <span class="sc" style="color: #5E5E5E;">|&gt;</span></span>
<span id="cb2-31">   <span class="fu" style="color: #4758AB;">set_engine</span>(<span class="st" style="color: #20794D;">"lm"</span>)</span>
<span id="cb2-32"></span>
<span id="cb2-33"><span class="co" style="color: #5E5E5E;"># Make the workflow object</span></span>
<span id="cb2-34">wflw <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">workflow</span>() <span class="sc" style="color: #5E5E5E;">|&gt;</span></span>
<span id="cb2-35">   <span class="fu" style="color: #4758AB;">add_recipe</span>(rec_obj) <span class="sc" style="color: #5E5E5E;">|&gt;</span></span>
<span id="cb2-36">   <span class="fu" style="color: #4758AB;">add_model</span>(model_spec) <span class="sc" style="color: #5E5E5E;">|&gt;</span></span>
<span id="cb2-37">   <span class="fu" style="color: #4758AB;">fit</span>(<span class="fu" style="color: #4758AB;">training</span>(splits))</span>
<span id="cb2-38"></span>
<span id="cb2-39"><span class="co" style="color: #5E5E5E;"># Get our output</span></span>
<span id="cb2-40">output <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">calibrate_and_plot</span>(</span>
<span id="cb2-41">  wflw</span>
<span id="cb2-42">  , <span class="at" style="color: #657422;">.type =</span> <span class="st" style="color: #20794D;">"training"</span></span>
<span id="cb2-43">  , <span class="at" style="color: #657422;">.splits_obj =</span> splits</span>
<span id="cb2-44">  , <span class="at" style="color: #657422;">.data =</span> data</span>
<span id="cb2-45">  , <span class="at" style="color: #657422;">.print_info =</span> <span class="cn" style="color: #8f5902;">FALSE</span></span>
<span id="cb2-46">  , <span class="at" style="color: #657422;">.interactive =</span> <span class="cn" style="color: #8f5902;">TRUE</span></span>
<span id="cb2-47"> )</span></code></pre></div>
</div>
<p>The resulting output will include a calibration accuracy tibble and a plotly plot showing the original time series data along with the fitted values for the training set.</p>
<p>Let’s take a look at the output.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">output<span class="sc" style="color: #5E5E5E;">$</span>calibration_tbl</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Modeltime Table
# A tibble: 1 × 5
  .model_id .model     .model_desc .type .calibration_data 
      &lt;int&gt; &lt;list&gt;     &lt;chr&gt;       &lt;chr&gt; &lt;list&gt;            
1         1 &lt;workflow&gt; LM          Test  &lt;tibble [132 × 4]&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">output<span class="sc" style="color: #5E5E5E;">$</span>model_accuracy</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 9
  .model_id .model_desc .type   mae  mape  mase smape  rmse   rsq
      &lt;int&gt; &lt;chr&gt;       &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1         1 LM          Test   31.4  12.0  1.31  11.9  41.7 0.846</code></pre>
</div>
</div>
<p>And…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1">output<span class="sc" style="color: #5E5E5E;">$</span>plot</span></code></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-c3aa97bc77e43571b46c" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-c3aa97bc77e43571b46c">{"x":{"data":[{"x":["1949-01-01","1949-02-01","1949-03-01","1949-04-01","1949-05-01","1949-06-01","1949-07-01","1949-08-01","1949-09-01","1949-10-01","1949-11-01","1949-12-01","1950-01-01","1950-02-01","1950-03-01","1950-04-01","1950-05-01","1950-06-01","1950-07-01","1950-08-01","1950-09-01","1950-10-01","1950-11-01","1950-12-01","1951-01-01","1951-02-01","1951-03-01","1951-04-01","1951-05-01","1951-06-01","1951-07-01","1951-08-01","1951-09-01","1951-10-01","1951-11-01","1951-12-01","1952-01-01","1952-02-01","1952-03-01","1952-04-01","1952-05-01","1952-06-01","1952-07-01","1952-08-01","1952-09-01","1952-10-01","1952-11-01","1952-12-01","1953-01-01","1953-02-01","1953-03-01","1953-04-01","1953-05-01","1953-06-01","1953-07-01","1953-08-01","1953-09-01","1953-10-01","1953-11-01","1953-12-01","1954-01-01","1954-02-01","1954-03-01","1954-04-01","1954-05-01","1954-06-01","1954-07-01","1954-08-01","1954-09-01","1954-10-01","1954-11-01","1954-12-01","1955-01-01","1955-02-01","1955-03-01","1955-04-01","1955-05-01","1955-06-01","1955-07-01","1955-08-01","1955-09-01","1955-10-01","1955-11-01","1955-12-01","1956-01-01","1956-02-01","1956-03-01","1956-04-01","1956-05-01","1956-06-01","1956-07-01","1956-08-01","1956-09-01","1956-10-01","1956-11-01","1956-12-01","1957-01-01","1957-02-01","1957-03-01","1957-04-01","1957-05-01","1957-06-01","1957-07-01","1957-08-01","1957-09-01","1957-10-01","1957-11-01","1957-12-01","1958-01-01","1958-02-01","1958-03-01","1958-04-01","1958-05-01","1958-06-01","1958-07-01","1958-08-01","1958-09-01","1958-10-01","1958-11-01","1958-12-01","1959-01-01","1959-02-01","1959-03-01","1959-04-01","1959-05-01","1959-06-01","1959-07-01","1959-08-01","1959-09-01","1959-10-01","1959-11-01","1959-12-01","1960-01-01","1960-02-01","1960-03-01","1960-04-01","1960-05-01","1960-06-01","1960-07-01","1960-08-01","1960-09-01","1960-10-01","1960-11-01","1960-12-01"],"y":[112,118,132,129,121,135,148,148,136,119,104,118,115,126,141,135,125,149,170,170,158,133,114,140,145,150,178,163,172,178,199,199,184,162,146,166,171,180,193,181,183,218,230,242,209,191,172,194,196,196,236,235,229,243,264,272,237,211,180,201,204,188,235,227,234,264,302,293,259,229,203,229,242,233,267,269,270,315,364,347,312,274,237,278,284,277,317,313,318,374,413,405,355,306,271,306,315,301,356,348,355,422,465,467,404,347,305,336,340,318,362,348,363,435,491,505,404,359,310,337,360,342,406,396,420,472,548,559,463,407,362,405,417,391,419,461,472,535,622,606,508,461,390,432],"text":[".index: 1949-01-01<br />.value: 112.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1949-02-01<br />.value: 118.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1949-03-01<br />.value: 132.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1949-04-01<br />.value: 129.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1949-05-01<br />.value: 121.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1949-06-01<br />.value: 135.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1949-07-01<br />.value: 148.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1949-08-01<br />.value: 148.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1949-09-01<br />.value: 136.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1949-10-01<br />.value: 119.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1949-11-01<br />.value: 104.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1949-12-01<br />.value: 118.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1950-01-01<br />.value: 115.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1950-02-01<br />.value: 126.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1950-03-01<br />.value: 141.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1950-04-01<br />.value: 135.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1950-05-01<br />.value: 125.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1950-06-01<br />.value: 149.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1950-07-01<br />.value: 170.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1950-08-01<br />.value: 170.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1950-09-01<br />.value: 158.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1950-10-01<br />.value: 133.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1950-11-01<br />.value: 114.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1950-12-01<br />.value: 140.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1951-01-01<br />.value: 145.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1951-02-01<br />.value: 150.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1951-03-01<br />.value: 178.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1951-04-01<br />.value: 163.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1951-05-01<br />.value: 172.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1951-06-01<br />.value: 178.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1951-07-01<br />.value: 199.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1951-08-01<br />.value: 199.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1951-09-01<br />.value: 184.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1951-10-01<br />.value: 162.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1951-11-01<br />.value: 146.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1951-12-01<br />.value: 166.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1952-01-01<br />.value: 171.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1952-02-01<br />.value: 180.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1952-03-01<br />.value: 193.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1952-04-01<br />.value: 181.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1952-05-01<br />.value: 183.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1952-06-01<br />.value: 218.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1952-07-01<br />.value: 230.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1952-08-01<br />.value: 242.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1952-09-01<br />.value: 209.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1952-10-01<br />.value: 191.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1952-11-01<br />.value: 172.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1952-12-01<br />.value: 194.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1953-01-01<br />.value: 196.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1953-02-01<br />.value: 196.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1953-03-01<br />.value: 236.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1953-04-01<br />.value: 235.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1953-05-01<br />.value: 229.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1953-06-01<br />.value: 243.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1953-07-01<br />.value: 264.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1953-08-01<br />.value: 272.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1953-09-01<br />.value: 237.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1953-10-01<br />.value: 211.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1953-11-01<br />.value: 180.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1953-12-01<br />.value: 201.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1954-01-01<br />.value: 204.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1954-02-01<br />.value: 188.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1954-03-01<br />.value: 235.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1954-04-01<br />.value: 227.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1954-05-01<br />.value: 234.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1954-06-01<br />.value: 264.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1954-07-01<br />.value: 302.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1954-08-01<br />.value: 293.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1954-09-01<br />.value: 259.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1954-10-01<br />.value: 229.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1954-11-01<br />.value: 203.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1954-12-01<br />.value: 229.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1955-01-01<br />.value: 242.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1955-02-01<br />.value: 233.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1955-03-01<br />.value: 267.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1955-04-01<br />.value: 269.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1955-05-01<br />.value: 270.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1955-06-01<br />.value: 315.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1955-07-01<br />.value: 364.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1955-08-01<br />.value: 347.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1955-09-01<br />.value: 312.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1955-10-01<br />.value: 274.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1955-11-01<br />.value: 237.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1955-12-01<br />.value: 278.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1956-01-01<br />.value: 284.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1956-02-01<br />.value: 277.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1956-03-01<br />.value: 317.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1956-04-01<br />.value: 313.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1956-05-01<br />.value: 318.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1956-06-01<br />.value: 374.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1956-07-01<br />.value: 413.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1956-08-01<br />.value: 405.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1956-09-01<br />.value: 355.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1956-10-01<br />.value: 306.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1956-11-01<br />.value: 271.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1956-12-01<br />.value: 306.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1957-01-01<br />.value: 315.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1957-02-01<br />.value: 301.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1957-03-01<br />.value: 356.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1957-04-01<br />.value: 348.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1957-05-01<br />.value: 355.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1957-06-01<br />.value: 422.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1957-07-01<br />.value: 465.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1957-08-01<br />.value: 467.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1957-09-01<br />.value: 404.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1957-10-01<br />.value: 347.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1957-11-01<br />.value: 305.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1957-12-01<br />.value: 336.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1958-01-01<br />.value: 340.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1958-02-01<br />.value: 318.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1958-03-01<br />.value: 362.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1958-04-01<br />.value: 348.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1958-05-01<br />.value: 363.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1958-06-01<br />.value: 435.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1958-07-01<br />.value: 491.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1958-08-01<br />.value: 505.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1958-09-01<br />.value: 404.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1958-10-01<br />.value: 359.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1958-11-01<br />.value: 310.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1958-12-01<br />.value: 337.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1959-01-01<br />.value: 360.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1959-02-01<br />.value: 342.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1959-03-01<br />.value: 406.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1959-04-01<br />.value: 396.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1959-05-01<br />.value: 420.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1959-06-01<br />.value: 472.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1959-07-01<br />.value: 548.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1959-08-01<br />.value: 559.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1959-09-01<br />.value: 463.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1959-10-01<br />.value: 407.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1959-11-01<br />.value: 362.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1959-12-01<br />.value: 405.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1960-01-01<br />.value: 417.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1960-02-01<br />.value: 391.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1960-03-01<br />.value: 419.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1960-04-01<br />.value: 461.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1960-05-01<br />.value: 472.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1960-06-01<br />.value: 535.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1960-07-01<br />.value: 622.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1960-08-01<br />.value: 606.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1960-09-01<br />.value: 508.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1960-10-01<br />.value: 461.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1960-11-01<br />.value: 390.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL",".index: 1960-12-01<br />.value: 432.00000<br />.color_mod: ACTUAL<br />.color_mod: ACTUAL"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(44,62,80,1)","dash":"solid"},"hoveron":"points","name":"ACTUAL","legendgroup":"ACTUAL","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":["1949-01-01","1949-02-01","1949-03-01","1949-04-01","1949-05-01","1949-06-01","1949-07-01","1949-08-01","1949-09-01","1949-10-01","1949-11-01","1949-12-01","1950-01-01","1950-02-01","1950-03-01","1950-04-01","1950-05-01","1950-06-01","1950-07-01","1950-08-01","1950-09-01","1950-10-01","1950-11-01","1950-12-01","1951-01-01","1951-02-01","1951-03-01","1951-04-01","1951-05-01","1951-06-01","1951-07-01","1951-08-01","1951-09-01","1951-10-01","1951-11-01","1951-12-01","1952-01-01","1952-02-01","1952-03-01","1952-04-01","1952-05-01","1952-06-01","1952-07-01","1952-08-01","1952-09-01","1952-10-01","1952-11-01","1952-12-01","1953-01-01","1953-02-01","1953-03-01","1953-04-01","1953-05-01","1953-06-01","1953-07-01","1953-08-01","1953-09-01","1953-10-01","1953-11-01","1953-12-01","1954-01-01","1954-02-01","1954-03-01","1954-04-01","1954-05-01","1954-06-01","1954-07-01","1954-08-01","1954-09-01","1954-10-01","1954-11-01","1954-12-01","1955-01-01","1955-02-01","1955-03-01","1955-04-01","1955-05-01","1955-06-01","1955-07-01","1955-08-01","1955-09-01","1955-10-01","1955-11-01","1955-12-01","1956-01-01","1956-02-01","1956-03-01","1956-04-01","1956-05-01","1956-06-01","1956-07-01","1956-08-01","1956-09-01","1956-10-01","1956-11-01","1956-12-01","1957-01-01","1957-02-01","1957-03-01","1957-04-01","1957-05-01","1957-06-01","1957-07-01","1957-08-01","1957-09-01","1957-10-01","1957-11-01","1957-12-01","1958-01-01","1958-02-01","1958-03-01","1958-04-01","1958-05-01","1958-06-01","1958-07-01","1958-08-01","1958-09-01","1958-10-01","1958-11-01","1958-12-01","1959-01-01","1959-02-01","1959-03-01","1959-04-01","1959-05-01","1959-06-01","1959-07-01","1959-08-01","1959-09-01","1959-10-01","1959-11-01","1959-12-01"],"y":[94.6717960311422,97.2827276428212,99.6409884533699,102.251920065049,104.778628076351,107.38955968803,109.916267699332,112.527199311011,115.13813092269,117.664838933992,120.275770545671,122.802478556973,125.413410168652,128.024341780331,130.38260259088,132.993534202559,135.520242213861,138.13117382554,140.657881836842,143.268813448521,145.8797450602,148.406453071502,151.017384683181,153.544092694483,156.155024306162,158.765955917841,161.12421672839,163.735148340068,166.261856351371,168.87278796305,171.399495974352,174.010427586031,176.62135919771,179.148067209012,181.758998820691,184.285706831993,186.896638443672,189.507570055351,191.950054466276,194.560986077955,197.087694089257,199.698625700936,202.225333712238,204.836265323917,207.447196935596,209.973904946898,212.584836558577,215.111544569879,217.722476181558,220.333407793237,222.691668603786,225.302600215465,227.829308226767,230.440239838446,232.966947849748,235.577879461427,238.188811073106,240.715519084408,243.326450696087,245.853158707389,248.464090319068,251.075021930747,253.433282741296,256.044214352975,258.570922364277,261.181853975956,263.708561987258,266.319493598937,268.930425210616,271.457133221918,274.068064833597,276.594772844899,279.205704456578,281.816636068257,284.174896878806,286.785828490485,289.312536501787,291.923468113466,294.450176124768,297.061107736447,299.672039348126,302.198747359428,304.809678971107,307.336386982409,309.947318594088,312.558250205767,315.000734616692,317.611666228371,320.138374239673,322.749305851352,325.276013862655,327.886945474333,330.497877086012,333.024585097315,335.635516708993,338.162224720296,340.773156331975,343.384087943653,345.742348754202,348.353280365881,350.879988377183,353.490919988862,356.017628000164,358.628559611843,361.239491223522,363.766199234824,366.377130846503,368.903838857805,371.514770469484,374.125702081163,376.483962891712,379.094894503391,381.621602514693,384.232534126372,386.759242137674,389.370173749353,391.981105361032,394.507813372334,397.118744984013,399.645452995315,402.256384606994,404.867316218673,407.225577029222,409.836508640901,412.363216652203,414.974148263882,417.500856275184,420.111787886863,422.722719498542,425.249427509844,427.860359121523,430.387067132825],"text":[".index: 1949-01-01<br />.value:  94.67180<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1949-02-01<br />.value:  97.28273<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1949-03-01<br />.value:  99.64099<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1949-04-01<br />.value: 102.25192<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1949-05-01<br />.value: 104.77863<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1949-06-01<br />.value: 107.38956<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1949-07-01<br />.value: 109.91627<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1949-08-01<br />.value: 112.52720<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1949-09-01<br />.value: 115.13813<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1949-10-01<br />.value: 117.66484<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1949-11-01<br />.value: 120.27577<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1949-12-01<br />.value: 122.80248<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1950-01-01<br />.value: 125.41341<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1950-02-01<br />.value: 128.02434<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1950-03-01<br />.value: 130.38260<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1950-04-01<br />.value: 132.99353<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1950-05-01<br />.value: 135.52024<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1950-06-01<br />.value: 138.13117<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1950-07-01<br />.value: 140.65788<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1950-08-01<br />.value: 143.26881<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1950-09-01<br />.value: 145.87975<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1950-10-01<br />.value: 148.40645<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1950-11-01<br />.value: 151.01738<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1950-12-01<br />.value: 153.54409<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1951-01-01<br />.value: 156.15502<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1951-02-01<br />.value: 158.76596<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1951-03-01<br />.value: 161.12422<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1951-04-01<br />.value: 163.73515<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1951-05-01<br />.value: 166.26186<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1951-06-01<br />.value: 168.87279<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1951-07-01<br />.value: 171.39950<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1951-08-01<br />.value: 174.01043<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1951-09-01<br />.value: 176.62136<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1951-10-01<br />.value: 179.14807<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1951-11-01<br />.value: 181.75900<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1951-12-01<br />.value: 184.28571<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1952-01-01<br />.value: 186.89664<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1952-02-01<br />.value: 189.50757<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1952-03-01<br />.value: 191.95005<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1952-04-01<br />.value: 194.56099<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1952-05-01<br />.value: 197.08769<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1952-06-01<br />.value: 199.69863<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1952-07-01<br />.value: 202.22533<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1952-08-01<br />.value: 204.83627<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1952-09-01<br />.value: 207.44720<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1952-10-01<br />.value: 209.97390<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1952-11-01<br />.value: 212.58484<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1952-12-01<br />.value: 215.11154<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1953-01-01<br />.value: 217.72248<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1953-02-01<br />.value: 220.33341<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1953-03-01<br />.value: 222.69167<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1953-04-01<br />.value: 225.30260<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1953-05-01<br />.value: 227.82931<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1953-06-01<br />.value: 230.44024<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1953-07-01<br />.value: 232.96695<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1953-08-01<br />.value: 235.57788<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1953-09-01<br />.value: 238.18881<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1953-10-01<br />.value: 240.71552<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1953-11-01<br />.value: 243.32645<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1953-12-01<br />.value: 245.85316<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1954-01-01<br />.value: 248.46409<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1954-02-01<br />.value: 251.07502<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1954-03-01<br />.value: 253.43328<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1954-04-01<br />.value: 256.04421<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1954-05-01<br />.value: 258.57092<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1954-06-01<br />.value: 261.18185<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1954-07-01<br />.value: 263.70856<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1954-08-01<br />.value: 266.31949<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1954-09-01<br />.value: 268.93043<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1954-10-01<br />.value: 271.45713<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1954-11-01<br />.value: 274.06806<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1954-12-01<br />.value: 276.59477<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1955-01-01<br />.value: 279.20570<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1955-02-01<br />.value: 281.81664<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1955-03-01<br />.value: 284.17490<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1955-04-01<br />.value: 286.78583<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1955-05-01<br />.value: 289.31254<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1955-06-01<br />.value: 291.92347<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1955-07-01<br />.value: 294.45018<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1955-08-01<br />.value: 297.06111<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1955-09-01<br />.value: 299.67204<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1955-10-01<br />.value: 302.19875<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1955-11-01<br />.value: 304.80968<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1955-12-01<br />.value: 307.33639<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1956-01-01<br />.value: 309.94732<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1956-02-01<br />.value: 312.55825<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1956-03-01<br />.value: 315.00073<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1956-04-01<br />.value: 317.61167<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1956-05-01<br />.value: 320.13837<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1956-06-01<br />.value: 322.74931<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1956-07-01<br />.value: 325.27601<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1956-08-01<br />.value: 327.88695<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1956-09-01<br />.value: 330.49788<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1956-10-01<br />.value: 333.02459<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1956-11-01<br />.value: 335.63552<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1956-12-01<br />.value: 338.16222<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1957-01-01<br />.value: 340.77316<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1957-02-01<br />.value: 343.38409<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1957-03-01<br />.value: 345.74235<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1957-04-01<br />.value: 348.35328<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1957-05-01<br />.value: 350.87999<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1957-06-01<br />.value: 353.49092<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1957-07-01<br />.value: 356.01763<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1957-08-01<br />.value: 358.62856<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1957-09-01<br />.value: 361.23949<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1957-10-01<br />.value: 363.76620<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1957-11-01<br />.value: 366.37713<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1957-12-01<br />.value: 368.90384<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1958-01-01<br />.value: 371.51477<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1958-02-01<br />.value: 374.12570<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1958-03-01<br />.value: 376.48396<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1958-04-01<br />.value: 379.09489<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1958-05-01<br />.value: 381.62160<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1958-06-01<br />.value: 384.23253<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1958-07-01<br />.value: 386.75924<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1958-08-01<br />.value: 389.37017<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1958-09-01<br />.value: 391.98111<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1958-10-01<br />.value: 394.50781<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1958-11-01<br />.value: 397.11874<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1958-12-01<br />.value: 399.64545<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1959-01-01<br />.value: 402.25638<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1959-02-01<br />.value: 404.86732<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1959-03-01<br />.value: 407.22558<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1959-04-01<br />.value: 409.83651<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1959-05-01<br />.value: 412.36322<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1959-06-01<br />.value: 414.97415<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1959-07-01<br />.value: 417.50086<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1959-08-01<br />.value: 420.11179<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1959-09-01<br />.value: 422.72272<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1959-10-01<br />.value: 425.24943<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1959-11-01<br />.value: 427.86036<br />.color_mod: 1_LM<br />.color_mod: 1_LM",".index: 1959-12-01<br />.value: 430.38707<br />.color_mod: 1_LM<br />.color_mod: 1_LM"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(227,26,28,1)","dash":"solid"},"hoveron":"points","name":"1_LM","legendgroup":"1_LM","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":43.7625570776256,"r":7.30593607305936,"b":25.5707762557078,"l":28.4931506849315},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(44,62,80,1)","family":"","size":14.6118721461187},"title":{"text":"Forecast Plot","font":{"color":"rgba(44,62,80,1)","family":"","size":17.5342465753425},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"date","autorange":true,"range":["1948-05-28","1961-07-06"],"tickmode":"auto","ticktext":["1950","1955","1960"],"tickvals":[-7305,-5479,-3653],"categoryorder":"array","categoryarray":["1950","1955","1960"],"nticks":null,"ticks":"outside","tickcolor":"rgba(204,204,204,1)","ticklen":3.65296803652968,"tickwidth":0.22139200221392,"showticklabels":true,"tickfont":{"color":"rgba(44,62,80,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(204,204,204,1)","gridwidth":0.22139200221392,"zeroline":false,"anchor":"y","title":{"text":"","font":{"color":"rgba(44,62,80,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":true,"range":[68.3053858326993,648.366410198443],"tickmode":"auto","ticktext":["200","400","600"],"tickvals":[200,400,600],"categoryorder":"array","categoryarray":["200","400","600"],"nticks":null,"ticks":"outside","tickcolor":"rgba(204,204,204,1)","ticklen":3.65296803652968,"tickwidth":0.22139200221392,"showticklabels":true,"tickfont":{"color":"rgba(44,62,80,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(204,204,204,1)","gridwidth":0.22139200221392,"zeroline":false,"anchor":"x","title":{"text":"","font":{"color":"rgba(44,62,80,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(44,62,80,1)","width":0.33208800332088,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(44,62,80,1)","family":"","size":11.689497716895},"title":{"text":"Legend","font":{"color":"rgba(44,62,80,1)","family":"","size":14.6118721461187}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"5d085039619e":{"x":{},"y":{},"colour":{},"type":"scatter"}},"cur_data":"5d085039619e","visdat":{"5d085039619e":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Overall, the calibrate_and_plot() function is a useful tool for simplifying the process of calibrating time series models on a training set and evaluating their performance on a testing set.</p>
<p>Voila!</p>


</section>

 ]]></description>
  <category>code</category>
  <category>rtip</category>
  <category>healthyrts</category>
  <category>timeseries</category>
  <guid>https://www.spsanderson.com/steveondata/posts/rtip-2023-02-22/index.html</guid>
  <pubDate>Wed, 22 Feb 2023 05:00:00 GMT</pubDate>
</item>
<item>
  <title>Converting a {tidyAML} tibble to a {workflowsets}</title>
  <dc:creator>Steven P. Sanderson II, MPH</dc:creator>
  <link>https://www.spsanderson.com/steveondata/posts/rtip-2023-02-17/index.html</link>
  <description><![CDATA[ 




<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>The <a href="https://www.spsanderson.com/tidyAML/"><code>{tidyAML}</code></a> package is an R package that provides a set of tools for building regression/classification models on the fly with minimal input required. In this post we will discuss the <a href="https://www.spsanderson.com/tidyAML/reference/create_workflow_set.html"><code>create_workflow_set()</code></a> function.</p>
<p>The <code>create_workflow_set</code> function is a function in the <code>tidyAML</code> package that is used to create a <code>workflowset</code> object from the <code>workflowsets</code> package. A workflow is a sequence of tasks that can be executed in a specific order, and is often used in data analysis and machine learning to automate data processing and model fitting. The <code>create_workflow_set</code> function takes as input a YAML specification of a set of workflows, and returns a list of workflow objects that can be executed using the <code>tidymodels</code> package and its associated packages.</p>
<p>The <code>create_workflow_set</code> function is particularly useful when working with the <code>tidymodels</code> package and the <code>parsnip</code> framework. The <code>tidymodels</code> package is a collection of packages for modeling and machine learning in R that provides a consistent interface for building, tuning, and evaluating machine learning models. The parsnip package is part of the <code>tidymodels</code> ecosystem and provides a way to specify a wide range of models in a consistent manner.</p>
<section id="using-the-create_workflow_set-function-with-tidymodels-and-parsnip" class="level2">
<h2 class="anchored" data-anchor-id="using-the-create_workflow_set-function-with-tidymodels-and-parsnip">Using the create_workflow_set function with tidymodels and parsnip</h2>
<p>To use the <code>create_workflow_set</code> function with <code>tidymodels</code> and<code>parsnip</code>, you will need to provide a recipe or recipes as a list to the <strong>.recipe_list</strong> parameter and a model_spec tibble that you would get from something like <code>fast_regression_parsnip_spec_tbl()</code>, other classes will be supported in the future.</p>
<p>The reason this was done was because I did not want to force users to remain inside of <code>tidyAML</code> perhaps and most likely there are other packages out there that are more suited to an end users specific problem at hand.</p>
</section>
</section>
<section id="function" class="level1">
<h1>Function</h1>
<p>Let’s take a look at the function and it’s arguments.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;">create_workflow_set</span>(</span>
<span id="cb1-2">  <span class="at" style="color: #657422;">.model_tbl =</span> <span class="cn" style="color: #8f5902;">NULL</span>, </span>
<span id="cb1-3">  <span class="at" style="color: #657422;">.recipe_list =</span> <span class="fu" style="color: #4758AB;">list</span>(), </span>
<span id="cb1-4">  <span class="at" style="color: #657422;">.cross =</span> <span class="cn" style="color: #8f5902;">TRUE</span></span>
<span id="cb1-5">)</span></code></pre></div>
</div>
<ul>
<li><code>.model_tbl</code> - The model table that is generated from a function like <code>fast_regression_parsnip_spec_tbl()</code>. The model spec column will be grabbed automatically as the class of the object must be <code>tidyaml_base_tbl</code></li>
<li><code>.recipe_list</code> - Provide a list of recipes here that will get added to the workflow set object.</li>
<li><code>.cross</code> - The default is TRUE, can be set to FALSE. This is passed to the cross parameter as an argument to the workflow_set() function.</li>
</ul>
</section>
<section id="example" class="level1">
<h1>Example</h1>
<p>Here is a simple example. Remember you really only want to use this if you have a model_spec tibble not a tibble with workflows that have already been fit.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;">library</span>(tidyAML)</span>
<span id="cb2-2"><span class="fu" style="color: #4758AB;">library</span>(recipes)</span>
<span id="cb2-3"></span>
<span id="cb2-4">rec_obj <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">recipe</span>(mpg <span class="sc" style="color: #5E5E5E;">~</span> ., <span class="at" style="color: #657422;">data =</span> mtcars)</span>
<span id="cb2-5">spec_tbl <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">fast_regression_parsnip_spec_tbl</span>(</span>
<span id="cb2-6">  <span class="at" style="color: #657422;">.parsnip_fns =</span> <span class="st" style="color: #20794D;">"linear_reg"</span>,</span>
<span id="cb2-7">  <span class="at" style="color: #657422;">.parsnip_eng =</span> <span class="fu" style="color: #4758AB;">c</span>(<span class="st" style="color: #20794D;">"lm"</span>,<span class="st" style="color: #20794D;">"glm"</span>)</span>
<span id="cb2-8">)</span>
<span id="cb2-9"></span>
<span id="cb2-10">wfs_tbl <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">create_workflow_set</span>(</span>
<span id="cb2-11">  spec_tbl,</span>
<span id="cb2-12">  <span class="fu" style="color: #4758AB;">list</span>(rec_obj)</span>
<span id="cb2-13">)</span></code></pre></div>
</div>
<p>Now let’s inspect.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;">library</span>(dplyr)</span>
<span id="cb3-2"></span>
<span id="cb3-3">wfs_tbl <span class="sc" style="color: #5E5E5E;">|&gt;</span></span>
<span id="cb3-4">  <span class="fu" style="color: #4758AB;">slice</span>(<span class="dv" style="color: #AD0000;">1</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A workflow set/tibble: 1 × 4
  wflow_id            info             option    result    
  &lt;chr&gt;               &lt;list&gt;           &lt;list&gt;    &lt;list&gt;    
1 recipe_linear_reg_1 &lt;tibble [1 × 4]&gt; &lt;opts[0]&gt; &lt;list [0]&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="fu" style="color: #4758AB;">class</span>(wfs_tbl)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "workflow_set" "tbl_df"       "tbl"          "data.frame"  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1">wfs_tbl<span class="sc" style="color: #5E5E5E;">$</span>info</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
# A tibble: 1 × 4
  workflow   preproc model      comment
  &lt;list&gt;     &lt;chr&gt;   &lt;chr&gt;      &lt;chr&gt;  
1 &lt;workflow&gt; recipe  linear_reg ""     

[[2]]
# A tibble: 1 × 4
  workflow   preproc model      comment
  &lt;list&gt;     &lt;chr&gt;   &lt;chr&gt;      &lt;chr&gt;  
1 &lt;workflow&gt; recipe  linear_reg ""     </code></pre>
</div>
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1">wfs_tbl<span class="sc" style="color: #5E5E5E;">$</span>info[[<span class="dv" style="color: #AD0000;">1</span>]]<span class="sc" style="color: #5E5E5E;">$</span>workflow[[<span class="dv" style="color: #AD0000;">1</span>]]</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>══ Workflow ════════════════════════════════════════════════════════════════════
Preprocessor: Recipe
Model: linear_reg()

── Preprocessor ────────────────────────────────────────────────────────────────
0 Recipe Steps

── Model ───────────────────────────────────────────────────────────────────────
Linear Regression Model Specification (regression)

Computational engine: lm </code></pre>
</div>
</div>
<p>Voila!</p>


</section>

 ]]></description>
  <category>code</category>
  <category>rtip</category>
  <category>tidyaml</category>
  <category>workflowsets</category>
  <category>tidymodels</category>
  <guid>https://www.spsanderson.com/steveondata/posts/rtip-2023-02-17/index.html</guid>
  <pubDate>Fri, 17 Feb 2023 05:00:00 GMT</pubDate>
</item>
<item>
  <title>Officially on CRAN {tidyAML}</title>
  <dc:creator>Steven P. Sanderson II, MPH</dc:creator>
  <link>https://www.spsanderson.com/steveondata/posts/rtip-2023-02-16/index.html</link>
  <description><![CDATA[ 




<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>I’m excited to announce that the R package {tidyAML} is now officially available on CRAN! This package is designed to make it easy for users to perform automated machine learning (AutoML) using the tidymodels ecosystem. With a simple and intuitive interface, tidyAML allows users to quickly generate high-quality machine learning models without worrying about the underlying details.</p>
<p>One of the key features of tidyAML is its ability to generate regression models on the fly, without the need to build a full specification or tune hyper-parameters. This makes it ideal for users who want to quickly build a machine learning model without spending a lot of time on the setup process.</p>
<p>tidyAML is also designed to be easy to use, with a set of functions that are straightforward and can generate many models and predictions at once. And because it’s built on top of the tidymodels ecosystem, users don’t need to worry about setting up additional packages or dependencies.</p>
<p>We’re also happy to announce that tidyAML will be added to the R package {healthyverse} and pushed to CRAN this week. This means that users who install {healthyverse} will automatically get access to tidyAML, as well as other popular packages like ggplot2, dplyr, and tidyr.</p>
<p>Whether you’re a beginner or an experienced machine learning practitioner, tidyAML is a powerful tool that can help you quickly generate high-quality models with minimal setup. We hope you’ll give it a try and let us know what you think!</p>


</section>

 ]]></description>
  <category>code</category>
  <category>rtip</category>
  <category>tidyaml</category>
  <guid>https://www.spsanderson.com/steveondata/posts/rtip-2023-02-16/index.html</guid>
  <pubDate>Thu, 16 Feb 2023 05:00:00 GMT</pubDate>
</item>
<item>
  <title>Moving Average Plots with {healthyR.ts}</title>
  <dc:creator>Steven P. Sanderson II, MPH</dc:creator>
  <link>https://www.spsanderson.com/steveondata/posts/rtip-2023-02-15/index.html</link>
  <description><![CDATA[ 




<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>Are you interested in visualizing time series data in a clear and concise way? The R package <a href="https://www.spsanderson.com/healthyR.ts/"><code>{healthyR.ts}</code></a> provides a variety of tools for time series analysis and visualization, including the <strong>ts_ma_plot()</strong> function.</p>
<p>The <a href="https://www.spsanderson.com/healthyR.ts/reference/ts_ma_plot.html"><code>ts_ma_plot()</code></a> function is designed to help you quickly and easily create moving average plots for time series data. This function takes several arguments, including the data you want to visualize, the date column from your data, the value column from your data, and the frequency of the aggregation.</p>
<p>One of the great features of ts_ma_plot() is that it can handle both weekly and monthly data frequencies, making it a flexible tool for analyzing a variety of time series data. If you pass in a frequency other than “weekly” or “monthly”, the function will default to weekly, so it’s important to ensure that your data is aggregated at the appropriate frequency.</p>
<p>With ts_ma_plot(), you can create a variety of plots to help you better understand your time series data. The function allows you to add up to three different titles to your plot, helping you to organize and communicate your findings effectively. The main_title argument sets the title for the main plot, while the secondary_title and tertiary_title arguments set the titles for the second and third plots, respectively.</p>
<p>If you’re interested in using ts_ma_plot() for your own time series data, you’ll first need to preprocess your data so that it’s in the appropriate format for this function. Once you’ve done that, though, ts_ma_plot() can help you to quickly identify trends and patterns in your data that might not be immediately apparent from a raw data set.</p>
<p>In summary, ts_ma_plot() is a powerful and flexible tool for visualizing time series data. Whether you’re working with weekly or monthly data, this function can help you to quickly and easily create moving average plots that can help you to better understand your data. If you’re interested in time series analysis, be sure to check out {healthyR.ts} and give ts_ma_plot() a try!</p>
</section>
<section id="function" class="level1">
<h1>Function</h1>
<p>Here is the full function call.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;">ts_ma_plot</span>(</span>
<span id="cb1-2">  .data,</span>
<span id="cb1-3">  .date_col,</span>
<span id="cb1-4">  .value_col,</span>
<span id="cb1-5">  <span class="at" style="color: #657422;">.ts_frequency =</span> <span class="st" style="color: #20794D;">"monthly"</span>,</span>
<span id="cb1-6">  <span class="at" style="color: #657422;">.main_title =</span> <span class="cn" style="color: #8f5902;">NULL</span>,</span>
<span id="cb1-7">  <span class="at" style="color: #657422;">.secondary_title =</span> <span class="cn" style="color: #8f5902;">NULL</span>,</span>
<span id="cb1-8">  <span class="at" style="color: #657422;">.tertiary_title =</span> <span class="cn" style="color: #8f5902;">NULL</span></span>
<span id="cb1-9">)</span></code></pre></div>
</div>
<p>Now for the arguments to the parameters.</p>
<ul>
<li><code>.data</code>: the data you want to visualize, which should be pre-processed and the aggregation should match the .frequency argument.</li>
<li><code>.date_col</code>: the data column from the .data argument that contains the dates for your time series.</li>
<li><code>.value_col</code>: the data column from the .data argument that contains the values for your time series.</li>
<li><code>.ts_frequency</code>: the frequency of the aggregation, which should be quoted as “weekly” or “monthly”. If not specified, the function defaults to weekly.</li>
<li><code>.main_title</code>: the title of the main plot.</li>
<li><code>.secondary_title</code>: the title of the second plot.</li>
<li><code>.tertiary_title</code>: the title of the third plot.</li>
</ul>
</section>
<section id="example" class="level1">
<h1>Example</h1>
<p>Now for an example.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;">library</span>(healthyR.ts)</span>
<span id="cb2-2"><span class="fu" style="color: #4758AB;">library</span>(dplyr)</span>
<span id="cb2-3"></span>
<span id="cb2-4">data_tbl <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">ts_to_tbl</span>(AirPassengers) <span class="sc" style="color: #5E5E5E;">|&gt;</span></span>
<span id="cb2-5">  <span class="fu" style="color: #4758AB;">select</span>(<span class="sc" style="color: #5E5E5E;">-</span>index)</span>
<span id="cb2-6"></span>
<span id="cb2-7">output <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">ts_ma_plot</span>(</span>
<span id="cb2-8">  <span class="at" style="color: #657422;">.data =</span> data_tbl,</span>
<span id="cb2-9">  <span class="at" style="color: #657422;">.date_col =</span> date_col,</span>
<span id="cb2-10">  <span class="at" style="color: #657422;">.value_col =</span> value</span>
<span id="cb2-11">)</span></code></pre></div>
</div>
<p>Let’s take a look at each piece of the output.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">output<span class="sc" style="color: #5E5E5E;">$</span>data_trans_xts <span class="sc" style="color: #5E5E5E;">|&gt;</span> <span class="fu" style="color: #4758AB;">head</span>()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           value ma12
1949-01-01   112   NA
1949-02-01   118   NA
1949-03-01   132   NA
1949-04-01   129   NA
1949-05-01   121   NA
1949-06-01   135   NA</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">output<span class="sc" style="color: #5E5E5E;">$</span>data_diff_xts_a <span class="sc" style="color: #5E5E5E;">|&gt;</span> <span class="fu" style="color: #4758AB;">head</span>()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              diff_a
1949-01-01        NA
1949-02-01  5.357143
1949-03-01 11.864407
1949-04-01 -2.272727
1949-05-01 -6.201550
1949-06-01 11.570248</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1">output<span class="sc" style="color: #5E5E5E;">$</span>data_diff_xts_b <span class="sc" style="color: #5E5E5E;">|&gt;</span> <span class="fu" style="color: #4758AB;">head</span>()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           diff_b
1949-01-01     NA
1949-02-01     NA
1949-03-01     NA
1949-04-01     NA
1949-05-01     NA
1949-06-01     NA</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1">output<span class="sc" style="color: #5E5E5E;">$</span>data_summary_tbl</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 144 × 5
   date_col   value  ma12 diff_a diff_b
   &lt;date&gt;     &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
 1 1949-01-01   112    NA   0         0
 2 1949-02-01   118    NA   5.36      0
 3 1949-03-01   132    NA  11.9       0
 4 1949-04-01   129    NA  -2.27      0
 5 1949-05-01   121    NA  -6.20      0
 6 1949-06-01   135    NA  11.6       0
 7 1949-07-01   148    NA   9.63      0
 8 1949-08-01   148    NA   0         0
 9 1949-09-01   136    NA  -8.11      0
10 1949-10-01   119    NA -12.5       0
# … with 134 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1">output<span class="sc" style="color: #5E5E5E;">$</span>pgrid</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://www.spsanderson.com/steveondata/posts/rtip-2023-02-15/index_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1">output<span class="sc" style="color: #5E5E5E;">$</span>xts_plt</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://www.spsanderson.com/steveondata/posts/rtip-2023-02-15/index_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>


</section>

 ]]></description>
  <category>code</category>
  <category>rtip</category>
  <category>timeseries</category>
  <category>healthyrts</category>
  <guid>https://www.spsanderson.com/steveondata/posts/rtip-2023-02-15/index.html</guid>
  <pubDate>Wed, 15 Feb 2023 05:00:00 GMT</pubDate>
</item>
<item>
  <title>An example of using {box}</title>
  <dc:creator>Steven P. Sanderson II, MPH</dc:creator>
  <link>https://www.spsanderson.com/steveondata/posts/rtip-2023-02-14/index.html</link>
  <description><![CDATA[ 




<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>Today I am going to make a short post on the R package <a href="https://klmr.me/box/"><code>{box}</code></a> which was showcased to me quite nicely by <a href="https://www.linkedin.com/in/milesmichaeld/"><strong>Michael Miles</strong></a>. It was informative and I was able to immediately see the usefulness of the <code>{box}</code> library.</p>
<p>So what is ‘box’? Well here is the description straight from their site:</p>
<blockquote class="blockquote">
<p>‘box’ allows organising R code in a more modular way, via two mechanisms:</p>
<ul>
<li>It enables writing modular code by treating files and folders of R code as independent (potentially nested) modules, without requiring the user to wrap reusable code into packages.</li>
<li>It provides a new syntax to import reusable code (both from packages and from modules) which is more powerful and less error-prone than library or require, by limiting the number of names that are made available.</li>
</ul>
</blockquote>
<p>So let’s see how it all works.</p>
</section>
<section id="function" class="level1">
<h1>Function</h1>
<p>The main portion of the script looks like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;"># Main script</span></span>
<span id="cb1-2"></span>
<span id="cb1-3"><span class="co" style="color: #5E5E5E;"># Script setup --------------------------------------</span></span>
<span id="cb1-4"></span>
<span id="cb1-5"><span class="co" style="color: #5E5E5E;"># Load box modules</span></span>
<span id="cb1-6">box<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">use</span>(. <span class="sc" style="color: #5E5E5E;">/</span> box <span class="sc" style="color: #5E5E5E;">/</span> global_options <span class="sc" style="color: #5E5E5E;">/</span> global_options)</span>
<span id="cb1-7">box<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">use</span>(. <span class="sc" style="color: #5E5E5E;">/</span> box <span class="sc" style="color: #5E5E5E;">/</span> io <span class="sc" style="color: #5E5E5E;">/</span> imports)</span>
<span id="cb1-8">box<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">use</span>(. <span class="sc" style="color: #5E5E5E;">/</span> box <span class="sc" style="color: #5E5E5E;">/</span> io <span class="sc" style="color: #5E5E5E;">/</span> exports)</span>
<span id="cb1-9">box<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">use</span>(. <span class="sc" style="color: #5E5E5E;">/</span> box <span class="sc" style="color: #5E5E5E;">/</span> mod <span class="sc" style="color: #5E5E5E;">/</span> mod)</span>
<span id="cb1-10"></span>
<span id="cb1-11"><span class="co" style="color: #5E5E5E;"># Load global options</span></span>
<span id="cb1-12">global_options<span class="sc" style="color: #5E5E5E;">$</span><span class="fu" style="color: #4758AB;">set_global_options</span>() </span>
<span id="cb1-13"></span>
<span id="cb1-14"></span>
<span id="cb1-15"><span class="co" style="color: #5E5E5E;"># Main script ---------------------------------------</span></span>
<span id="cb1-16"></span>
<span id="cb1-17"><span class="co" style="color: #5E5E5E;"># Load data, process it, and export results</span></span>
<span id="cb1-18">all_data <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">getOption</span>(<span class="st" style="color: #20794D;">'data_dir'</span>) <span class="sc" style="color: #5E5E5E;">|&gt;</span> </span>
<span id="cb1-19">  </span>
<span id="cb1-20">  <span class="co" style="color: #5E5E5E;"># Load all data</span></span>
<span id="cb1-21">  imports<span class="sc" style="color: #5E5E5E;">$</span><span class="fu" style="color: #4758AB;">load_all</span>() <span class="sc" style="color: #5E5E5E;">|&gt;</span> </span>
<span id="cb1-22">  </span>
<span id="cb1-23">  <span class="co" style="color: #5E5E5E;"># Modify dataset</span></span>
<span id="cb1-24">  mod<span class="sc" style="color: #5E5E5E;">$</span><span class="fu" style="color: #4758AB;">modify_data</span>() <span class="sc" style="color: #5E5E5E;">|&gt;</span> </span>
<span id="cb1-25">  </span>
<span id="cb1-26">  <span class="co" style="color: #5E5E5E;"># Export data</span></span>
<span id="cb1-27">  exports<span class="sc" style="color: #5E5E5E;">$</span><span class="fu" style="color: #4758AB;">export_data</span>()</span></code></pre></div>
</div>
<p>So what does this do? Well it is grabbing data from a predefined location, modifying it and then re-exporting it. Now let’s look at all the code that is behind it, which allows us to do these things and then you will see the power of using <strong>box</strong></p>
</section>
<section id="example" class="level1">
<h1>Example</h1>
<p>Let’s take a look at the global options settings.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;"># Set global options</span></span>
<span id="cb2-2"><span class="co" style="color: #5E5E5E;">#' @export</span></span>
<span id="cb2-3">set_global_options <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="cf" style="color: #003B4F;">function</span>() {</span>
<span id="cb2-4">  <span class="fu" style="color: #4758AB;">options</span>(</span>
<span id="cb2-5">    <span class="at" style="color: #657422;">look_ups =</span> <span class="st" style="color: #20794D;">'look-ups/'</span>,</span>
<span id="cb2-6">    <span class="at" style="color: #657422;">data_dir =</span> <span class="st" style="color: #20794D;">'data/input/'</span></span>
<span id="cb2-7">  )</span>
<span id="cb2-8">}</span></code></pre></div>
</div>
<p>Ok 6 lines, boxed down to one.</p>
<p>Now the import function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="co" style="color: #5E5E5E;"># Function for importing data</span></span>
<span id="cb3-2"></span>
<span id="cb3-3"><span class="co" style="color: #5E5E5E;">#' @export</span></span>
<span id="cb3-4">load_all <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="cf" style="color: #003B4F;">function</span>(file_path) {</span>
<span id="cb3-5">  </span>
<span id="cb3-6">  box<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">use</span>(purrr)</span>
<span id="cb3-7">  box<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">use</span>(vroom)</span>
<span id="cb3-8">  </span>
<span id="cb3-9">  file_path <span class="sc" style="color: #5E5E5E;">|&gt;</span> </span>
<span id="cb3-10">    </span>
<span id="cb3-11">    <span class="co" style="color: #5E5E5E;"># Get all csv files from folder</span></span>
<span id="cb3-12">    <span class="fu" style="color: #4758AB;">list.files</span>(<span class="at" style="color: #657422;">full.names =</span> <span class="cn" style="color: #8f5902;">TRUE</span>) <span class="sc" style="color: #5E5E5E;">|&gt;</span> </span>
<span id="cb3-13">    </span>
<span id="cb3-14">    <span class="co" style="color: #5E5E5E;"># Set list names</span></span>
<span id="cb3-15">    purrr<span class="sc" style="color: #5E5E5E;">$</span><span class="fu" style="color: #4758AB;">set_names</span>(\(file) <span class="fu" style="color: #4758AB;">basename</span>(file)) <span class="sc" style="color: #5E5E5E;">|&gt;</span> </span>
<span id="cb3-16">    </span>
<span id="cb3-17">    <span class="co" style="color: #5E5E5E;"># Load all csvs into list</span></span>
<span id="cb3-18">    purrr<span class="sc" style="color: #5E5E5E;">$</span><span class="fu" style="color: #4758AB;">map</span>(\(file) vroom<span class="sc" style="color: #5E5E5E;">$</span><span class="fu" style="color: #4758AB;">vroom</span>(file))</span>
<span id="cb3-19"></span>
<span id="cb3-20">}</span></code></pre></div>
</div>
<p>Now the <code>modify_data</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="co" style="color: #5E5E5E;"># Function for modifying data</span></span>
<span id="cb4-2"></span>
<span id="cb4-3"><span class="co" style="color: #5E5E5E;">#' @export</span></span>
<span id="cb4-4">modify_data <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="cf" style="color: #003B4F;">function</span>(df_list) {</span>
<span id="cb4-5">  </span>
<span id="cb4-6">  box<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">use</span>(dplyr)</span>
<span id="cb4-7">  box<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">use</span>(purrr)</span>
<span id="cb4-8">  </span>
<span id="cb4-9">  map_fun <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="cf" style="color: #003B4F;">function</span>(df) {</span>
<span id="cb4-10">    </span>
<span id="cb4-11">    df <span class="sc" style="color: #5E5E5E;">|&gt;</span> </span>
<span id="cb4-12">      dplyr<span class="sc" style="color: #5E5E5E;">$</span><span class="fu" style="color: #4758AB;">select</span>(name<span class="sc" style="color: #5E5E5E;">:</span>mass) <span class="sc" style="color: #5E5E5E;">|&gt;</span> </span>
<span id="cb4-13">      dplyr<span class="sc" style="color: #5E5E5E;">$</span><span class="fu" style="color: #4758AB;">mutate</span>(<span class="at" style="color: #657422;">lol =</span> height <span class="sc" style="color: #5E5E5E;">*</span> mass) <span class="sc" style="color: #5E5E5E;">|&gt;</span> </span>
<span id="cb4-14">      dplyr<span class="sc" style="color: #5E5E5E;">$</span><span class="fu" style="color: #4758AB;">filter</span>(lol <span class="sc" style="color: #5E5E5E;">&gt;</span> <span class="dv" style="color: #AD0000;">1500</span>)</span>
<span id="cb4-15">  }</span>
<span id="cb4-16">  </span>
<span id="cb4-17">  <span class="co" style="color: #5E5E5E;"># Apply mapping function to list</span></span>
<span id="cb4-18">  purrr<span class="sc" style="color: #5E5E5E;">$</span><span class="fu" style="color: #4758AB;">map</span>(df_list, map_fun)</span>
<span id="cb4-19">  </span>
<span id="cb4-20">}</span></code></pre></div>
</div>
<p>Ok again, a big savings here, instead of the above we simply call <code>mod$modify_data()</code> which makes things clearner and also modular in that we can go to a very specific spot in our proejct to fix an error or add/subtract functionality.</p>
<p>Lastly the export.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="co" style="color: #5E5E5E;"># Function for exporting data</span></span>
<span id="cb5-2"></span>
<span id="cb5-3"><span class="co" style="color: #5E5E5E;">#' @export</span></span>
<span id="cb5-4">export_data <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="cf" style="color: #003B4F;">function</span>(df_list) {</span>
<span id="cb5-5">  </span>
<span id="cb5-6">  box<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">use</span>(vroom)</span>
<span id="cb5-7">  box<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">use</span>(purrr)</span>
<span id="cb5-8">  </span>
<span id="cb5-9">  <span class="co" style="color: #5E5E5E;"># Export data</span></span>
<span id="cb5-10">  purrr<span class="sc" style="color: #5E5E5E;">$</span><span class="fu" style="color: #4758AB;">map2</span>(<span class="at" style="color: #657422;">.x =</span> df_list,</span>
<span id="cb5-11">             <span class="at" style="color: #657422;">.y =</span> <span class="fu" style="color: #4758AB;">names</span>(df_list),</span>
<span id="cb5-12">             <span class="sc" style="color: #5E5E5E;">~</span>vroom<span class="sc" style="color: #5E5E5E;">$</span><span class="fu" style="color: #4758AB;">vroom_write</span>(<span class="at" style="color: #657422;">x =</span> .x,</span>
<span id="cb5-13">                               <span class="at" style="color: #657422;">file =</span> <span class="fu" style="color: #4758AB;">paste0</span>(<span class="st" style="color: #20794D;">'data/output/'</span>, </span>
<span id="cb5-14">                                             .y),</span>
<span id="cb5-15">                               <span class="at" style="color: #657422;">delim =</span> <span class="st" style="color: #20794D;">','</span>))</span>
<span id="cb5-16">  </span>
<span id="cb5-17">}</span></code></pre></div>
</div>
<p>Voila! I think to even a fresh user, the power of boxing your functions is fairly apparent and to the advanced user, eyes are most likely glowing!</p>


</section>

 ]]></description>
  <category>code</category>
  <category>rtip</category>
  <category>box</category>
  <guid>https://www.spsanderson.com/steveondata/posts/rtip-2023-02-14/index.html</guid>
  <pubDate>Tue, 14 Feb 2023 05:00:00 GMT</pubDate>
</item>
<item>
  <title>Off to CRAN! {tidyAML}</title>
  <dc:creator>Steven P. Sanderson II, MPH</dc:creator>
  <link>https://www.spsanderson.com/steveondata/posts/rtip-2023-02-13/index.html</link>
  <description><![CDATA[ 




<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>Are you tired of spending hours tuning and testing different machine learning models for your regression or classification problems? The new R package <a href="https://www.spsanderson.com/tidyAML/"><code>{tidyAML}</code></a> is here to simplify the process for you! tidyAML is a simple interface for automatic machine learning that fits the tidymodels framework, making it easier for you to solve regression and classification problems.</p>
<p>The tidyAML package has been designed with the goal of providing a simple API that automates the entire machine learning pipeline, from data preparation to model selection, training, and prediction. This means that you no longer have to spend hours tuning and testing different models; tidyAML will do it all for you, saving you time and effort.</p>
<p>In this initial release (version 0.0.1), tidyAML introduces a number of new features and minor fixes to improve the overall user experience. Here are some of the updates in this release:</p>
<p>New Features:</p>
<ul>
<li><code>make_regression_base_tbl()</code> and <code>make_classification_base_tbl()</code> functions for creating base tables for regression and classification problems, respectively.</li>
<li><code>internal_make_spec_tbl()</code> function for making the specification table for the machine learning pipeline.</li>
<li><code>internal_set_args_to_tune()</code> function for setting arguments to tune the models. This has not yet been implemented in a true working fashion but might be useful for feedback in this initial release.</li>
<li><code>create_workflow_set()</code> function for creating a set of workflows to test different models.</li>
<li><code>get_model()</code>, <code>extract_model_spec()</code>, <code>extract_wflw()</code>, <code>extract_wflw_fit()</code>, and <code>extract_wflw_pred()</code> functions for extracting different parts of the machine learning pipeline.</li>
<li><code>match_args()</code> function for matching arguments between the base and specification tables.</li>
</ul>
<p>Minor Fixes and Improvements:</p>
<ul>
<li>Updates to <code>fast_classification_parsnip_spec_tbl()</code> and <code>fast_regression_parsnip_spec_tbl()</code> to use the <code>make_regression</code> and <code>make_classification</code> functions and the <code>internal_make_spec_tbl()</code> function.</li>
<li>Addition of a class for the base table functions and using that class in <code>internal_make_spec_tbl()</code>.</li>
<li>Update to the DESCRIPTION for R &gt;= 3.4.0.</li>
</ul>
<p>In conclusion, tidyAML is a game-changer for those looking to automate the machine learning pipeline. It provides a simple API that eliminates the need for manual tuning and testing of different models. With the updates in this initial release, the tidyAML package is sure to make your machine learning journey easier and more efficient.</p>
</section>
<section id="function" class="level1">
<h1>Function</h1>
<p>There are too many functions to go over in this post so <a href="https://www.spsanderson.com/tidyAML/reference/index.html">you can find them all here</a></p>
</section>
<section id="examples" class="level1">
<h1>Examples</h1>
<p>Even though there are many functions to go over, we can showcase some with a small useful example. So let’s get at it!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;">library</span>(tidyAML)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;">library</span>(recipes)</span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;">library</span>(dplyr)</span>
<span id="cb1-4"></span>
<span id="cb1-5">rec_obj <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">recipe</span>(mpg <span class="sc" style="color: #5E5E5E;">~</span> ., <span class="at" style="color: #657422;">data =</span> mtcars)</span>
<span id="cb1-6"></span>
<span id="cb1-7">frt_tbl <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">fast_regression</span>(</span>
<span id="cb1-8">  <span class="at" style="color: #657422;">.data =</span> mtcars, </span>
<span id="cb1-9">  <span class="at" style="color: #657422;">.rec_obj =</span> rec_obj, </span>
<span id="cb1-10">  <span class="at" style="color: #657422;">.parsnip_eng =</span> <span class="fu" style="color: #4758AB;">c</span>(<span class="st" style="color: #20794D;">"lm"</span>,<span class="st" style="color: #20794D;">"glm"</span>),</span>
<span id="cb1-11">  <span class="at" style="color: #657422;">.parsnip_fns =</span> <span class="st" style="color: #20794D;">"linear_reg"</span></span>
<span id="cb1-12">  )</span>
<span id="cb1-13"></span>
<span id="cb1-14"><span class="fu" style="color: #4758AB;">glimpse</span>(frt_tbl)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 2
Columns: 8
$ .model_id       &lt;int&gt; 1, 2
$ .parsnip_engine &lt;chr&gt; "lm", "glm"
$ .parsnip_mode   &lt;chr&gt; "regression", "regression"
$ .parsnip_fns    &lt;chr&gt; "linear_reg", "linear_reg"
$ model_spec      &lt;list&gt; [~NULL, ~NULL, NULL, regression, TRUE, NULL, lm, TRUE]…
$ wflw            &lt;list&gt; [cyl, disp, hp, drat, wt, qsec, vs, am, gear, carb, mp…
$ fitted_wflw     &lt;list&gt; [cyl, disp, hp, drat, wt, qsec, vs, am, gear, carb, mp…
$ pred_wflw       &lt;list&gt; [&lt;tbl_df[24 x 1]&gt;], [&lt;tbl_df[24 x 1]&gt;]</code></pre>
</div>
</div>
<p>Now let’s go through the extractors.</p>
<p>The <code>get_model()</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;">get_model</span>(frt_tbl, <span class="dv" style="color: #AD0000;">2</span>) <span class="sc" style="color: #5E5E5E;">|&gt;</span></span>
<span id="cb3-2">  <span class="fu" style="color: #4758AB;">glimpse</span>()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1
Columns: 8
$ .model_id       &lt;int&gt; 2
$ .parsnip_engine &lt;chr&gt; "glm"
$ .parsnip_mode   &lt;chr&gt; "regression"
$ .parsnip_fns    &lt;chr&gt; "linear_reg"
$ model_spec      &lt;list&gt; [~NULL, ~NULL, NULL, regression, TRUE, NULL, glm, TRUE…
$ wflw            &lt;list&gt; [cyl, disp, hp, drat, wt, qsec, vs, am, gear, carb, mp…
$ fitted_wflw     &lt;list&gt; [cyl, disp, hp, drat, wt, qsec, vs, am, gear, carb, mp…
$ pred_wflw       &lt;list&gt; [&lt;tbl_df[24 x 1]&gt;]</code></pre>
</div>
</div>
<p>The <code>extract_model_spec()</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="fu" style="color: #4758AB;">extract_model_spec</span>(frt_tbl, <span class="dv" style="color: #AD0000;">1</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
Linear Regression Model Specification (regression)

Computational engine: lm </code></pre>
</div>
</div>
<p>Or do multiples:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="fu" style="color: #4758AB;">extract_model_spec</span>(frt_tbl, <span class="dv" style="color: #AD0000;">1</span><span class="sc" style="color: #5E5E5E;">:</span><span class="dv" style="color: #AD0000;">2</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
Linear Regression Model Specification (regression)

Computational engine: lm 


[[2]]
Linear Regression Model Specification (regression)

Computational engine: glm </code></pre>
</div>
</div>
<p>The <code>extract_wflw()</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><span class="fu" style="color: #4758AB;">extract_wflw</span>(frt_tbl, <span class="dv" style="color: #AD0000;">1</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
══ Workflow ════════════════════════════════════════════════════════════════════
Preprocessor: Recipe
Model: linear_reg()

── Preprocessor ────────────────────────────────────────────────────────────────
0 Recipe Steps

── Model ───────────────────────────────────────────────────────────────────────
Linear Regression Model Specification (regression)

Computational engine: lm </code></pre>
</div>
</div>
<p>Or do multiples:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><span class="fu" style="color: #4758AB;">extract_wflw</span>(frt_tbl, <span class="fu" style="color: #4758AB;">c</span>(<span class="dv" style="color: #AD0000;">1</span>, <span class="dv" style="color: #AD0000;">2</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
══ Workflow ════════════════════════════════════════════════════════════════════
Preprocessor: Recipe
Model: linear_reg()

── Preprocessor ────────────────────────────────────────────────────────────────
0 Recipe Steps

── Model ───────────────────────────────────────────────────────────────────────
Linear Regression Model Specification (regression)

Computational engine: lm 


[[2]]
══ Workflow ════════════════════════════════════════════════════════════════════
Preprocessor: Recipe
Model: linear_reg()

── Preprocessor ────────────────────────────────────────────────────────────────
0 Recipe Steps

── Model ───────────────────────────────────────────────────────────────────────
Linear Regression Model Specification (regression)

Computational engine: glm </code></pre>
</div>
</div>
<p>The <code>extract_wflw_fit()</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><span class="fu" style="color: #4758AB;">extract_wflw_fit</span>(frt_tbl, <span class="dv" style="color: #AD0000;">1</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
══ Workflow [trained] ══════════════════════════════════════════════════════════
Preprocessor: Recipe
Model: linear_reg()

── Preprocessor ────────────────────────────────────────────────────────────────
0 Recipe Steps

── Model ───────────────────────────────────────────────────────────────────────

Call:
stats::lm(formula = ..y ~ ., data = data)

Coefficients:
(Intercept)          cyl         disp           hp         drat           wt  
   28.21291     -1.60712      0.03458     -0.02189      0.56925     -5.69276  
       qsec           vs           am         gear         carb  
    0.69956      0.39398      1.50212     -0.35338      0.48289  </code></pre>
</div>
</div>
<p>Or do multiples:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><span class="fu" style="color: #4758AB;">extract_wflw_fit</span>(frt_tbl, <span class="dv" style="color: #AD0000;">1</span><span class="sc" style="color: #5E5E5E;">:</span><span class="dv" style="color: #AD0000;">2</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
══ Workflow [trained] ══════════════════════════════════════════════════════════
Preprocessor: Recipe
Model: linear_reg()

── Preprocessor ────────────────────────────────────────────────────────────────
0 Recipe Steps

── Model ───────────────────────────────────────────────────────────────────────

Call:
stats::lm(formula = ..y ~ ., data = data)

Coefficients:
(Intercept)          cyl         disp           hp         drat           wt  
   28.21291     -1.60712      0.03458     -0.02189      0.56925     -5.69276  
       qsec           vs           am         gear         carb  
    0.69956      0.39398      1.50212     -0.35338      0.48289  


[[2]]
══ Workflow [trained] ══════════════════════════════════════════════════════════
Preprocessor: Recipe
Model: linear_reg()

── Preprocessor ────────────────────────────────────────────────────────────────
0 Recipe Steps

── Model ───────────────────────────────────────────────────────────────────────

Call:  stats::glm(formula = ..y ~ ., family = stats::gaussian, data = data)

Coefficients:
(Intercept)          cyl         disp           hp         drat           wt  
   28.21291     -1.60712      0.03458     -0.02189      0.56925     -5.69276  
       qsec           vs           am         gear         carb  
    0.69956      0.39398      1.50212     -0.35338      0.48289  

Degrees of Freedom: 23 Total (i.e. Null);  13 Residual
Null Deviance:      935.1 
Residual Deviance: 121.5    AIC: 131</code></pre>
</div>
</div>
<p>Finally the <code>extract_wflw_pred()</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><span class="fu" style="color: #4758AB;">extract_wflw_pred</span>(frt_tbl, <span class="dv" style="color: #AD0000;">2</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
# A tibble: 24 × 1
   .pred
   &lt;dbl&gt;
 1  24.8
 2  26.5
 3  18.5
 4  13.9
 5  24.6
 6  29.1
 7  14.0
 8  17.9
 9  10.0
10  23.4
# … with 14 more rows</code></pre>
</div>
</div>
<p>Or do multiples:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><span class="fu" style="color: #4758AB;">extract_wflw_pred</span>(frt_tbl, <span class="dv" style="color: #AD0000;">1</span><span class="sc" style="color: #5E5E5E;">:</span><span class="dv" style="color: #AD0000;">2</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
# A tibble: 24 × 1
   .pred
   &lt;dbl&gt;
 1  24.8
 2  26.5
 3  18.5
 4  13.9
 5  24.6
 6  29.1
 7  14.0
 8  17.9
 9  10.0
10  23.4
# … with 14 more rows

[[2]]
# A tibble: 24 × 1
   .pred
   &lt;dbl&gt;
 1  24.8
 2  26.5
 3  18.5
 4  13.9
 5  24.6
 6  29.1
 7  14.0
 8  17.9
 9  10.0
10  23.4
# … with 14 more rows</code></pre>
</div>
</div>
<p>Voila!</p>


</section>

 ]]></description>
  <category>code</category>
  <category>rtip</category>
  <category>tidyaml</category>
  <category>tidymodels</category>
  <guid>https://www.spsanderson.com/steveondata/posts/rtip-2023-02-13/index.html</guid>
  <pubDate>Mon, 13 Feb 2023 05:00:00 GMT</pubDate>
</item>
<item>
  <title>Get the Current Hospital Data Set from CMS with {healthyR.data}</title>
  <dc:creator>Steven P. Sanderson II, MPH</dc:creator>
  <link>https://www.spsanderson.com/steveondata/posts/weekly-rtip-healthyrdata-2023-02-10/index.html</link>
  <description><![CDATA[ 




<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>Getting data for health care in the US can sometimes be hard. With my R package <a href="https://www.spsanderson.com/healthyR.data/"><code>{healthyR.data}</code></a> I am hoping to alleviate some of that pain.</p>
<p>Right now the package is bring actively developed from what was a simple yet sleepy simulated administrative data set is getting supercharged into a a full blow package that will retrieve data from outside sources. One such source is <a href="https://data.cms.gov/">CMS</a>.</p>
<p>At the start, and this is going to be a long road, I have started to build some functionality around getting the current hospital data from <strong>CMS</strong>. Let’s take a look at how it works.</p>
</section>
<section id="function" class="level1">
<h1>Function</h1>
<p>Here is the function which has no parameters. This function will download the current and the official hospital data sets from the CMS.gov website.</p>
<p>The function makes use of a temporary directory and file to save and unzip the data. This will grab the current Hospital Data Files, unzip them and return a list of tibbles with each tibble named after the data file.</p>
<p>The function returns a list object with all of the current hospital data as a tibble. It does not save the data anywhere so if you want to save it you will have to do that manually.</p>
<p>This also means that you would have to store the data as a variable in order to access the data later on. It does have a given attributes and a class so that it can be piped into other functions.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;">current_hosp_data</span>()</span></code></pre></div>
</div>
<p>Now let’s see it in action.</p>
</section>
<section id="example" class="level1">
<h1>Example</h1>
<p>We will download the current hospital data sets and take a look.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;">library</span>(healthyR.data)</span>
<span id="cb2-2"><span class="fu" style="color: #4758AB;">library</span>(dplyr)</span>
<span id="cb2-3"></span>
<span id="cb2-4">current_hospital_dataset <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">current_hosp_data</span>()</span></code></pre></div>
</div>
<p>This function downloads 70 files. Let’s see which ones have been downloaded.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;">names</span>(current_hospital_dataset)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "ASC_Facility.csv"                                                
 [2] "ASC_National.csv"                                                
 [3] "ASC_State.csv"                                                   
 [4] "ASCQR_OAS_CAHPS_BY_ASC.csv"                                      
 [5] "ASCQR_OAS_CAHPS_NATIONAL.csv"                                    
 [6] "ASCQR_OAS_CAHPS_STATE.csv"                                       
 [7] "CJR_PY6_Quality_Reporting_July_2022_Production_File.csv"         
 [8] "CMS_PSI_6_decimal_file.csv"                                      
 [9] "Complications_and_Deaths_Hospital.csv"                           
[10] "Complications_and_Deaths_National.csv"                           
[11] "Complications_and_Deaths_State.csv"                              
[12] "Data_Updates_January_2023.csv"                                   
[13] "Footnote_Crosswalk.csv"                                          
[14] "FY_2023_HAC_Reduction_Program_Hospital.csv"                      
[15] "FY_2023_Hospital_Readmissions_Reduction_Program_Hospital.csv"    
[16] "FY2021_Distribution_of_Net_Change_in_Base_Op_DRG_Payment_Amt.csv"
[17] "FY2021_Net_Change_in_Base_Op_DRG_Payment_Amt.csv"                
[18] "FY2021_Percent_Change_in_Medicare_Payments.csv"                  
[19] "FY2021_Value_Based_Incentive_Payment_Amount.csv"                 
[20] "HCAHPS_Hospital.csv"                                             
[21] "HCAHPS_National.csv"                                             
[22] "HCAHPS_State.csv"                                                
[23] "Healthcare_Associated_Infections_Hospital.csv"                   
[24] "Healthcare_Associated_Infections_National.csv"                   
[25] "Healthcare_Associated_Infections_State.csv"                      
[26] "Hospital_General_Information.csv"                                
[27] "HOSPITAL_QUARTERLY_MSPB_6_DECIMALS.csv"                          
[28] "hvbp_clinical_outcomes.csv"                                      
[29] "hvbp_efficiency_and_cost_reduction.csv"                          
[30] "hvbp_person_and_community_engagement.csv"                        
[31] "hvbp_safety.csv"                                                 
[32] "hvbp_tps.csv"                                                    
[33] "IPFQR_QualityMeasures_Facility.csv"                              
[34] "IPFQR_QualityMeasures_National.csv"                              
[35] "IPFQR_QualityMeasures_State.csv"                                 
[36] "Maternal_Health_Hospital.csv"                                    
[37] "Maternal_Health_National.csv"                                    
[38] "Maternal_Health_State.csv"                                       
[39] "Measure_Dates.csv"                                               
[40] "Medicare_Hospital_Spending_by_Claim.csv"                         
[41] "Medicare_Hospital_Spending_Per_Patient_Hospital.csv"             
[42] "Medicare_Hospital_Spending_Per_Patient_National.csv"             
[43] "Medicare_Hospital_Spending_Per_Patient_State.csv"                
[44] "OAS_CAHPS_Footnotes.csv"                                         
[45] "OQR_OAS_CAHPS_BY_HOSPITAL.csv"                                   
[46] "OQR_OAS_CAHPS_NATIONAL.csv"                                      
[47] "OQR_OAS_CAHPS_STATE.csv"                                         
[48] "Outpatient_Imaging_Efficiency_Hospital.csv"                      
[49] "Outpatient_Imaging_Efficiency_National.csv"                      
[50] "Outpatient_Imaging_Efficiency_State.csv"                         
[51] "Payment_National.csv"                                            
[52] "Payment_State.csv"                                               
[53] "Payment_and_Value_of_Care_Hospital.csv"                          
[54] "PCH_HCAHPS_HOSPITAL.csv"                                         
[55] "PCH_HCAHPS_NATIONAL.csv"                                         
[56] "PCH_HCAHPS_STATE.csv"                                            
[57] "PCH_HEALTHCARE_ASSOCIATED_INFECTIONS_HOSPITAL.csv"               
[58] "PCH_ONCOLOGY_CARE_MEASURES_HOSPITAL.csv"                         
[59] "PCH_OUTCOMES_HOSPITAL.csv"                                       
[60] "PCH_OUTCOMES_NATIONAL.csv"                                       
[61] "Timely_and_Effective_Care_Hospital.csv"                          
[62] "Timely_and_Effective_Care_National.csv"                          
[63] "Timely_and_Effective_Care_State.csv"                             
[64] "Unplanned_Hospital_Visits_Hospital.csv"                          
[65] "Unplanned_Hospital_Visits_National.csv"                          
[66] "Unplanned_Hospital_Visits_State.csv"                             
[67] "VA_IPF.csv"                                                      
[68] "VA_TE.csv"                                                       
[69] "Value_of_Care_National.csv"                                      
[70] "Veterans_Health_Administration_Provider_Level_Data.csv"          </code></pre>
</div>
</div>
<p>More to come in the future!</p>


</section>

 ]]></description>
  <category>code</category>
  <category>rtip</category>
  <category>healthyrdata</category>
  <guid>https://www.spsanderson.com/steveondata/posts/weekly-rtip-healthyrdata-2023-02-10/index.html</guid>
  <pubDate>Fri, 10 Feb 2023 05:00:00 GMT</pubDate>
</item>
</channel>
</rss>
